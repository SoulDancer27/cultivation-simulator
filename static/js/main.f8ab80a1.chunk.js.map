{"version":3,"sources":["Themes/LightTheme.ts","GameConstants/Constants.ts","GameConstants/Cultivation/CultivationManuals.ts","GameConstants/Player.ts","GameEngine/Player/PlayerContext.ts","GameEngine/PlayerLoader.tsx","Utils/parseNumber.ts","GameEngine/SettingsContext/SettingContext.ts","GameConstants/Interfaces.ts","GameEngine/Player/playerSkills.ts","GameEngine/Player/playerStats.ts","GameConstants/Fighting/fightDps.ts","GameEngine/shared/addBaseStats.ts","GameEngine/shared/addSkillExp.ts","GameConstants/Items/Treasures.ts","GameEngine/Managers/useFightManager.ts","GameEngine/shared/enemyTimesDefeated.ts","GameEngine/shared/rewardItems.ts","GameConstants/Activities/Trainings.ts","GameConstants/Activities/Mining.ts","GameConstants/Activities/Craft.tsx","GameConstants/Cultivation/CultivationRealms.ts","GameConstants/Activities/Gathering.ts","GameConstants/GameContent.ts","GameConstants/Fighting/Enemies.ts","GameEngine/GameContext/GameContext.ts","GameEngine/shared/calculateMaxActions.ts","GameConstants/Activities/Crafting/quality.ts","GameConstants/Activities/Crafting/power.ts","GameConstants/Activities/Crafting/CraftTreasure.ts","GameConstants/Activities/Crafting/index.ts","GameConstants/Activities/Crafting/CraftingFunctions.ts","GameConstants/Items/Herbs.ts","GameConstants/Items/Minerals.ts","GameConstants/Items/Money.ts","GameConstants/Activities/ActivitiesFunctions.ts","GameEngine/Managers/useActivityManager.ts","GameEngine/shared/calculateTimesCompleted.ts","GameEngine/shared/removeItems.ts","GameEngine/shared/rewardActivityItems.ts","GameEngine/shared/calculateRealmPower.ts","GameEngine/shared/calculateTribulationPower.ts","GameEngine/GameRuntime.tsx","GameEngine/Managers/useAgeManager.ts","GameEngine/Managers/useDefaultRegenManager.ts","GameEngine/Managers/useCultivationManager.ts","GameEngine/Managers/useBreakthroughManager.ts","Utils/useWindowDimensions.ts","GameEngine/Player/PlayerStatsDictionary.ts","GameEngine/Player/playerCurrentStats.ts","Components/TopBar.tsx","GameEngine/WorldLoader.tsx","Components/LeftSideBar/PlayerStatsPane/HealthBar.tsx","Components/shared/HtmlTooltip.tsx","Components/LeftSideBar/PlayerStatsPane/StatDetailsTooltip.tsx","Components/LeftSideBar/PlayerStatsPane.tsx","GameConstants/Villages.ts","Utils/getSpacing.ts","Components/LeftSideBar/PlayerLocationPane.tsx","Components/shared/CropImage.tsx","Components/LeftSideBar/PlayerStatsLayout/Equipment/EquipmentCard.tsx","Components/LeftSideBar/PlayerStatsLayout/Equipment.tsx","Components/LeftSideBar/PlayerStatsLayout/Inventory/InventoryBottomPanel.tsx","Components/LeftSideBar/PlayerStatsLayout/Inventory/InventoryFilters.tsx","Components/LeftSideBar/PlayerStatsLayout/Inventory/InventoryGrid/EmptyCell.tsx","Components/shared/LockIcon.tsx","Components/LeftSideBar/PlayerStatsLayout/Inventory/InventoryGrid/InventoryTreasureItem.tsx","GameConstants/utils/findItemDescription.ts","Components/LeftSideBar/PlayerStatsLayout/Inventory/InventoryGrid/InventoryCountableItem.tsx","Components/LeftSideBar/PlayerStatsLayout/Inventory/InventoryGrid/InventoryGridItem.tsx","Components/LeftSideBar/PlayerStatsLayout/Inventory/InventoryGrid.tsx","Components/LeftSideBar/PlayerStatsLayout/Inventory/AutosellPanel.tsx","Components/LeftSideBar/PlayerStatsLayout/Inventory.tsx","Components/LeftSideBar/PlayerStatsLayout/Stats.tsx","Components/LeftSideBar/PlayerStatsLayout/Skills/SkillDetailTooltip.tsx","Components/LeftSideBar/PlayerStatsLayout/Skills.tsx","Components/LeftSideBar/PlayerStatsLayout.tsx","Components/LeftSideBar.tsx","Pages/SettingsPage/TickRate.tsx","Pages/SettingsPage/GameSpeed.tsx","Pages/SettingsPage/ExportSave.tsx","Pages/SettingsPage/ImportSave.tsx","Pages/SettingsPage/WipeSave.tsx","Pages/SettingsPage/NumberNotation.tsx","Pages/SettingsPage.tsx","Utils/Cookie.ts","GameEngine/SettingsLoader.tsx","Components/shared/ProgressBar.tsx","Utils/parseTime.ts","Components/shared/ActivityStatsDescription.tsx","Components/shared/ItemImages.tsx","Components/ActivityCards/GatheringActivity.tsx","Pages/ActionsPage.tsx","Components/shared/ItemDescriptions.tsx","Pages/CraftingPage/TreasureTooltip.tsx","Components/ItemGrid/GridItem.tsx","Components/ItemGrid/EmptyCell.tsx","Components/ItemGrid.tsx","Components/ItemGrid/BasicGridCell.tsx","Pages/CraftingPage/ResultItemDescription.tsx","Pages/CraftingPage/ActiveItem.tsx","Pages/CraftingPage/PriceMultiplier.tsx","Pages/CraftingPage/TreasureCell.tsx","Pages/CraftingPage.tsx","Pages/FightingPage/EnemyRow.tsx","Components/shared/withTooltip.tsx","Pages/FightingPage/EnemyTooltip.tsx","Pages/FightingPage.tsx","Pages/CultivationPage/ActiveManual.tsx","Pages/CultivationPage/EquippedManuals/EquippedManualCard.tsx","Pages/CultivationPage/EquippedManuals/PlaceholderCard.tsx","Pages/CultivationPage/EquippedManuals.tsx","Pages/CultivationPage/ManualsList.tsx","Pages/ManualsPage.tsx","Pages/RealmBreakthroughPage/BreakthroughAnimation.tsx","Pages/RealmBreakthroughPage/Placeholder.tsx","Pages/RealmBreakthroughPage/calculateMaxTribulationStage.ts","Pages/RealmBreakthroughPage.tsx","Components/shared/useComponentSelector.tsx","Components/ActivityCards/Activity.tsx","Pages/RealmBreakthroughPage/breakthroughSuccess.ts","App.tsx","index.tsx"],"names":["LightTheme","responsiveFontSizes","createTheme","palette","background","default","paper","defaultUpdateInterval","defaultAutosaveInterval","year","month","day","levelExp","level","realm","rarity","totalExp","baseStats","attack","health","healthRegen","defence","insight","playerSkills","training","mining","crafting","gathering","PlayerEquipment","playerContext","stats","_objectSpread","age","currentStats","skills","baseSkills","index","power","manuals","name","imagePath","maxLevel","map","manual","learningProgress","exp","isEquipped","inventory","state","action","PlayerContext","React","createContext","updateContext","newData","setContext","value","PlayerContextLoader","props","_React$useState","useState","_React$useState2","_slicedToArray","player","setPlayer","_React$useState3","_React$useState4","loaded","setLoaded","useEffect","playerData","localStorage","getItem","JSON","parse","autosaveInterval","setInterval","setItem","stringify","clearInterval","_jsx","Provider","data","children","exponentialNumber","num","abs","Math","toFixed","toExponential","settingsContext","tickRate","gameSpeed","notation","SettingsContext","useNumberParser","useContext","pow","abbreviateNumber","padding","symbols","trivialNumber","CountableItems","UniqueItems","isInventoryTreasure","item","type","id","isCountableItem","amount","calculateSkill","skill","cultivationMulti","manualsSkillsMultiplier","treasuresMulti","treasuresSkillsMultiplier","treasuresPower","treasuresBonus","currentSkills","_i","_Object$entries","Object","entries","length","key","totalPower","forEach","Error","manualPower","error","treasures","totalMulti","skillsMulti","itemMulti","totalBonus","itemBonus","calculateStat","stat","manualsStatsMultiplier","realmMulti","treasuresStatsMultiplier","playerStats","statsMulti","PlayerFightDps","enemy","EnemyFightDps","addBaseStats","reward","times","_Object$entries$_i","console","log","concat","addSkillsExp","Treasures","description","image","path","x","y","sizeX","sizeY","realmIndex","useFightManager","timer","currentTime","previousTime","elapsedTime","playerDamage","enemyDamage","timesCompleted","currentHealth","floor","enemyTimesDefeated","newEnemyHealth","min","newPlayerHealth","result","items","_step","_iterator","_createForOfIteratorHelper","_loop","piece","includes","amountToAdd","itemIndex","findIndex","currentItem","push","uuid","treasure","find","i","s","n","done","err","e","f","rewardItems","undefined","Trainings","baseTime","time","baseStatsMulti","Mining","Crafting","price","generator","TribulationDps","BreakthroughDps","CultivationRealms","multi","factor","tribulation","steps","multiplier","_LargeRealms","smallIndex","statMulti","powerMulti","realmPowers","Gathering","gameContent","trainings","cultivationRealms","enemies","gameContext","GameContext","calculateMaxActions","maxActions","Number","MAX_VALUE","priceMulti","actionsNumber","v","filter","_ret","quality","realmFactor","divider","baseQuality","sqrt","CraftTreasure","activity","_activity$price","invTreasure","itemQuality","itemPower","CraftingFunctions","Sword","Armor","Helmet","Ring","Pendant","Herbs","Minerals","Money","ActivitiesFunctions","mainItem","max","useActivityManager","game","source","_calculateTimesComple","requiredTime","calculateTimesCompleted","amountToRemove","splice","removeItems","rewardActivityItems","calculateRealmPower","realms","_i2","_Object$entries2","_Object$entries2$_i","stepReached","_i3","_Object$entries3","calculateTribulationPower","currentRealm","GameRuntime","Date","now","setTimer","interval","_React$useContext","useAgeManager","additionalHealth","useDefaultRegenManager","_state$manual","expGain","maxExp","newExp","newLevel","useCultivationManager","_React$useContext2","updateGameContext","breakthrough","realmDamage","newRealmHealth","newStep","_calculateTribulation","slice","alert","useBreakthroughManager","_Fragment","getWindowDimensions","_window","window","width","innerWidth","height","innerHeight","useWindowDimensions","windowDimensions","setWindowDimensions","handleResize","addEventListener","removeEventListener","PlayerStatsDictionary","getStatName","playerCurrentStats","TopBar","_state$activity","_state$enemy","theme","useTheme","playerAction","Paper","elevation","_jsxs","Box","spacing","display","alignItems","gap","paddingX","Typography","variant","parseAge","marginLeft","flexDirection","SettingsOutlinedIcon","fontSize","onClick","setSettings","settings","years","months","WorldLoader","setData","gameData","storageData","HealthBar","sx","minWidth","color","label","m","LinearProgress","HtmlTooltip","styled","_ref","className","_objectWithoutProperties","_excluded","Tooltip","classes","popper","_ref2","_defineProperty","tooltipClasses","tooltip","backgroundColor","maxWidth","typography","pxToRem","border","StatDetailsTooltip","statStructure","base","getStatStructure","title","component","success","main","PlayerStatsPane","paddingTop","paddingLeft","displayStats","Villages","activities","getSpacing","PlayerLocationPane","location","src","alt","CropImage","box","position","overflow","style","top","left","CropSquareImage","size","EquipmentCard","borderRadius","margin","bgcolor","marginTop","_treasure$item","itemStats","TreasureDescription","text","effect","_Object$entries3$_i","_i4","_Object$entries4","_Object$entries4$_i","Button","maxHeight","minHeight","unequipItem","Equipment","equippedItems","EquipCards","itemType","InventoryBottomPanel","pages","setPages","current","total","disabled","KeyboardDoubleArrowLeftIcon","KeyboardArrowLeftIcon","KeyboardArrowRightIcon","KeyboardDoubleArrowRightIcon","InventoryFiltersPane","setType","fullWidth","EmptyCell","LockIcon","isLocked","LockOutlinedIcon","LockOpenOutlinedIcon","InventoryTreasureItem","realmName","anchorEl","setAnchorEl","open","Boolean","trimmedRealmName","substring","charAt","ClickAwayListener","onClickAway","justifyContent","event","currentTarget","Popper","p","toggleItemLock","equippedIndex","equipItem","dropItem","findItemDescription","InventoryCountableItem","cellData","CountableCellTooltip","InventoryGridItem","InventoryGrid","ceil","Tiles","Array","fill","element","flexWrap","tile","Realms","ItemTypes","AutosellPanel","setRealm","_React$useState5","_React$useState6","setQuality","_React$useState7","_React$useState8","isActive","setActive","autosellInterval","newInventory","uItem","itemRealm","FormControl","InputLabel","Select","labelId","onChange","target","MenuItem","toString","realm_index","parseInt","newRealm","TextField","q","isNaN","FormGroup","FormControlLabel","control","Checkbox","checked","Inventory","displayedInventory","inventoryPage","Stats","SkillDetailsTooltip","skillStructure","getSkillStructure","Skills","PlayerStatsLayout","panel","selectPanel","paddingBottom","LeftSideBar","borderRight","unshift","marks","TickRate","Slider","defaultValue","getAriaValueText","step","valueLabelDisplay","onChangeCommitted","GameSpeed","ExportSave","save","blob","Blob","saveAs","ImportSave","setGame","submit","_asyncToGenerator","_regeneratorRuntime","mark","_callee","input","file","wrap","_context","prev","next","files","sent","t0","stop","_x","apply","arguments","encType","htmlFor","Input","WipeSave","removeItem","NumberNotation","RadioGroup","Radio","SettingsPage","_getWindowDimensions","alignSelf","marginRight","CloseIcon","createCookie","days","expires","date","setTime","getTime","toUTCString","document","cookie","accessCookie","cookieName","allCookieArray","split","temp","trim","indexOf","SettingsContextLoader","tickrate","ProgressBar","rightLabel","rest","isRight","parseTime","toPrecision","ActivityStatsDescription","multiplicatorFunctionName","StatsDescription","ItemImages","_description$image","GatheringActivityCard","ItemRewardDescription","fastAction","progressBarLabel","paddingY","borderColor","primary","ActionsPage","Card","activityName","showTimesCompleted","ItemDescriptions","TreasureTooltip","context","craftTime","craftTimeLabel","marginY","ArrowForwardIcon","setActiveItem","GridItem","Cell","ItemGrid","cellWidth","cellHeight","itemTypes","view","BasicGridCell","whiteSpace","ResultItemDescription","ActiveItem","_player$state$activit","craft","PriceMultiplier","newMulti","TreasureCell","_reward$","CraftingPage","activeItem","marginBottom","WrappedComponent","EnemyRow","enemyHealthLabel","TableRow","TableCell","toggleTooltip","onMouseOver","showTooltip","onMouseOut","hideTooltip","currentEnemy","FightingPage","TableContainer","Table","TableHead","TableBody","ActiveManual","expForPrevLevel","expForNextLevel","ManualStatsDescription","ManualSkillsDescription","EquippedManualCard","PlaceholderCard","EquippedManuals","equippedManuals","tileIndex","_createElement","ManualsList","storedManuals","sort","a","b","aIndex","canSelect","equipButtonClick","ManualsPage","BreakthroughAnimation","progress","isHeavenly","bar","zIndex","opacity","Placeholder","PassedTribulations","currentPower","tribulationMulti","calculateMaxTribulationStage","nextRealmIndex","remainingHealth","cultivationRealmsCopy","tribulationDps","playerDps","RealmBreakthroughPage","_nextRealm$currentSta","_nextRealm$tribulatio","r","TotalTribulations","trib","nextRealm","nextPower","_nextRealm$baseStats","states","Training","ItemPriceDescription","_step2","_iterator2","borderLeft","Manuals","Breakthrough","Fighting","MainWindow","_useWindowDimensions","_useComponentSelector","defaultComponent","components","setState","Content","keys","useComponentSelector","Menu","canBreakthrough","realmDps","breakthroughSuccess","buttonColor","page","App","CssBaseline","ThemeProvider","SettingsLoader","PlayerLoader","ReactDOM","render","StrictMode","getElementById"],"mappings":"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HC,MAAO,GACPC,MAAO,IAETC,WAAY,EACZxD,KAAM,QAER,CACEnE,KAAM,cACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,0BACNC,EAAG,IACHC,EAAG,EACHC,MAAO,GACPC,MAAO,IAETC,WAAY,GACZxD,KAAM,UAER,CACEnE,KAAM,cACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,yBACNC,EAAG,GACHC,EAAG,EACHC,MAAO,GACPC,MAAO,IAETC,WAAY,GACZxD,KAAM,SAER,CACEnE,KAAM,eACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,0BACNC,EAAG,GACHC,EAAG,EACHC,MAAO,GACPC,MAAO,IAETC,WAAY,GACZxD,KAAM,UAER,CACEnE,KAAM,gBACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,2BACNC,EAAG,GACHC,EAAG,EACHC,MAAO,GACPC,MAAO,IAETC,WAAY,GACZxD,KAAM,WAER,CACEnE,KAAM,aACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,wBACNC,EAAG,GACHC,EAAG,EACHC,MAAO,GACPC,MAAO,IAETC,WAAY,GACZxD,KAAM,QAER,CACEnE,KAAM,mBACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,0BACNC,EAAG,IACHC,EAAG,EACHC,MAAO,GACPC,MAAO,IAETC,WAAY,GACZxD,KAAM,UAER,CACEnE,KAAM,mBACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,yBACNC,EAAG,IACHC,EAAG,EACHC,MAAO,GACPC,MAAO,IAETC,WAAY,GACZxD,KAAM,SAER,CACEnE,KAAM,oBACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,0BACNC,EAAG,IACHC,EAAG,EACHC,MAAO,GACPC,MAAO,IAETC,WAAY,GACZxD,KAAM,UAER,CACEnE,KAAM,qBACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,2BACNC,EAAG,IACHC,EAAG,EACHC,MAAO,GACPC,MAAO,IAETC,WAAY,GACZxD,KAAM,WAER,CACEnE,KAAM,kBACNoH,YAAa,GACbC,MAAO,CACLC,KAAM,wBACNC,EAAG,IACHC,EAAG,EACHC,M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","file":"static/js/main.f8ab80a1.chunk.js","sourcesContent":["import { createTheme, responsiveFontSizes } from \"@mui/material\";\r\n\r\nconst LightTheme = responsiveFontSizes(\r\n  createTheme({\r\n    palette: {\r\n      background: {\r\n        default: \"rgb(240, 240, 240)\",\r\n        paper: \"rgb(240, 240, 240)\",\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\nexport default LightTheme;\r\n","// Update interval in milliseconds\r\nexport const defaultUpdateInterval = 50;\r\n\r\n// Default autosave interval\r\nexport const defaultAutosaveInterval = 10000;\r\n\r\n// For converting player age\r\nexport const year = (3600 * 1000) / 50; // 1 hour counts as 50 years\r\nexport const month = year / 12;\r\nexport const day = month / 30;\r\n","import { PlayerBaseStats, PlayerSkills } from \"../Player\";\r\n\r\n// Some example manuals for now\r\n// Act like training techniques which you can study and they provide player with cumulative stat bonuses\r\nexport const CultivationManuals: CultivationManualType[] = [\r\n  {\r\n    name: \"Fist Strike\",\r\n    realm: \"Mortal 1\",\r\n    rarity: \"common\",\r\n    imagePath: \"/manuals/red.png\",\r\n    maxLevel: 10,\r\n    stats: {\r\n      attack: 0.01,\r\n    },\r\n  },\r\n  {\r\n    name: \"Block\",\r\n    realm: \"Mortal 1\",\r\n    rarity: \"common\",\r\n    imagePath: \"/manuals/yellow.png\",\r\n    maxLevel: 10,\r\n    stats: {\r\n      defence: 0.01,\r\n    },\r\n  },\r\n  {\r\n    name: \"Meditation\",\r\n    realm: \"Mortal 1\",\r\n    rarity: \"common\",\r\n    imagePath: \"/manuals/green.png\",\r\n    maxLevel: 10,\r\n    stats: {\r\n      health: 0.01,\r\n      healthRegen: 0.01,\r\n    },\r\n  },\r\n  {\r\n    name: \"Training Guidance\",\r\n    realm: \"Mortal 1\",\r\n    rarity: \"common\",\r\n    imagePath: \"/manuals/purple.png\",\r\n    maxLevel: 10,\r\n    skills: {\r\n      training: 0.01,\r\n    },\r\n  },\r\n];\r\n\r\nexport type CultivationManualType = {\r\n  name: string;\r\n  realm: string;\r\n  rarity: string; // an unused parameter for now\r\n  imagePath?: string;\r\n  maxLevel: number;\r\n  // Cumulative bonus to base stats\r\n  stats?: Partial<PlayerBaseStats>;\r\n  skills?: Partial<PlayerSkills>;\r\n};\r\n\r\n// a placeholder\r\nexport function levelExp(level, realm, rarity) {\r\n  return 10 * level;\r\n}\r\n\r\n// also a placeholder\r\nexport function totalExp(level) {\r\n  return 5 * (1 + level) * level;\r\n}\r\n","/* _____________________________________________________________________\r\nIf you want to add new player stats and skills change \r\ntype declarations and default values here\r\n  _____________________________________________________________________*/\r\n\r\nexport type PlayerBaseStats = {\r\n  health: number;\r\n  attack: number;\r\n  healthRegen: number;\r\n  defence: number;\r\n  insight: number; // multiplier for cultivation manuals experience gain\r\n};\r\n\r\nexport type PlayerCurrentStats = {\r\n  health: number;\r\n};\r\n\r\nexport type PlayerSkills = {\r\n  training: number;\r\n  mining: number;\r\n  crafting: number;\r\n  gathering: number;\r\n};\r\n\r\nexport const baseStats: PlayerBaseStats = {\r\n  attack: 1,\r\n  health: 10,\r\n  healthRegen: 0.5,\r\n  defence: 0,\r\n  insight: 1,\r\n};\r\n\r\nexport const currentStats: PlayerCurrentStats = {\r\n  health: 10,\r\n};\r\n\r\nexport const playerSkills: PlayerSkills = {\r\n  training: 0,\r\n  mining: 0,\r\n  crafting: 0,\r\n  gathering: 0,\r\n};\r\n\r\n// You can add player equipment types here\r\n// They are dumb though so multiple slots for single weapon type are currently not possible\r\nexport const PlayerEquipment = [\"weapon\", \"armor\", \"helmet\", \"ring\", \"pendant\"];\r\n","import { year } from \"GameConstants/Constants\";\r\nimport { CultivationManuals } from \"GameConstants/Cultivation/CultivationManuals\";\r\nimport { PlayerContextType } from \"GameConstants/Interfaces\";\r\nimport { baseStats, currentStats, playerSkills } from \"GameConstants/Player\";\r\nimport React from \"react\";\r\n\r\n// Some placeholder values to fill in the player object on first launch\r\nexport const playerContext: PlayerContextType = {\r\n  stats: {\r\n    age: year * 10,\r\n    ...baseStats,\r\n  },\r\n  currentStats: currentStats,\r\n  baseStats,\r\n  skills: playerSkills,\r\n  baseSkills: playerSkills,\r\n  realm: {\r\n    index: 0,\r\n    power: {},\r\n  },\r\n  manuals: CultivationManuals.map((manual) => ({\r\n    manual,\r\n    learningProgress: { exp: 0, level: 0 },\r\n    isEquipped: false,\r\n  })),\r\n  inventory: [],\r\n  state: { action: \"idle\" },\r\n};\r\n\r\n/** Context initializator */\r\nexport const PlayerContext = React.createContext({\r\n  ...playerContext,\r\n  updateContext: (newData: Partial<PlayerContextType>) => {},\r\n  setContext: (value: React.SetStateAction<PlayerContextType>) => {},\r\n});\r\n\r\nexport default PlayerContext;\r\n","import { defaultAutosaveInterval } from \"GameConstants/Constants\";\r\nimport { PlayerContextType } from \"GameConstants/Interfaces\";\r\nimport React from \"react\";\r\nimport PlayerContext, { playerContext } from \"./Player/PlayerContext\";\r\n\r\n// Wrapper for loading player save data\r\nexport default function PlayerContextLoader(props: any) {\r\n  const [player, setPlayer] = React.useState(playerContext);\r\n  /** Updates player context using shallow merge of UserContext attributes. */\r\n  const updateContext = (newData: Partial<PlayerContextType>) =>\r\n    setPlayer((data) => ({ ...data, ...newData }));\r\n\r\n  // Load save data from Local Storage\r\n  const [loaded, setLoaded] = React.useState<boolean>(false);\r\n  React.useEffect(() => {\r\n    const playerData = localStorage.getItem(\"player\");\r\n    if (playerData) setPlayer(JSON.parse(playerData));\r\n    setLoaded(true);\r\n  }, []);\r\n\r\n  // Autosave\r\n  React.useEffect(() => {\r\n    const autosaveInterval = setInterval(() => {\r\n      // Thats a hacky way to access current state value inside useEffect run only once\r\n      setPlayer((player) => {\r\n        localStorage.setItem(\"player\", JSON.stringify(player));\r\n        return player;\r\n      });\r\n    }, defaultAutosaveInterval);\r\n    return () => {\r\n      clearInterval(autosaveInterval);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <PlayerContext.Provider\r\n      value={{ ...player, updateContext, setContext: setPlayer }}\r\n    >\r\n      {loaded && props.children}\r\n    </PlayerContext.Provider>\r\n  );\r\n}\r\n","import { abbreviateNumber } from \"js-abbreviation-number\";\r\n\r\nexport function trivialNumber(num: number) {\r\n  const abs = Math.abs(num);\r\n  // Limits for trivial numbers\r\n  if (abs >= 10 ** 27 || abs <= 0.01) return exponentialNumber(num);\r\n  if (abs < 1000) {\r\n    if (abs >= 10) return num.toFixed(2);\r\n\r\n    if (abs < 10 && abs >= 0.01) return num.toFixed(3);\r\n  }\r\n  const result = abbreviateNumber(num, 2, {\r\n    padding: false,\r\n    symbols: [\"\", \"k\", \"m\", \"b\", \"t\", \"q\", \"qi\", \"sx\", \"sp\"],\r\n  });\r\n  return result;\r\n}\r\n\r\nexport function exponentialNumber(num: number) {\r\n  const abs = Math.abs(num);\r\n  if (abs < 1000) {\r\n    if (abs >= 10) return num.toFixed(2);\r\n\r\n    if (abs < 10 && abs >= 0.01) return num.toFixed(3);\r\n  }\r\n  return num.toExponential(3);\r\n}\r\n","import { defaultUpdateInterval } from \"GameConstants/Constants\";\r\nimport { exponentialNumber, trivialNumber } from \"Utils/parseNumber\";\r\nimport React from \"react\";\r\n\r\n// Declarations for the React Context type\r\nexport type SettingsContextType = {\r\n  tickRate: number;\r\n  gameSpeed: number;\r\n  notation: \"exponential\" | \"trivial\";\r\n};\r\n\r\nexport const settingsContext: SettingsContextType = {\r\n  tickRate: 1000 / defaultUpdateInterval,\r\n  gameSpeed: 1,\r\n  notation: \"trivial\",\r\n};\r\n\r\n/** Context initializator */\r\nexport const SettingsContext = React.createContext({\r\n  ...settingsContext,\r\n  updateContext: (newData: Partial<SettingsContextType>) => {},\r\n  setContext: (value: React.SetStateAction<SettingsContextType>) => {},\r\n});\r\n\r\nexport default SettingsContext;\r\n\r\nexport function useNumberParser() {\r\n  const { notation } = React.useContext(SettingsContext);\r\n  return (num: number): string => {\r\n    if (notation === \"trivial\") return trivialNumber(num);\r\n    if (notation === \"exponential\") return exponentialNumber(num);\r\n    return num.toFixed(2);\r\n  };\r\n}\r\n","import { Activity } from \"./Activities/Activities\";\r\nimport { CultivationManualType } from \"./Cultivation/CultivationManuals\";\r\nimport { EnemyType } from \"./Fighting/Enemies\";\r\nimport { PlayerBaseStats, PlayerCurrentStats, PlayerSkills } from \"./Player\";\r\nimport { Treasure } from \"./Items/Treasures\";\r\n\r\n/* ______________________________________________________________________\r\n  Player Types                                             \r\n_________________________________________________________________________*/\r\nexport type PlayerAction =\r\n  | \"idle\"\r\n  | \"fighting\"\r\n  | \"breakthrough\"\r\n  | \"cultivating\"\r\n  | \"activity\"; // most of the actions in the game\r\n\r\nexport type PlayerState = {\r\n  action: PlayerAction;\r\n  enemy?: PlayerEnemyType;\r\n  realm?: RealmTribulation;\r\n  manual?: PlayerCultivationManual;\r\n  activity?: { name: string; source: string }; // player action source from global lists. Is used as a key to retrieve value from GameContext object\r\n};\r\n\r\nexport type PlayerActivity = Activity & { currentTime?: number };\r\n\r\nexport type RealmTribulation = {\r\n  index: number; // A pointer into global tribulation array\r\n};\r\n\r\n// Player stats are calculated based on baseStats, equipped items, learned manuals and so on\r\nexport type PlayerStats = PlayerBaseStats & {\r\n  age: number; // in milliseconds\r\n};\r\n\r\n// This probably needs a rework\r\nexport type PlayerEnemyType = EnemyType & {\r\n  currentHealth: number;\r\n};\r\n\r\nexport type PlayerRealm = {\r\n  index: number;\r\n  power: Partial<PlayerBaseStats>; // a calculated value based on passed tribulations\r\n};\r\n\r\nexport type PlayerCultivationManual = {\r\n  manual: CultivationManualType;\r\n  learningProgress: {\r\n    exp: number;\r\n    level: number;\r\n  };\r\n  isEquipped: boolean;\r\n};\r\n\r\n/* ______________________________________________________________________\r\n  Item types                                           \r\n_________________________________________________________________________*/\r\n\r\nexport const CountableItems = <const>[\"money\", \"mineral\", \"herb\"];\r\nexport type CountableItemType = (typeof CountableItems)[number];\r\nexport const UniqueItems = <const>[\"treasure\", \"potion\"];\r\nexport type UniqueItemType = (typeof UniqueItems)[number];\r\nexport type ItemType = CountableItemType | UniqueItemType;\r\n\r\nexport type InventoryTreasure = {\r\n  type: \"treasure\";\r\n  id: string;\r\n  isEquipped?: boolean;\r\n  isLocked?: boolean;\r\n  item: Required<Treasure>;\r\n};\r\n\r\nexport type InventoryCountableItem = {\r\n  type: CountableItemType;\r\n  id: string;\r\n  name: string;\r\n  amount: number;\r\n};\r\n\r\nexport type InventoryUniqueItem = InventoryTreasure;\r\nexport type InventoryItem = InventoryUniqueItem | InventoryCountableItem;\r\n\r\nexport type PlayerContextType = {\r\n  stats: PlayerStats; // calcuated stat values\r\n  currentStats: PlayerCurrentStats;\r\n  baseStats: PlayerBaseStats;\r\n  skills: PlayerSkills; // calculated skill values\r\n  baseSkills: PlayerSkills;\r\n  realm: PlayerRealm; // an index pointing to the global realms array and total calculated multiplier based on passed tribulations\r\n  manuals?: PlayerCultivationManual[]; // an array of all learned manuals with progress tracked for each\r\n  inventory: InventoryItem[]; // an array of all inventory items\r\n  state: PlayerState; // current player action\r\n};\r\n\r\nexport type CountableItem = {\r\n  type: CountableItemType;\r\n  name: string;\r\n  amount: number;\r\n};\r\n\r\n// Lazy type guards\r\nexport function isInventoryTreasure(item: any): item is InventoryTreasure {\r\n  return item.type === \"treasure\" && item.id && item.item;\r\n}\r\n\r\nexport function isCountableItem(item: any): item is CountableItem {\r\n  return item.name && item.amount;\r\n}\r\n\r\nexport type Image = {\r\n  path: string;\r\n  x: number;\r\n  y: number;\r\n  sizeX: number;\r\n  sizeY: number;\r\n};\r\n\r\nexport type Material = {\r\n  name: string;\r\n  description: string;\r\n  image: Image;\r\n};\r\n","import { isInventoryTreasure } from \"GameConstants/Interfaces\";\r\nimport {\r\n  InventoryItem,\r\n  PlayerContextType,\r\n  PlayerCultivationManual,\r\n} from \"GameConstants/Interfaces\";\r\nimport { PlayerSkills } from \"GameConstants/Player\";\r\n\r\n// Functions that calculate total player skills values based on inGame variables\r\nexport function calculateSkill(skill: string, player: PlayerContextType) {\r\n  const cultivationMulti = manualsSkillsMultiplier(skill, player.manuals);\r\n  const treasuresMulti = treasuresSkillsMultiplier(skill, player.inventory);\r\n  const treasuresPower = treasuresBonus(skill, player.inventory);\r\n  return (\r\n    player.baseSkills[skill] * cultivationMulti * treasuresMulti +\r\n    treasuresPower\r\n  );\r\n}\r\n\r\n// Returns all of the player stats\r\nexport function playerSkills(player: PlayerContextType): PlayerSkills {\r\n  let currentSkills = { ...player.baseSkills };\r\n  for (const [key] of Object.entries(player.baseSkills)) {\r\n    currentSkills[key] = calculateSkill(key, player);\r\n  }\r\n\r\n  let skills = { ...player.skills, ...currentSkills };\r\n  return skills;\r\n}\r\n\r\n// Calculates effect on player skills from manuals\r\nexport function manualsSkillsMultiplier(\r\n  skill: string,\r\n  manuals: PlayerCultivationManual[] | undefined\r\n) {\r\n  // Calculate manuals multiplier\r\n  let totalPower = 1;\r\n  if (!manuals) return 1;\r\n  manuals.forEach((value) => {\r\n    try {\r\n      if (!value.isEquipped || !value.manual.skills) throw new Error(\"skip\");\r\n      const manualPower =\r\n        (value.manual.skills[skill] || 0) * value.learningProgress.level;\r\n      totalPower += manualPower;\r\n    } catch (error) {\r\n      /* do nothing*/\r\n    }\r\n  });\r\n  return totalPower;\r\n}\r\n\r\n// Treasures provide multiplier and flat bonus\r\nexport function treasuresSkillsMultiplier(\r\n  skill: string,\r\n  treasures: InventoryItem[] | undefined\r\n) {\r\n  let totalMulti = 1;\r\n  if (!treasures) return 0;\r\n  treasures.forEach((item) => {\r\n    if (isInventoryTreasure(item) && item.isEquipped) {\r\n      const skillsMulti = item.item.stats.skillsMulti;\r\n      const itemMulti = (skillsMulti && skillsMulti[skill]) || 0;\r\n      totalMulti *= 1 + itemMulti;\r\n    }\r\n  });\r\n  return totalMulti;\r\n}\r\n\r\nexport function treasuresBonus(\r\n  skill: string,\r\n  treasures: InventoryItem[] | undefined\r\n) {\r\n  let totalBonus = 0;\r\n  if (!treasures) return 0;\r\n  treasures.forEach((item) => {\r\n    if (isInventoryTreasure(item) && item.isEquipped) {\r\n      const skills = item.item.stats.skills;\r\n      const itemBonus = (skills && skills[skill]) || 0;\r\n      totalBonus += itemBonus;\r\n    }\r\n  });\r\n  return totalBonus;\r\n}\r\n\r\ntype SkillStructure = {\r\n  base: number;\r\n  manuals: number;\r\n  treasuresMulti: number;\r\n  treasures: number;\r\n};\r\n\r\nexport function getSkillStructure(\r\n  skill: string,\r\n  player: PlayerContextType\r\n): SkillStructure {\r\n  const { baseSkills, manuals, inventory } = player;\r\n  const baseStat = baseSkills[skill];\r\n  const manualsBonus = manualsSkillsMultiplier(skill, manuals);\r\n  const treasuresMulti = treasuresSkillsMultiplier(skill, inventory);\r\n  const treasuresPower = treasuresBonus(skill, inventory);\r\n  return {\r\n    base: baseStat,\r\n    manuals: manualsBonus,\r\n    treasuresMulti,\r\n    treasures: treasuresPower,\r\n  };\r\n}\r\n","import { isInventoryTreasure } from \"GameConstants/Interfaces\";\r\nimport {\r\n  PlayerStats,\r\n  PlayerCultivationManual,\r\n  InventoryItem,\r\n  PlayerContextType,\r\n} from \"GameConstants/Interfaces\";\r\n\r\n// Functions that calculate total player stats values based on inGame variables\r\nexport function calculateStat(stat: string, player: PlayerContextType) {\r\n  const cultivationMulti = manualsStatsMultiplier(stat, player.manuals);\r\n  const realmMulti = player.realm.power[stat] || 1;\r\n  const treasuresMulti = treasuresStatsMultiplier(stat, player.inventory);\r\n  const treasuresPower = treasuresBonus(stat, player.inventory);\r\n  return (\r\n    player.baseStats[stat] * realmMulti * cultivationMulti * treasuresMulti +\r\n    treasuresPower\r\n  );\r\n}\r\n\r\n// Returns all of the player stats\r\nexport function playerStats(player: PlayerContextType): PlayerStats {\r\n  let currentStats = { ...player.baseStats };\r\n  for (const [key] of Object.entries(player.baseStats)) {\r\n    currentStats[key] = calculateStat(key, player);\r\n  }\r\n\r\n  let stats = { ...player.stats, ...currentStats };\r\n  return stats;\r\n}\r\n\r\n// Calculates effect on player stats from manuals\r\nexport function manualsStatsMultiplier(\r\n  stat: string,\r\n  manuals: PlayerCultivationManual[] | undefined\r\n) {\r\n  // Calculate manuals multiplier\r\n  let totalPower = 1;\r\n  if (!manuals) return 1;\r\n  manuals.forEach((value) => {\r\n    try {\r\n      if (!value.isEquipped || !value.manual.stats) throw new Error(\"skip\");\r\n      const manualPower =\r\n        (value.manual.stats[stat] || 0) * value.learningProgress.level;\r\n      totalPower += manualPower;\r\n    } catch (error) {\r\n      /* do nothing*/\r\n    }\r\n  });\r\n  return totalPower;\r\n}\r\n\r\n// Treasures provide multiplier and flat bonus\r\nexport function treasuresStatsMultiplier(\r\n  stat: string,\r\n  treasures: InventoryItem[] | undefined\r\n) {\r\n  let totalMulti = 1;\r\n  if (!treasures) return 0;\r\n  treasures.forEach((item) => {\r\n    if (isInventoryTreasure(item) && item.isEquipped) {\r\n      const statsMulti = item.item.stats.statsMulti;\r\n      const itemMulti = (statsMulti && statsMulti[stat]) || 0;\r\n      totalMulti *= 1 + itemMulti;\r\n    }\r\n  });\r\n  return totalMulti;\r\n}\r\n\r\n// Treasures just provide flat bonuses for now\r\nexport function treasuresBonus(\r\n  stat: string,\r\n  treasures: InventoryItem[] | undefined\r\n) {\r\n  let totalBonus = 0;\r\n  if (!treasures) return 0;\r\n  treasures.forEach((item) => {\r\n    if (isInventoryTreasure(item) && item.isEquipped) {\r\n      const stats = item.item.stats.stats;\r\n      const itemBonus = (stats && stats[stat]) || 0;\r\n      totalBonus += itemBonus;\r\n    }\r\n  });\r\n  return totalBonus;\r\n}\r\n\r\ntype StatStructure = {\r\n  base: number;\r\n  realm: number;\r\n  manuals: number;\r\n  treasuresMulti: number;\r\n  treasures: number;\r\n};\r\n\r\n// Stat structure disambiguation for tooltips\r\nexport function getStatStructure(\r\n  stat: string,\r\n  player: PlayerContextType\r\n): StatStructure {\r\n  const { baseStats, realm, manuals, inventory } = player;\r\n  const baseStat = baseStats[stat];\r\n  const realmBonus = realm.power[stat] || 1;\r\n  const manualsBonus = manualsStatsMultiplier(stat, manuals);\r\n  const treasuresMulti = treasuresStatsMultiplier(stat, inventory);\r\n  const treasuresPower = treasuresBonus(stat, inventory);\r\n  return {\r\n    base: baseStat,\r\n    realm: realmBonus,\r\n    manuals: manualsBonus,\r\n    treasuresMulti,\r\n    treasures: treasuresPower,\r\n  };\r\n}\r\n","import { PlayerContextType } from \"GameConstants/Interfaces\";\r\nimport { EnemyType } from \"./Enemies\";\r\n\r\nexport function PlayerFightDps(player: PlayerContextType, enemy: EnemyType) {\r\n  return player.stats.attack / (1 + 0.01 * enemy.defence) - enemy.healthRegen;\r\n}\r\n\r\nexport function EnemyFightDps(enemy: EnemyType, player: PlayerContextType) {\r\n  return (\r\n    enemy.attack / (1 + 0.01 * player.stats.defence) - player.stats.healthRegen\r\n  );\r\n}\r\n","import { PlayerBaseStats } from \"GameConstants/Player\";\r\n\r\n// Function to increment player baseStats\r\nexport default function addBaseStats(\r\n  baseStats: PlayerBaseStats,\r\n  reward: Partial<PlayerBaseStats>,\r\n  times: number\r\n): PlayerBaseStats {\r\n  for (const [key, value] of Object.entries(reward)) {\r\n    try {\r\n      baseStats[key] += value * times;\r\n    } catch (error) {\r\n      console.log(`addBaseStats: ${error}`);\r\n    }\r\n  }\r\n  return baseStats;\r\n}\r\n","import { PlayerSkills } from \"GameConstants/Player\";\r\n\r\n// Function to increment player skill exp\r\nexport default function addSkillsExp(\r\n  skills: PlayerSkills,\r\n  reward: Partial<PlayerSkills>,\r\n  times: number\r\n): PlayerSkills {\r\n  for (const [key, value] of Object.entries(reward)) {\r\n    try {\r\n      skills[key] += value * times;\r\n    } catch (error) {\r\n      console.log(`addSkillExp: ${error}`);\r\n    }\r\n  }\r\n  return skills;\r\n}\r\n","import { PlayerSkills, PlayerBaseStats, PlayerEquipment } from \"../Player\";\r\nimport { Image } from \"../Interfaces\";\r\n\r\nconst Treasures: Treasure[] = [\r\n  {\r\n    name: \"Copper Sword\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/swords1.png\",\r\n      x: 2 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 0,\r\n    type: \"weapon\",\r\n  },\r\n  {\r\n    name: \"Copper Armor\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/armors.png\",\r\n      x: 1 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 0,\r\n    type: \"armor\",\r\n  },\r\n  {\r\n    name: \"Copper Helmet\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/helmets.png\",\r\n      x: 1 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 0,\r\n    type: \"helmet\",\r\n  },\r\n  {\r\n    name: \"Copper Pendant\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/pendants.png\",\r\n      x: 0,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 0,\r\n    type: \"pendant\",\r\n  },\r\n  {\r\n    name: \"Copper Ring\",\r\n    description: \"\",\r\n    image: { path: \"./treasures/rings.png\", x: 0, y: 0, sizeX: 32, sizeY: 32 },\r\n    realmIndex: 0,\r\n    type: \"ring\",\r\n  },\r\n  {\r\n    name: \"Iron Sword\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/swords1.png\",\r\n      x: 0 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 9,\r\n    type: \"weapon\",\r\n  },\r\n  {\r\n    name: \"Iron Armor\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/armors.png\",\r\n      x: 2 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 9,\r\n    type: \"armor\",\r\n  },\r\n  {\r\n    name: \"Iron Helmet\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/helmets.png\",\r\n      x: 2 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 9,\r\n    type: \"helmet\",\r\n  },\r\n  {\r\n    name: \"Iron Pendant\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/pendants.png\",\r\n      x: 1 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 9,\r\n    type: \"pendant\",\r\n  },\r\n  {\r\n    name: \"Iron Ring\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/rings.png\",\r\n      x: 1 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 9,\r\n    type: \"ring\",\r\n  },\r\n  {\r\n    name: \"Steel Sword\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/swords1.png\",\r\n      x: 4 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 18,\r\n    type: \"weapon\",\r\n  },\r\n  {\r\n    name: \"Steel Armor\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/armors.png\",\r\n      x: 3 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 18,\r\n    type: \"armor\",\r\n  },\r\n  {\r\n    name: \"Steel Helmet\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/helmets.png\",\r\n      x: 3 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 18,\r\n    type: \"helmet\",\r\n  },\r\n  {\r\n    name: \"Steel Pendant\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/pendants.png\",\r\n      x: 2 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 18,\r\n    type: \"pendant\",\r\n  },\r\n  {\r\n    name: \"Steel Ring\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/rings.png\",\r\n      x: 2 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 18,\r\n    type: \"ring\",\r\n  },\r\n  {\r\n    name: \"Cold Steel Sword\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/swords1.png\",\r\n      x: 5 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 27,\r\n    type: \"weapon\",\r\n  },\r\n  {\r\n    name: \"Cold Steel Armor\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/armors.png\",\r\n      x: 5 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 27,\r\n    type: \"armor\",\r\n  },\r\n  {\r\n    name: \"Cold Steel Helmet\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/helmets.png\",\r\n      x: 5 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 27,\r\n    type: \"helmet\",\r\n  },\r\n  {\r\n    name: \"Cold Steel Pendant\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/pendants.png\",\r\n      x: 4 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 27,\r\n    type: \"pendant\",\r\n  },\r\n  {\r\n    name: \"Cold Steel Ring\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/rings.png\",\r\n      x: 4 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 27,\r\n    type: \"ring\",\r\n  },\r\n  {\r\n    name: \"Golden Sword\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/swords1.png\",\r\n      x: 1 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 36,\r\n    type: \"weapon\",\r\n  },\r\n  {\r\n    name: \"Golden Armor\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/armors.png\",\r\n      x: 13 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 36,\r\n    type: \"armor\",\r\n  },\r\n  {\r\n    name: \"Golden Helmet\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/helmets.png\",\r\n      x: 13 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 36,\r\n    type: \"helmet\",\r\n  },\r\n  {\r\n    name: \"Golden Pendant\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/pendants.png\",\r\n      x: 3 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 36,\r\n    type: \"pendant\",\r\n  },\r\n  {\r\n    name: \"Golden Ring\",\r\n    description: \"\",\r\n    image: {\r\n      path: \"./treasures/rings.png\",\r\n      x: 3 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n    realmIndex: 36,\r\n    type: \"ring\",\r\n  },\r\n];\r\n\r\nexport type Treasure = {\r\n  name: string;\r\n\r\n  description: string;\r\n  image: Image;\r\n  type: TreasureType;\r\n  // Index in the realms array\r\n  realmIndex: number;\r\n  stats?: TreasureStats;\r\n  quality?: number;\r\n};\r\n\r\nexport type TreasureStats = {\r\n  stats?: Partial<PlayerBaseStats>;\r\n  statsMulti?: Partial<PlayerBaseStats>;\r\n  skills?: Partial<PlayerSkills>;\r\n  skillsMulti?: Partial<PlayerSkills>;\r\n};\r\n\r\nexport type TreasureType = (typeof PlayerEquipment)[number];\r\n\r\nexport default Treasures;\r\n","import React from \"react\";\r\nimport PlayerContext from \"../Player/PlayerContext\";\r\nimport { GameTimer } from \"GameEngine/GameRuntime\";\r\nimport { playerSkills } from \"GameEngine/Player/playerSkills\";\r\nimport { playerStats } from \"../Player/playerStats\";\r\nimport SettingsContext from \"GameEngine/SettingsContext/SettingContext\";\r\nimport { EnemyFightDps, PlayerFightDps } from \"GameConstants/Fighting/fightDps\";\r\nimport enemyTimesDefeated from \"GameEngine/shared/enemyTimesDefeated\";\r\nimport addBaseStats from \"GameEngine/shared/addBaseStats\";\r\nimport addSkillsExp from \"GameEngine/shared/addSkillExp\";\r\nimport rewardItems from \"GameEngine/shared/rewardItems\";\r\n\r\n// This is not yet properly tested, beware\r\nexport default function useFightManager(timer: GameTimer) {\r\n  const player = React.useContext(PlayerContext);\r\n  let {\r\n    stats,\r\n    baseStats,\r\n    baseSkills,\r\n    currentStats,\r\n    state,\r\n    skills,\r\n    inventory,\r\n    updateContext,\r\n  } = player;\r\n  const { gameSpeed } = React.useContext(SettingsContext);\r\n  const { currentTime, previousTime } = timer;\r\n  React.useEffect(() => {\r\n    // Update age\r\n    const elapsedTime = (timer.currentTime - timer.previousTime) * gameSpeed;\r\n    if (state.action !== \"fighting\" || !state.enemy) return;\r\n    const enemy = state.enemy;\r\n    // Calculate damage dealt by both parties\r\n    const playerDps = PlayerFightDps(player, enemy);\r\n    const enemyDps = EnemyFightDps(enemy, player);\r\n    const playerDamage = (playerDps * elapsedTime) / 1000;\r\n    const enemyDamage = (enemyDps * elapsedTime) / 1000;\r\n\r\n    const timesCompleted = enemyTimesDefeated(elapsedTime, enemy, player);\r\n\r\n    const newEnemyHealth = Math.min(\r\n      enemy.currentHealth - (playerDamage - enemy.health * timesCompleted),\r\n      enemy.health\r\n    );\r\n\r\n    const newPlayerHealth = Math.min(\r\n      currentStats.health - enemyDamage,\r\n      stats.health\r\n    );\r\n\r\n    // Process reward\r\n    if (timesCompleted > 0) {\r\n      // If activity increaces base stats\r\n      if (enemy.result.baseStats)\r\n        baseStats = addBaseStats(\r\n          baseStats,\r\n          enemy.result.baseStats,\r\n          timesCompleted\r\n        );\r\n      if (enemy.result.skills) {\r\n        baseSkills = addSkillsExp(\r\n          baseSkills,\r\n          enemy.result.skills,\r\n          timesCompleted\r\n        );\r\n      }\r\n\r\n      // Process reward\r\n      if (enemy.result.items) {\r\n        inventory = rewardItems(player, enemy.result.items, timesCompleted);\r\n      }\r\n    }\r\n\r\n    // Loss condition\r\n    if (newPlayerHealth <= 0) {\r\n      state = { action: \"idle\", enemy: undefined };\r\n    }\r\n    // Update Hp values for both parties\r\n    else {\r\n      currentStats.health = newPlayerHealth;\r\n      state.enemy.currentHealth = newEnemyHealth;\r\n    }\r\n    // Update calculated stat values based on new baseStats\r\n    stats = playerStats(player);\r\n    skills = playerSkills(player);\r\n    updateContext({\r\n      currentStats,\r\n      baseStats,\r\n      baseSkills,\r\n      inventory,\r\n      state,\r\n      stats,\r\n      skills,\r\n    });\r\n  }, [currentTime]);\r\n}\r\n","import { EnemyFightDps, PlayerFightDps } from \"GameConstants/Fighting/fightDps\";\r\nimport { PlayerContextType, PlayerEnemyType } from \"GameConstants/Interfaces\";\r\n\r\n// Calculate the amount of times enemy can be defeated in a certain time period\r\nexport default function enemyTimesDefeated(\r\n  elapsedTime: number,\r\n  enemy: PlayerEnemyType,\r\n  player: PlayerContextType\r\n) {\r\n  const { currentStats } = player;\r\n  const playerDps = PlayerFightDps(player, enemy);\r\n  const enemyDps = EnemyFightDps(enemy, player);\r\n  let playerDamage = (playerDps * elapsedTime) / 1000;\r\n  let enemyDamage = (enemyDps * elapsedTime) / 1000;\r\n  if (enemyDamage >= currentStats.health) {\r\n    playerDamage *= currentStats.health / enemyDamage; // if the player actually died in this span of time\r\n  }\r\n  if (playerDamage < enemy.currentHealth) return 0;\r\n  if (playerDamage < enemy.health)\r\n    return playerDamage > enemy.currentHealth ? 1 : 0;\r\n  return Math.floor((playerDamage - enemy.currentHealth) / enemy.health);\r\n}\r\n","import { Activity, ActivityItem } from \"GameConstants/Activities\";\r\nimport CraftingFunctions from \"GameConstants/Activities/Crafting\";\r\nimport {\r\n  CountableItem,\r\n  CountableItems,\r\n  InventoryItem,\r\n  PlayerContextType,\r\n  isCountableItem,\r\n} from \"GameConstants/Interfaces\";\r\n\r\nimport Treasures, { Treasure } from \"GameConstants/Items/Treasures\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\n// Add activity reward to the players inventory\r\nexport default function rewardItems(\r\n  player: PlayerContextType,\r\n  items: ActivityItem[],\r\n  times: number\r\n): InventoryItem[] {\r\n  let inventory = player.inventory;\r\n  for (let piece of items) {\r\n    try {\r\n      // Process money type reward\r\n      if (CountableItems.includes(piece.type as any)) {\r\n        let item = piece as CountableItem;\r\n        const amountToAdd = item.amount * times;\r\n        const itemIndex = inventory.findIndex(\r\n          (value) =>\r\n            value.type === item.type &&\r\n            (value as CountableItem).name === item.name\r\n        );\r\n        const currentItem = inventory[itemIndex];\r\n        if (itemIndex === -1) {\r\n          /* don't have this type of money yet */ inventory.push({\r\n            type: item.type,\r\n            id: uuid(),\r\n            name: item.name,\r\n            amount: amountToAdd,\r\n          });\r\n        } else if (currentItem && isCountableItem(currentItem)) {\r\n          /* player already possess this type of money */\r\n          currentItem.amount += amountToAdd;\r\n        }\r\n      }\r\n      // process treasure type rewards\r\n      if (piece.type === \"treasure\") {\r\n        let treasure = <InventoryItem | any>{};\r\n        // using deep copy for the object\r\n        let item = JSON.parse(\r\n          JSON.stringify(Treasures.find((i: Treasure) => i.name === piece.name))\r\n        );\r\n        if (item) {\r\n          treasure.type = \"treasure\";\r\n          treasure.id = uuid();\r\n          treasure.item = item;\r\n        }\r\n        if (treasure) {\r\n          for (let i = 0; i < times * piece.amount; i++) {\r\n            inventory.push(treasure);\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(`rewardItems: ${error}`);\r\n    }\r\n  }\r\n  return inventory;\r\n}\r\n","import { Activity } from \"./Activities\";\r\nimport { month, day } from \"../Constants\";\r\n\r\n// Provide bonuses to base stats\r\n// Placeholder values for now\r\nlet Trainings: Activity[] = [\r\n  {\r\n    // This one is totally overpowered, serves for test purposes :)\r\n    name: \"Running\",\r\n    baseTime: 5 * day,\r\n    result: {\r\n      baseStats: {\r\n        health: 0.5,\r\n        attack: 0.1,\r\n      },\r\n      skills: {\r\n        training: 0.01,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Breathing Practice\",\r\n    baseTime: 5 * day,\r\n    result: {\r\n      baseStats: {\r\n        health: 1,\r\n        healthRegen: 0.01,\r\n      },\r\n      skills: {\r\n        training: 0.01,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Squats\",\r\n    baseTime: 5 * day,\r\n    result: {\r\n      baseStats: {\r\n        attack: 0.2,\r\n      },\r\n      skills: {\r\n        training: 0.01,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Dodge\",\r\n    baseTime: 5 * day,\r\n    result: {\r\n      baseStats: {\r\n        defence: 0.1,\r\n      },\r\n      skills: {\r\n        training: 0.01,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Situps\",\r\n    baseTime: month,\r\n    result: {\r\n      baseStats: {\r\n        health: 1.5,\r\n        attack: 0.3,\r\n      },\r\n      skills: {\r\n        training: 0.03,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Relaxation\",\r\n    baseTime: month,\r\n    result: {\r\n      baseStats: {\r\n        health: 3,\r\n        healthRegen: 0.03,\r\n      },\r\n      skills: {\r\n        training: 0.03,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Basic Punch\",\r\n    baseTime: month,\r\n    result: {\r\n      baseStats: {\r\n        attack: 0.6,\r\n      },\r\n      skills: {\r\n        training: 0.03,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Block\",\r\n    baseTime: month,\r\n    result: {\r\n      baseStats: {\r\n        defence: 0.3,\r\n      },\r\n      skills: {\r\n        training: 0.03,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Swimming\",\r\n    baseTime: 5 * month,\r\n    result: {\r\n      baseStats: {\r\n        health: 5,\r\n        attack: 1,\r\n      },\r\n      skills: {\r\n        training: 0.1,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Climb Mountains\",\r\n    baseTime: 5 * month,\r\n    result: {\r\n      baseStats: {\r\n        health: 10,\r\n        healthRegen: 0.1,\r\n      },\r\n      skills: {\r\n        training: 0.1,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Hit the Scarecrows\",\r\n    baseTime: 5 * month,\r\n    result: {\r\n      baseStats: {\r\n        attack: 2,\r\n      },\r\n      skills: {\r\n        training: 0.1,\r\n      },\r\n    },\r\n  },\r\n  {\r\n    name: \"Defence Stance\",\r\n    baseTime: 5 * month,\r\n    result: {\r\n      baseStats: {\r\n        defence: 1,\r\n      },\r\n      skills: {\r\n        training: 0.1,\r\n      },\r\n    },\r\n  },\r\n];\r\n\r\nTrainings = Trainings.map((item) => {\r\n  if (!item.time) item.time = \"training time\";\r\n  if (item.result.baseStats && !item.result.baseStatsMulti)\r\n    item.result.baseStatsMulti = \"default\";\r\n  if (item.result.skills && !item.result.skillsMulti)\r\n    item.result.skillsMulti = \"default\";\r\n  return item;\r\n});\r\n\r\nexport default Trainings;\r\n","import { Activity } from \"./Activities\";\r\nimport { day, month } from \"../Constants\";\r\n\r\n// Placeholder activities\r\nlet Mining: Activity[] = [\r\n  {\r\n    name: \"Copper\",\r\n    baseTime: 5 * day,\r\n    result: {\r\n      skills: {\r\n        mining: 0.01,\r\n      },\r\n      items: [{ type: \"mineral\", name: \"Copper\", amount: 1 }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Iron\",\r\n    baseTime: month,\r\n    result: {\r\n      skills: {\r\n        mining: 0.03,\r\n      },\r\n      items: [{ type: \"mineral\", name: \"Iron\", amount: 1 }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Steel\",\r\n    baseTime: 6 * month,\r\n    result: {\r\n      skills: {\r\n        mining: 0.1,\r\n      },\r\n      items: [{ type: \"mineral\", name: \"Steel\", amount: 1 }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Cold Steel\",\r\n    baseTime: 30 * month,\r\n    result: {\r\n      skills: {\r\n        mining: 0.3,\r\n      },\r\n      items: [{ type: \"mineral\", name: \"Cold Steel\", amount: 1 }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Celestial Gold\",\r\n    baseTime: 150 * month,\r\n    result: {\r\n      skills: {\r\n        mining: 1,\r\n      },\r\n      items: [{ type: \"mineral\", name: \"Celestial Gold\", amount: 1 }],\r\n    },\r\n  },\r\n];\r\n\r\nMining = Mining.map((item) => {\r\n  if (!item.time) item.time = \"mining time\";\r\n  if (item.result.baseStats && !item.result.baseStatsMulti)\r\n    item.result.baseStatsMulti = \"default\";\r\n  if (item.result.skills && !item.result.skillsMulti)\r\n    item.result.skillsMulti = \"default\";\r\n  return item;\r\n});\r\n\r\nexport default Mining;\r\n","import { Activity } from \"./Activities\";\r\nimport { day } from \"../Constants\";\r\n\r\n// Some example items for now\r\nlet Crafting: Activity[] = [\r\n  {\r\n    name: \"Copper Sword\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Copper\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Copper Sword\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Sword\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Copper Armor\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Copper\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Copper Armor\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Armor\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Copper Helmet\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and defence\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Copper\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Copper Helmet\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Helmet\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Copper Pendant\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and regen\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Copper\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Copper Pendant\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Pendant\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Copper Ring\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack and training\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Copper\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Copper Ring\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Ring\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Iron Sword\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Steel\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Iron Sword\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Sword\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Iron Armor\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Steel\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Iron Armor\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Armor\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Iron Helmet\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and defence\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Steel\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Iron Helmet\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Helmet\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Iron Pendant\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and regen\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Steel\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Iron Pendant\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Pendant\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Iron Ring\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack and training\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Steel\",\r\n          amount: 1,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Iron Ring\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Ring\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Steel Sword\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Steel\",\r\n          amount: 5,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Steel Sword\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Sword\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Steel Armor\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Steel\",\r\n          amount: 5,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Steel Armor\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Armor\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Steel Helmet\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and defence\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Steel\",\r\n          amount: 5,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Steel Helmet\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Helmet\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Steel Pendant\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and regen\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Steel\",\r\n          amount: 5,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Steel Pendant\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Pendant\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Steel Ring\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack and training\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Steel\",\r\n          amount: 5,\r\n          type: \"mineral\",\r\n        },\r\n        {\r\n          name: \"Iron\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Steel Ring\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Ring\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Cold Steel Sword\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Cold Steel\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Cold Steel Sword\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Sword\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Cold Steel Armor\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Cold Steel\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Cold Steel Armor\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Armor\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Cold Steel Helmet\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and defence\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Cold Steel\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Cold Steel Helmet\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Helmet\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Cold Steel Pendant\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and regen\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Cold Steel\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Cold Steel Pendant\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Pendant\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Cold Steel Ring\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack and training\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Cold Steel\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Cold Steel Ring\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Ring\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Golden Sword\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Celestial Gold\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Golden Sword\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Sword\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Golden Armor\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Celestial Gold\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Golden Armor\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Armor\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Golden Helmet\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and defence\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Celestial Gold\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Golden Helmet\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Helmet\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Golden Pendant\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts health and regen\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Celestial Gold\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Golden Pendant\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Pendant\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  {\r\n    name: \"Golden Ring\",\r\n    baseTime: 30 * day,\r\n    description: \"boosts attack and training\",\r\n    price: {\r\n      items: [\r\n        {\r\n          name: \"Celestial Gold\",\r\n          amount: 3,\r\n          type: \"mineral\",\r\n        },\r\n      ],\r\n    },\r\n    result: {\r\n      skills: { crafting: 0.1 },\r\n      skillsMulti: \"crafting skill reward\",\r\n      items: [\r\n        {\r\n          name: \"Golden Ring\",\r\n          amount: 1,\r\n          type: \"treasure\",\r\n          generator: \"Ring\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n];\r\n\r\nCrafting = Crafting.map((item) => {\r\n  if (item.result.skills && !item.result.skillsMulti)\r\n    item.result.skillsMulti = \"crafting skill reward\";\r\n  return item;\r\n});\r\n\r\nexport default Crafting;\r\n","import { PlayerContextType } from \"../Interfaces\";\r\nimport { PlayerBaseStats } from \"../Player\";\r\n\r\n//___________________________________________________________________\r\n// You can change breakthrough logic and Cultivation Realm stats here\r\n//___________________________________________________________________\r\n\r\nexport function TribulationDps(\r\n  realm: TribulationStats,\r\n  player: PlayerContextType\r\n) {\r\n  return (\r\n    realm.attack / (1 + 0.01 * player.stats.defence) - player.stats.healthRegen\r\n  );\r\n}\r\n\r\nexport function BreakthroughDps(\r\n  player: PlayerContextType,\r\n  realm: TribulationStats\r\n) {\r\n  return player.stats.attack / (1 + 0.01 * realm.defence) - realm.healthRegen;\r\n}\r\n\r\nexport type Tribulation = {\r\n  steps: number;\r\n  multiplier: number;\r\n  statsMulti: number;\r\n  stepReached?: number;\r\n};\r\n\r\nexport type TribulationStats = {\r\n  health: number;\r\n  healthRegen: number;\r\n  attack: number;\r\n  defence: number;\r\n};\r\n\r\nexport type CultivationRealm = {\r\n  name: string;\r\n  baseStats: TribulationStats;\r\n  currentStats?: TribulationStats & { currentHealth: number }; // currentHealth is for progress tracking\r\n  // Additional stats for heavenly tribulations\r\n  tribulation?: Tribulation;\r\n  // Reward stats multipliers\r\n  realmPowers: Partial<PlayerBaseStats>;\r\n};\r\n\r\nexport let CultivationRealms: CultivationRealm[] = [];\r\nconst LargeRealms = [\r\n  \"Mortal\",\r\n  \"Body Refinement\",\r\n  \"Qi Gathering\",\r\n  \"Foundation\",\r\n  \"Qi Transformation\",\r\n];\r\nconst smallRealmIndex = 9;\r\n\r\nconst multi = (factor: number, power: number) => factor ** power;\r\n\r\nconst tribulation = {\r\n  steps: 10,\r\n  statsMulti: 1.05,\r\n  multiplier: 1.1,\r\n};\r\n\r\nlet index = 0;\r\nfor (let realm of LargeRealms) {\r\n  for (let smallIndex = 1; smallIndex <= smallRealmIndex; smallIndex++) {\r\n    const name = realm + \" \" + smallIndex;\r\n    if (index === 0) {\r\n      CultivationRealms.push({\r\n        name,\r\n        baseStats: {\r\n          health: 0,\r\n          healthRegen: 0,\r\n          defence: 0,\r\n          attack: 0,\r\n        },\r\n        realmPowers: {\r\n          health: 1,\r\n          healthRegen: 1,\r\n          attack: 1,\r\n          defence: 1,\r\n          insight: 1,\r\n        },\r\n      });\r\n      index++;\r\n      continue;\r\n    }\r\n    const statMulti = multi(1.5, index - 1);\r\n    const powerMulti = multi(1.2, index);\r\n    CultivationRealms.push({\r\n      name,\r\n      baseStats: {\r\n        health: 50 * statMulti,\r\n        healthRegen: 0,\r\n        defence: 0,\r\n        attack: 6 * statMulti,\r\n      },\r\n      realmPowers: {\r\n        health: 1 * powerMulti,\r\n        healthRegen: 1 * powerMulti,\r\n        attack: 1 * powerMulti,\r\n        defence: 1,\r\n        insight: 1 * powerMulti,\r\n      },\r\n      tribulation: smallIndex === 1 ? tribulation : undefined,\r\n    });\r\n    index++;\r\n  }\r\n}\r\n","import { Activity } from \"./Activities\";\r\nimport { day, month } from \"../Constants\";\r\n\r\n// Placeholder activities\r\nlet Gathering: Activity[] = [\r\n  {\r\n    name: \"Collect grass\",\r\n    baseTime: 5 * day,\r\n    result: {\r\n      skills: {\r\n        gathering: 0.01,\r\n      },\r\n      items: [{ type: \"herb\", name: \"Grass Stalk\", amount: 1 }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Pick tree leaves\",\r\n    baseTime: month,\r\n    result: {\r\n      skills: {\r\n        gathering: 0.03,\r\n      },\r\n      items: [{ type: \"herb\", name: \"Oak leaf\", amount: 1 }],\r\n    },\r\n  },\r\n];\r\n\r\nGathering = Gathering.map((item) => {\r\n  if (!item.time) item.time = \"gathering time\";\r\n  if (item.result.baseStats && !item.result.baseStatsMulti)\r\n    item.result.baseStatsMulti = \"default\";\r\n  if (item.result.skills && !item.result.skillsMulti)\r\n    item.result.skillsMulti = \"default\";\r\n  return item;\r\n});\r\n\r\nexport default Gathering;\r\n","import Trainings from \"GameConstants/Activities/Trainings\";\r\nimport Mining from \"GameConstants/Activities/Mining\";\r\nimport Crafting from \"GameConstants/Activities/Craft\";\r\nimport { Activity } from \"./Activities/Activities\";\r\nimport {\r\n  CultivationRealm,\r\n  CultivationRealms,\r\n} from \"./Cultivation/CultivationRealms\";\r\nimport Gathering from \"./Activities/Gathering\";\r\nimport { Enemies, EnemyType } from \"./Fighting/Enemies\";\r\n\r\n// Declarations for the game mechanics\r\n// Contains game data. Is stored to localStorage every autosave interval.\r\nexport type GameContent = {\r\n  trainings: Activity[]; // List of available activities for training tab\r\n  mining: Activity[]; // List of available activities for mining tab\r\n  crafting: Activity[]; // List of available activities for crafting tab\r\n  gathering: Activity[]; // List of activities for gathering tab\r\n  cultivationRealms: CultivationRealm[]; // Player cultivation realms with all tribulations passed and stat modifiers\r\n  enemies: EnemyType[];\r\n};\r\n\r\nexport const gameContent: GameContent = {\r\n  trainings: Trainings,\r\n  mining: Mining,\r\n  crafting: Crafting,\r\n  gathering: Gathering,\r\n  cultivationRealms: CultivationRealms,\r\n  enemies: Enemies,\r\n};\r\n\r\nexport const NavigationBarPages = [\r\n  \"Training\",\r\n  \"Manuals\",\r\n  \"Breakthrough\",\r\n  \"Mining\",\r\n  \"Crafting\",\r\n  \"Gathering\",\r\n  \"Fighting\",\r\n];\r\n","import { ActivityItem } from \"GameConstants/Activities\";\r\nimport { PlayerBaseStats, PlayerSkills } from \"GameConstants/Player\";\r\n\r\nexport type EnemyType = {\r\n  name: string;\r\n  health: number;\r\n  healthRegen: number;\r\n  defence: number;\r\n  attack: number;\r\n  description?: string;\r\n  // Activity result (aka reward)\r\n  result: {\r\n    baseStats?: Partial<PlayerBaseStats>; // character stats rewarded for completing activity\r\n    baseStatsMulti?: string; // calculate stats reward multiplier\r\n    skills?: Partial<PlayerSkills>; // skill exp rewarded for completing activity\r\n    skillsMulti?: string; // calculate skills reward multiplier\r\n    items?: ActivityItem[]; // items rewarded for completing activity\r\n  };\r\n};\r\n\r\n// Total placeholder content\r\nexport const Enemies: EnemyType[] = [\r\n  {\r\n    name: \"Random Nobody\",\r\n    description: \"A pathetic person with no prospects in life\",\r\n    health: 10,\r\n    healthRegen: 0,\r\n    defence: 0,\r\n    attack: 1,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 1, name: \"Copper Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Street Thug\",\r\n    description: \"A gangster from the streets\",\r\n    health: 50,\r\n    healthRegen: 0,\r\n    defence: 0,\r\n    attack: 3,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 5, name: \"Copper Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Ordinary rabbit\",\r\n    description: \"Turns out, they are pretty dangerous\",\r\n    health: 150,\r\n    healthRegen: 1,\r\n    defence: 10,\r\n    attack: 4,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 20, name: \"Copper Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Feral Rat\",\r\n    health: 250,\r\n    healthRegen: 2,\r\n    defence: 30,\r\n    attack: 10,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 50, name: \"Copper Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Forest Wolf\",\r\n    health: 500,\r\n    healthRegen: 5,\r\n    defence: 10,\r\n    attack: 40,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 250, name: \"Copper Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Forest Bandit\",\r\n    health: 1000,\r\n    healthRegen: 10,\r\n    defence: 30,\r\n    attack: 70,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 1000, name: \"Copper Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Black Boar\",\r\n    health: 1500,\r\n    healthRegen: 10,\r\n    defence: 30,\r\n    attack: 150,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 1, name: \"Silver Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Turtle\",\r\n    health: 5000,\r\n    healthRegen: 25,\r\n    defence: 100,\r\n    attack: 30,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 5, name: \"Silver Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Stone Wolf\",\r\n    health: 8000,\r\n    healthRegen: 20,\r\n    defence: 50,\r\n    attack: 400,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 25, name: \"Silver Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"White Tiger\",\r\n    health: 15000,\r\n    healthRegen: 100,\r\n    defence: 50,\r\n    attack: 1000,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 200, name: \"Silver Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Forest Bandit Leader\",\r\n    health: 25000,\r\n    healthRegen: 200,\r\n    defence: 20,\r\n    attack: 1500,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 500, name: \"Silver Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Evil Bat\",\r\n    health: 50000,\r\n    healthRegen: 200,\r\n    defence: 60,\r\n    attack: 2500,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 1500, name: \"Silver Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Spirit Hare\",\r\n    description: \"What in the world is this thing?\",\r\n    health: 100000,\r\n    healthRegen: 400,\r\n    defence: 120,\r\n    attack: 4000,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 1, name: \"Golden Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Swamp Alligator\",\r\n    health: 250000,\r\n    healthRegen: 1500,\r\n    defence: 200,\r\n    attack: 10000,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 5, name: \"Golden Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Thunder Lizard\",\r\n    health: 600000,\r\n    healthRegen: 2500,\r\n    defence: 200,\r\n    attack: 20000,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 25, name: \"Golden Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Blazing Leopard\",\r\n    health: 1.2e6,\r\n    healthRegen: 6000,\r\n    defence: 250,\r\n    attack: 50000,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 150, name: \"Golden Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Steel Turtle\",\r\n    health: 2e6,\r\n    healthRegen: 10000,\r\n    defence: 500,\r\n    attack: 20000,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 350, name: \"Golden Coin\" }],\r\n    },\r\n  },\r\n  {\r\n    name: \"Arrogant Young Master\",\r\n    description: \"Never heard of you!\",\r\n    health: 4e6,\r\n    healthRegen: 10000,\r\n    defence: 100,\r\n    attack: 150000,\r\n    result: {\r\n      items: [{ type: \"money\", amount: 1000, name: \"Golden Coin\" }],\r\n    },\r\n  },\r\n];\r\n","import { GameContent, gameContent } from \"GameConstants/GameContent\";\r\nimport React from \"react\";\r\n\r\n// Declarations for the React Context type\r\n// Contains game data. Is stored to localStorage every autosave interval.\r\nexport type GameContextType = GameContent;\r\n\r\nexport const gameContext: GameContextType = gameContent;\r\n\r\n/** Context initializator */\r\nexport const GameContext = React.createContext({\r\n  ...gameContext,\r\n  updateContext: (newData: Partial<GameContextType>) => {},\r\n  setContext: (value: React.SetStateAction<GameContextType>) => {},\r\n});\r\n\r\nexport default GameContext;\r\n","import { Activity } from \"GameConstants/Activities\";\r\nimport { PlayerContextType, isCountableItem } from \"GameConstants/Interfaces\";\r\n\r\n// Calculate the number of times activity can be executed\r\nexport default function calculateMaxActions(\r\n  player: PlayerContextType,\r\n  action: Activity\r\n): number {\r\n  try {\r\n    let maxActions = Number.MAX_VALUE;\r\n    if (!action.price) return maxActions;\r\n    const priceMulti = action.price.priceMulti || 1;\r\n    if (action.price.baseStats) {\r\n      for (const [key, value] of Object.entries(action.price.baseStats)) {\r\n        const actionsNumber = Math.floor(\r\n          player.baseStats[key] / value / priceMulti\r\n        );\r\n        if (actionsNumber < maxActions) maxActions = actionsNumber;\r\n      }\r\n    }\r\n    if (action.price.items) {\r\n      for (const item of action.price.items) {\r\n        // Process money\r\n        if ([\"money\", \"mineral\"].includes(item.type)) {\r\n          const itemIndex = player.inventory.findIndex(\r\n            (value) =>\r\n              value.type === item.type && (value as any).name === item.name\r\n          );\r\n          if (itemIndex === -1) return 0;\r\n          const currentItem = player.inventory[itemIndex];\r\n          if (currentItem && isCountableItem(currentItem)) {\r\n            const actionsNumber = Math.floor(\r\n              currentItem.amount / item.amount / priceMulti\r\n            );\r\n            if (actionsNumber < maxActions) maxActions = actionsNumber;\r\n          }\r\n        }\r\n        // Process treasures\r\n        if (item.type === \"treasure\") {\r\n          const items = player.inventory.filter(\r\n            (value) =>\r\n              value.type === \"treasure\" && value.item.name === item.name\r\n          );\r\n          const actionsNumber = Math.floor(\r\n            items.length / item.amount / priceMulti\r\n          );\r\n          if (actionsNumber < maxActions) maxActions = actionsNumber;\r\n        }\r\n      }\r\n    }\r\n    return maxActions;\r\n  } catch (error) {\r\n    console.log(`calculateMaxActions: ${error}`);\r\n  }\r\n  return 0;\r\n}\r\n","// An example function\r\nexport default function quality(\r\n  realm: number,\r\n  crafting: number,\r\n  priceMulti?: number\r\n) {\r\n  const realmFactor = (realm + 1) / 10;\r\n  const divider = expDivider((1 + crafting) / (10 * 8 ** realmFactor));\r\n  return (\r\n    baseQuality *\r\n    (1 + 10 * crafting) * // Crafting impact\r\n    divider * // Realm Impact\r\n    (1 + 0.1 * (Math.sqrt(priceMulti || 1) - 1)) // Raw materials impact\r\n  );\r\n}\r\n\r\nexport function expDivider(x) {\r\n  return 1 - Math.exp(-x);\r\n}\r\n\r\nconst baseQuality = 10;\r\n","export default function power(quality: number, realm: number) {\r\n  const realmFactor = (realm + 1) / 10;\r\n  return quality * 6 ** realmFactor;\r\n}\r\n","import { Activity, ActivityItem } from \"GameConstants/Activities/Activities\";\r\nimport { PlayerContextType, InventoryTreasure } from \"GameConstants/Interfaces\";\r\nimport Treasures, {\r\n  Treasure,\r\n  TreasureStats,\r\n} from \"GameConstants/Items/Treasures\";\r\nimport { v4 as uuid } from \"uuid\";\r\nimport quality from \"./quality\";\r\nimport power from \"./power\";\r\n\r\n// A function that returns treasure item as a result. Stats are based on player current skills\r\nexport default function CraftTreasure(stats: (power: number) => TreasureStats) {\r\n  return function (\r\n    activity: Activity,\r\n    player: PlayerContextType,\r\n    item: ActivityItem\r\n  ): InventoryTreasure | undefined {\r\n    try {\r\n      let treasure = Treasures.find((i: Treasure) => i.name === item.name);\r\n      if (!treasure) throw new Error(`${item.name}  `);\r\n      const invTreasure: InventoryTreasure = {\r\n        type: \"treasure\",\r\n        id: uuid(),\r\n        item: treasure as Required<Treasure>,\r\n      };\r\n      const itemQuality = quality(\r\n        treasure.realmIndex,\r\n        player.skills.crafting,\r\n        activity?.price?.priceMulti || 1\r\n      );\r\n      const itemPower = power(itemQuality, treasure.realmIndex);\r\n      invTreasure.item.stats = stats(itemPower);\r\n      invTreasure.item.quality = itemQuality;\r\n      return invTreasure;\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n    return undefined;\r\n  };\r\n}\r\n","import quality from \"./quality\";\r\nimport power from \"./power\";\r\nimport CraftTreasure from \"./CraftTreasure\";\r\nimport {\r\n  armorStats,\r\n  helmetStats,\r\n  pendantStats,\r\n  ringStats,\r\n  swordStats,\r\n} from \"./CraftingFunctions\";\r\n\r\nconst CraftingFunctions = {\r\n  Sword: CraftTreasure(swordStats),\r\n  Armor: CraftTreasure(armorStats),\r\n  Helmet: CraftTreasure(helmetStats),\r\n  Ring: CraftTreasure(ringStats),\r\n  Pendant: CraftTreasure(pendantStats),\r\n};\r\n\r\nexport default CraftingFunctions;\r\n\r\nexport { quality, power };\r\n","import { TreasureStats } from \"GameConstants/Items/Treasures\";\r\n\r\nexport function swordStats(power: number): TreasureStats {\r\n  return {\r\n    stats: {\r\n      attack: power,\r\n    },\r\n    statsMulti: {\r\n      attack: Math.sqrt(power) / 100,\r\n    },\r\n  };\r\n}\r\n\r\nexport function armorStats(power: number): TreasureStats {\r\n  return {\r\n    stats: {\r\n      health: power * 5,\r\n    },\r\n    statsMulti: {\r\n      health: Math.sqrt(power) / 200,\r\n    },\r\n  };\r\n}\r\n\r\nexport function helmetStats(power: number): TreasureStats {\r\n  return {\r\n    stats: {\r\n      health: power,\r\n      defence: Math.sqrt(power),\r\n    },\r\n    statsMulti: {\r\n      health: Math.sqrt(power) / 200,\r\n      defence: Math.sqrt(power) / 1000,\r\n    },\r\n  };\r\n}\r\n\r\nexport function pendantStats(power: number): TreasureStats {\r\n  return {\r\n    stats: {\r\n      health: power,\r\n      healthRegen: power / 30,\r\n    },\r\n    statsMulti: {\r\n      health: Math.sqrt(power) / 200,\r\n      healthRegen: Math.sqrt(power) / 100,\r\n    },\r\n  };\r\n}\r\n\r\nexport function ringStats(power: number): TreasureStats {\r\n  return {\r\n    stats: {\r\n      attack: power / 2,\r\n    },\r\n    statsMulti: {\r\n      attack: Math.sqrt(power) / 200,\r\n    },\r\n    skillsMulti: {\r\n      training: Math.sqrt(power) / 200,\r\n    },\r\n  };\r\n}\r\n","import { Material } from \"../Interfaces\";\r\n// Placeholder content\r\nexport const Herbs: Material[] = [\r\n  {\r\n    name: \"Grass Stalk\",\r\n    description: \"Just an ordinary grass\",\r\n    image: {\r\n      path: \"./herbs/herbs.png\",\r\n      x: 32,\r\n      y: 6 * 32,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n  },\r\n  {\r\n    name: \"Oak leaf\",\r\n    description: \"A leaf from a big tree\",\r\n    image: {\r\n      path: \"./herbs/herbs.png\",\r\n      x: 2 * 32,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n  },\r\n];\r\n","import { Material } from \"../Interfaces\";\r\n// Placeholder content\r\nexport const Minerals: Material[] = [\r\n  {\r\n    name: \"Copper\",\r\n    description: \"A good for nothing material\",\r\n    image: {\r\n      path: \"./minerals/icon48.png\",\r\n      x: 0,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n  },\r\n  {\r\n    name: \"Iron\",\r\n    description: \"The basic crafting necessity\",\r\n    image: {\r\n      path: \"./minerals/icon47.png\",\r\n      x: 0,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n  },\r\n  {\r\n    name: \"Steel\",\r\n    description: \"Ordinary Steel\",\r\n    image: {\r\n      path: \"./minerals/icon2.png\",\r\n      x: 0,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n  },\r\n  {\r\n    name: \"Cold Steel\",\r\n    description: \"Much harder than regular Steel\",\r\n    image: {\r\n      path: \"./minerals/icon1.png\",\r\n      x: 0,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n  },\r\n  {\r\n    name: \"Celestial Gold\",\r\n    description: \"The best material for treasures\",\r\n    image: {\r\n      path: \"./minerals/icon7.png\",\r\n      x: 0,\r\n      y: 0,\r\n      sizeX: 32,\r\n      sizeY: 32,\r\n    },\r\n  },\r\n];\r\n","import { Image } from \"../Interfaces\";\r\n// Placeholder content\r\nconst Money: MoneyType[] = [\r\n  {\r\n    name: \"Copper Coin\",\r\n    description: \"The most common currency of the Mortal World\",\r\n    image: {\r\n      path: \"./money/coins.png\",\r\n      x: 0,\r\n      y: 36,\r\n      sizeX: 36,\r\n      sizeY: 36,\r\n    },\r\n  },\r\n  {\r\n    name: \"Silver Coin\",\r\n    description: \"Currency for slighter wealthier mortals\",\r\n    image: {\r\n      path: \"./money/coins.png\",\r\n      x: 0,\r\n      y: 72,\r\n      sizeX: 36,\r\n      sizeY: 36,\r\n    },\r\n  },\r\n  {\r\n    name: \"Golden Coin\",\r\n    description: \"The eternal store of value, at least for mortals\",\r\n    image: {\r\n      path: \"./money/coins.png\",\r\n      x: 0,\r\n      y: 0,\r\n      sizeX: 36,\r\n      sizeY: 36,\r\n    },\r\n  },\r\n];\r\n\r\nexport type MoneyType = {\r\n  name: string;\r\n  description: string;\r\n  image: Image;\r\n};\r\n\r\nexport default Money;\r\n","import { Activity } from \"./Activities\";\r\nimport { PlayerContextType } from \"../Interfaces\";\r\nimport { quality } from \"./Crafting\";\r\nimport { Treasures } from \"GameConstants/Items\";\r\nimport { Treasure } from \"GameConstants/Items/Treasures\";\r\nimport power from \"./Crafting/power\";\r\n\r\n// One function per activity type (training, crafting, mining) - determines how to calculate how long an activity takes based on skill level\r\nconst ActivitiesFunctions = {\r\n  \"training time\": function (activity: Activity, player: PlayerContextType) {\r\n    const { skills } = player;\r\n    const multi = 1 + skills.training;\r\n    return activity.baseTime / multi;\r\n  },\r\n  \"mining time\": function (activity: Activity, player: PlayerContextType) {\r\n    const { skills } = player;\r\n    const multi = 1 + skills.mining;\r\n    return activity.baseTime / multi;\r\n  },\r\n  \"gathering time\": function (activity: Activity, player: PlayerContextType) {\r\n    const { skills } = player;\r\n    const multi = 1 + skills.gathering;\r\n    return activity.baseTime / multi;\r\n  },\r\n  \"crafting skill reward\": function (\r\n    activity: Activity,\r\n    player: PlayerContextType\r\n  ): number {\r\n    const priceMulti = activity.price?.priceMulti || 1;\r\n    const mainItem = activity.result.items\r\n      ? activity.result.items[0]\r\n      : undefined;\r\n    if (!mainItem) return 1;\r\n    let treasure = Treasures.find((i: Treasure) => i.name === mainItem.name);\r\n    if (!treasure) return 1;\r\n    const itemQuality = quality(\r\n      treasure.realmIndex,\r\n      player.skills.crafting,\r\n      priceMulti\r\n    );\r\n    const itemPower = power(itemQuality, treasure.realmIndex);\r\n    return Math.max(1, Math.sqrt(0.1 * itemPower));\r\n  },\r\n  default: function (activity: Activity): number {\r\n    return 1 / divisionCoeff(activity.timesCompleted || 0);\r\n  },\r\n};\r\n\r\n// A placeholder function\r\nexport function divisionCoeff(timesCompleted: number) {\r\n  if (timesCompleted <= 10) return 1;\r\n  return 0.233 * (1 + Math.sqrt(timesCompleted));\r\n}\r\n\r\nexport default ActivitiesFunctions;\r\n","import { playerStats } from \"../Player/playerStats\";\r\nimport React from \"react\";\r\nimport PlayerContext from \"../Player/PlayerContext\";\r\nimport { GameTimer } from \"GameEngine/GameRuntime\";\r\nimport GameContext from \"GameEngine/GameContext/GameContext\";\r\nimport removeItems from \"GameEngine/shared/removeItems\";\r\nimport addBaseStats from \"GameEngine/shared/addBaseStats\";\r\nimport calculateTimesCompleted from \"GameEngine/shared/calculateTimesCompleted\";\r\nimport addSkillsExp from \"GameEngine/shared/addSkillExp\";\r\nimport { playerSkills } from \"GameEngine/Player/playerSkills\";\r\nimport rewardActivityItems from \"GameEngine/shared/rewardActivityItems\";\r\nimport SettingsContext from \"GameEngine/SettingsContext/SettingContext\";\r\nimport { ActivitiesFunctions, Activity } from \"GameConstants/Activities\";\r\nimport calculateMaxActions from \"GameEngine/shared/calculateMaxActions\";\r\n\r\n// The main function for inGame player actions processing\r\nexport default function useActivityManager(timer: GameTimer) {\r\n  const player = React.useContext(PlayerContext);\r\n  const game = React.useContext(GameContext);\r\n  const { gameSpeed } = React.useContext(SettingsContext);\r\n  let {\r\n    state,\r\n    baseStats,\r\n    stats,\r\n    inventory,\r\n    baseSkills,\r\n    skills,\r\n    updateContext,\r\n  } = player;\r\n\r\n  React.useEffect(() => {\r\n    try {\r\n      // Bail out\r\n      if (state.action !== \"activity\" || !state.activity) return;\r\n\r\n      // Calculate activity progress based on time passed\r\n      const elapsedTime = (timer.currentTime - timer.previousTime) * gameSpeed;\r\n      let activity = game[state.activity.source].find(\r\n        (item: Activity) => state.activity && item.name === state.activity.name\r\n      );\r\n      if (!activity) return;\r\n      if (!activity.currentTime) activity.currentTime = 0;\r\n      const maxActions = calculateMaxActions(player, activity);\r\n      if (maxActions === 0) {\r\n        // bail out if player can't complete action even a single time\r\n        state = { action: \"idle\", activity: undefined };\r\n        updateContext({ state });\r\n      }\r\n      const { timesCompleted, currentTime } = calculateTimesCompleted(\r\n        elapsedTime,\r\n        activity,\r\n        player\r\n      );\r\n\r\n      activity.currentTime = currentTime;\r\n      activity.timesCompleted =\r\n        (activity?.timesCompleted || 0) + timesCompleted;\r\n      // Action not completed yet. Just update the progress and move on\r\n      if (timesCompleted === 0) {\r\n        game.updateContext({ ...game });\r\n        return;\r\n      }\r\n      // Action finished. Process cost and reward\r\n      else {\r\n        // Process activity price a bit of a hacky way\r\n        if (activity.price) {\r\n          const priceMulti = activity.priceMulti || 1;\r\n          if (activity.price.baseStats)\r\n            baseStats = addBaseStats(\r\n              baseStats,\r\n              activity.price.baseStats,\r\n              -timesCompleted * priceMulti\r\n            );\r\n          // Process activity price in terms of items\r\n          if (activity.price.items)\r\n            inventory = removeItems(\r\n              inventory,\r\n              activity.price.items,\r\n              timesCompleted * priceMulti\r\n            );\r\n        }\r\n\r\n        // If activity increaces base stats\r\n        if (activity.result.baseStats)\r\n          baseStats = addBaseStats(\r\n            baseStats,\r\n            activity.result.baseStats,\r\n            timesCompleted *\r\n              (typeof activity.result.baseStatsMulti === \"string\"\r\n                ? ActivitiesFunctions[activity.result.baseStatsMulti](\r\n                    activity,\r\n                    player\r\n                  )\r\n                : 1)\r\n          );\r\n        if (activity.result.skills) {\r\n          baseSkills = addSkillsExp(\r\n            baseSkills,\r\n            activity.result.skills,\r\n            timesCompleted *\r\n              (typeof activity.result.skillsMulti === \"string\"\r\n                ? ActivitiesFunctions[activity.result.skillsMulti](\r\n                    activity,\r\n                    player\r\n                  )\r\n                : 1)\r\n          );\r\n        }\r\n\r\n        // Process reward\r\n        if (activity.result.items) {\r\n          inventory = rewardActivityItems(player, activity, timesCompleted);\r\n        }\r\n      }\r\n      // Update calculated stat values based on new baseStats\r\n      stats = playerStats(player);\r\n      skills = playerSkills(player);\r\n      updateContext({ stats, baseStats, baseSkills, skills, inventory });\r\n    } catch (error) {\r\n      console.log(`Error in useActivityManager: ${error}`);\r\n    }\r\n  }, [timer]);\r\n}\r\n","import { Activity } from \"GameConstants/Activities/Activities\";\r\nimport calculateMaxActions from \"./calculateMaxActions\";\r\nimport { PlayerContextType } from \"GameConstants/Interfaces\";\r\nimport { ActivitiesFunctions } from \"GameConstants/Activities\";\r\n\r\n// Calculate how many times activity can be completed considering activity price\r\nexport default function calculateTimesCompleted(\r\n  elapsedTime: number,\r\n  activity: Activity,\r\n  player: PlayerContextType\r\n): { timesCompleted: number; currentTime: number } {\r\n  let currentTime = activity.currentTime || 0;\r\n  currentTime += elapsedTime;\r\n  // Calculate overflow\r\n  const requiredTime = activity.time\r\n    ? ActivitiesFunctions[activity.time](activity, player)\r\n    : activity.baseTime;\r\n  let timesCompleted = Math.floor(currentTime / requiredTime);\r\n  currentTime = currentTime - timesCompleted * requiredTime;\r\n  // Limit if activity has a set price\r\n  const maxActions = calculateMaxActions(player, activity);\r\n  if (maxActions <= timesCompleted) currentTime = 0; // reset to the end of the last completed activity\r\n  timesCompleted = Math.min(timesCompleted, maxActions);\r\n  return { timesCompleted, currentTime };\r\n}\r\n","import { ActivityItem } from \"GameConstants/Activities\";\r\nimport {\r\n  InventoryItem,\r\n  CountableItem,\r\n  isCountableItem,\r\n} from \"GameConstants/Interfaces\";\r\n\r\n// Removes an array of items from players inventory\r\nexport default function removeItems(\r\n  inventory: InventoryItem[],\r\n  price: ActivityItem[],\r\n  times: number\r\n): InventoryItem[] {\r\n  for (let piece of price) {\r\n    try {\r\n      // Process money type reward\r\n      if ([\"money\", \"mineral\"].includes(piece.type)) {\r\n        let item = piece as CountableItem;\r\n        const amountToRemove = item.amount * times;\r\n        const itemIndex = inventory.findIndex(\r\n          (value) =>\r\n            value.type === piece.type &&\r\n            (value as CountableItem).name === item.name\r\n        );\r\n        const currentItem = inventory[itemIndex];\r\n        if (itemIndex === -1) {\r\n          throw new Error(`Not enough ${piece.name} to complete action`);\r\n        } else if (currentItem && isCountableItem(currentItem)) {\r\n          /* player already possess this type of money */\r\n          if (currentItem.amount < amountToRemove)\r\n            throw new Error(`Not enough ${piece.name} to complete action`);\r\n          currentItem.amount -= amountToRemove;\r\n          if (currentItem.amount === 0) inventory.splice(itemIndex, 1);\r\n        }\r\n      }\r\n      // process treasure type rewards\r\n      if (piece.type === \"treasure\") {\r\n        for (let i = 0; i < times * piece.amount; i++) {\r\n          const itemIndex = inventory.findIndex(\r\n            (item) => item.type === \"treasure\" && item.item.name === piece.name\r\n          );\r\n          if (itemIndex === -1)\r\n            throw new Error(`Not enough ${piece.name} to complete action`);\r\n          inventory.splice(itemIndex, 1);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(`removeItems: ${error}`);\r\n    }\r\n  }\r\n  return inventory;\r\n}\r\n","import { Activity } from \"GameConstants/Activities\";\r\nimport CraftingFunctions from \"GameConstants/Activities/Crafting\";\r\nimport {\r\n  CountableItem,\r\n  CountableItems,\r\n  InventoryItem,\r\n  PlayerContextType,\r\n  isCountableItem,\r\n} from \"GameConstants/Interfaces\";\r\n\r\nimport Treasures, { Treasure } from \"GameConstants/Items/Treasures\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\n// Add activity reward to the players inventory\r\nexport default function rewardActivityItems(\r\n  player: PlayerContextType,\r\n  activity: Activity,\r\n  times: number\r\n): InventoryItem[] {\r\n  let inventory = player.inventory;\r\n  if (!activity.result.items) return [];\r\n  for (let piece of activity.result.items) {\r\n    try {\r\n      // Process money type reward\r\n      if (CountableItems.includes(piece.type as any)) {\r\n        let item = piece as CountableItem;\r\n        const amountToAdd = item.amount * times;\r\n        const itemIndex = inventory.findIndex(\r\n          (value) =>\r\n            value.type === item.type &&\r\n            (value as CountableItem).name === item.name\r\n        );\r\n        const currentItem = inventory[itemIndex];\r\n        if (itemIndex === -1) {\r\n          /* don't have this type of money yet */ inventory.push({\r\n            type: item.type,\r\n            id: uuid(),\r\n            name: item.name,\r\n            amount: amountToAdd,\r\n          });\r\n        } else if (currentItem && isCountableItem(currentItem)) {\r\n          /* player already possess this type of money */\r\n          currentItem.amount += amountToAdd;\r\n        }\r\n      }\r\n      // process treasure type rewards\r\n      if (piece.type === \"treasure\") {\r\n        let treasure = <InventoryItem | any>{};\r\n        if (piece.generator)\r\n          treasure = JSON.parse(\r\n            JSON.stringify(\r\n              CraftingFunctions[piece.generator](activity, player, piece)\r\n            )\r\n          );\r\n        // using deep copy for the object\r\n        else {\r\n          let item = JSON.parse(\r\n            JSON.stringify(\r\n              Treasures.find((i: Treasure) => i.name === piece.name)\r\n            )\r\n          );\r\n          if (item) {\r\n            treasure.type = \"treasure\";\r\n            treasure.id = uuid();\r\n            treasure.item = item;\r\n          }\r\n        }\r\n        if (treasure) {\r\n          for (let i = 0; i < times * piece.amount; i++) {\r\n            inventory.push(treasure);\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(`rewardActivityItems: ${error}`);\r\n    }\r\n  }\r\n  return inventory;\r\n}\r\n","import { CultivationRealm } from \"GameConstants/Cultivation/CultivationRealms\";\r\nimport { PlayerBaseStats, baseStats } from \"GameConstants/Player\";\r\n\r\n// Caclulates realm stats multiplier based on all tribulations completed\r\nexport default function calculateRealmPower(\r\n  index: number,\r\n  realms: CultivationRealm[]\r\n): PlayerBaseStats {\r\n  const power = <PlayerBaseStats>{};\r\n  for (const [key] of Object.entries(baseStats)) {\r\n    power[key] = 1;\r\n  }\r\n  // Take current realm into account\r\n  for (let [key, value] of Object.entries(realms[index].realmPowers)) {\r\n    power[key] *= value;\r\n  }\r\n  // Take all reached heavenly tribulation steps into account\r\n  for (let i = 0; i <= index; i++) {\r\n    const realm = realms[i];\r\n    if (!realm.tribulation || !realm.tribulation.stepReached) continue;\r\n    const powerMulti =\r\n      realm.tribulation.statsMulti ** realm.tribulation.stepReached;\r\n    for (let [key] of Object.entries(realm.realmPowers)) {\r\n      power[key] *= powerMulti;\r\n    }\r\n  }\r\n  return power;\r\n}\r\n","import { CultivationRealm } from \"GameConstants/Cultivation/CultivationRealms\";\r\n\r\n// For the breakthrough manager\r\nexport default function calculateTribulationPower(\r\n  index: number,\r\n  realms: CultivationRealm[]\r\n): { health: number; attack: number; healthRegen: number; defence: number } {\r\n  const currentRealm = realms[index];\r\n  const power = {\r\n    health: currentRealm.baseStats.health,\r\n    attack: currentRealm.baseStats.attack,\r\n    healthRegen: currentRealm.baseStats.healthRegen,\r\n    defence: currentRealm.baseStats.defence,\r\n  };\r\n  // First step doesn't get more difficult\r\n  if (!currentRealm.tribulation || !currentRealm.tribulation.stepReached)\r\n    return power;\r\n  // Take all reached heavenly tribulation steps into account\r\n  for (let i = 0; i <= index; i++) {\r\n    const realm = realms[i];\r\n    if (!realm.tribulation || !realm.tribulation.stepReached) continue;\r\n    const powerMulti =\r\n      realm.tribulation.multiplier ** realm.tribulation.stepReached;\r\n\r\n    power.health *= powerMulti;\r\n    power.attack *= powerMulti;\r\n    power.defence *= powerMulti;\r\n    power.healthRegen *= powerMulti;\r\n  }\r\n\r\n  return power;\r\n}\r\n","import React from \"react\";\r\n\r\nimport useAgeManager from \"./Managers/useAgeManager\";\r\nimport useDefaultRegenManager from \"./Managers/useDefaultRegenManager\";\r\nimport useFightManager from \"./Managers/useFightManager\";\r\nimport useCultivationManager from \"./Managers/useCultivationManager\";\r\nimport useActivityManager from \"./Managers/useActivityManager\";\r\nimport useBreakthroughManager from \"./Managers/useBreakthroughManager\";\r\nimport SettingsContext from \"./SettingsContext/SettingContext\";\r\n\r\nexport type GameTimer = {\r\n  previousTime: number;\r\n  currentTime: number;\r\n};\r\n\r\n// Wrapper for loading player save data\r\nexport default function GameRuntime(props: any) {\r\n  const { tickRate } = React.useContext(SettingsContext);\r\n\r\n  const [timer, setTimer] = React.useState<GameTimer>({\r\n    previousTime: Date.now(),\r\n    currentTime: Date.now(),\r\n  });\r\n\r\n  // Initializing the game loop\r\n  React.useEffect(() => {\r\n    // update the timers\r\n    const interval = setInterval(() => {\r\n      setTimer((timer) => ({\r\n        previousTime: timer.currentTime,\r\n        currentTime: Date.now(),\r\n      }));\r\n    }, 1000 / tickRate);\r\n    // clears the timer on component unmount to prevent memory leak\r\n    return () => {\r\n      clearInterval(interval);\r\n    };\r\n  }, [tickRate]);\r\n\r\n  // Run game managers\r\n  useAgeManager(timer);\r\n  useDefaultRegenManager(timer);\r\n  useFightManager(timer);\r\n  useCultivationManager(timer);\r\n  useActivityManager(timer);\r\n  useBreakthroughManager(timer);\r\n\r\n  return <>{props.children}</>;\r\n}\r\n","import React from \"react\";\r\nimport PlayerContext from \"../Player/PlayerContext\";\r\nimport { GameTimer } from \"GameEngine/GameRuntime\";\r\nimport SettingsContext from \"GameEngine/SettingsContext/SettingContext\";\r\n\r\n// Just a function to update player age\r\nexport default function useAgeManager(timer: GameTimer) {\r\n  const { stats, state, updateContext } = React.useContext(PlayerContext);\r\n  const { gameSpeed } = React.useContext(SettingsContext);\r\n\r\n  const { currentTime, previousTime } = timer;\r\n  React.useEffect(() => {\r\n    // Update age\r\n    if ([\"idle\", \"breakthrough\"].includes(state.action)) return;\r\n    const elapsedTime = (timer.currentTime - timer.previousTime) * gameSpeed;\r\n    stats.age += elapsedTime;\r\n    updateContext({ stats });\r\n  }, [currentTime]);\r\n}\r\n","import PlayerContext from \"../Player/PlayerContext\";\r\nimport React from \"react\";\r\nimport { GameTimer } from \"GameEngine/GameRuntime\";\r\nimport SettingsContext from \"GameEngine/SettingsContext/SettingContext\";\r\nimport { month } from \"GameConstants/Constants\";\r\n\r\n// Placeholder. #todo: replace it with some better logic.\r\nexport default function useDefaultRegenManager(timer: GameTimer) {\r\n  const { stats, currentStats, state, updateContext } =\r\n    React.useContext(PlayerContext);\r\n  const { gameSpeed } = React.useContext(SettingsContext);\r\n  const { currentTime, previousTime } = timer;\r\n  React.useEffect(() => {\r\n    // Regen health if health is not full\r\n    const elapsedTime = (currentTime - previousTime) * gameSpeed;\r\n    if (\r\n      currentStats.health <= stats.health &&\r\n      [\"training\", \"activity\", \"cultivating\"].includes(state.action)\r\n    ) {\r\n      const passiveRegen = 30; // additional passive regen outside of fighting in percents of max health\r\n      const additionalHealth =\r\n        (((stats.health * passiveRegen) / 100) * elapsedTime) / month;\r\n      currentStats.health = Math.min(\r\n        currentStats.health +\r\n          (stats.healthRegen * elapsedTime) / 1000 +\r\n          additionalHealth,\r\n        stats.health\r\n      );\r\n      updateContext({ stats });\r\n    }\r\n  }, [currentTime]);\r\n}\r\n","import { playerStats } from \"../Player/playerStats\";\r\nimport React from \"react\";\r\nimport PlayerContext from \"../Player/PlayerContext\";\r\nimport { GameTimer } from \"GameEngine/GameRuntime\";\r\nimport { playerSkills } from \"GameEngine/Player/playerSkills\";\r\nimport SettingsContext from \"GameEngine/SettingsContext/SettingContext\";\r\nimport {\r\n  totalExp,\r\n  levelExp,\r\n} from \"GameConstants/Cultivation/CultivationManuals\";\r\n\r\n// Updates cultivation manuals learning progress\r\nexport default function useCultivationManager(timer: GameTimer) {\r\n  const player = React.useContext(PlayerContext);\r\n  const { gameSpeed } = React.useContext(SettingsContext);\r\n  let { stats, state, skills, updateContext } = player;\r\n  const { currentTime, previousTime } = timer;\r\n  React.useEffect(() => {\r\n    if (state.action !== \"cultivating\" || !state.manual) return;\r\n    // Update age\r\n    const elapsedTime = (timer.currentTime - timer.previousTime) * gameSpeed;\r\n    // calculate exp gain\r\n    const { learningProgress, manual } = state.manual;\r\n    const { level, exp } = learningProgress;\r\n    const expGain = (stats.insight * elapsedTime) / 1000;\r\n    const maxExp = totalExp(manual.maxLevel);\r\n    const newExp = Math.min(exp + expGain, maxExp);\r\n\r\n    const overflowExp = newExp - totalExp(level);\r\n    const newLevel =\r\n      overflowExp >=\r\n      levelExp(learningProgress.level + 1, manual.realm, manual.rarity)\r\n        ? level + 1\r\n        : level;\r\n    // update manual progress\r\n    state.manual.learningProgress.exp = newExp;\r\n    // update player stats on reaching new level\r\n    if (newLevel !== level) {\r\n      state.manual.learningProgress.level = newLevel;\r\n      if (manual.stats) stats = playerStats(player);\r\n      if (manual.skills) skills = playerSkills(player);\r\n    }\r\n    if (newExp >= maxExp) state = { action: \"idle\", manual: undefined }; // return to idle state if the manual is finished\r\n    updateContext({ state, stats, skills });\r\n  }, [currentTime]);\r\n}\r\n","import { playerStats } from \"../Player/playerStats\";\r\nimport React from \"react\";\r\nimport PlayerContext from \"../Player/PlayerContext\";\r\nimport { GameTimer } from \"GameEngine/GameRuntime\";\r\nimport GameContext from \"GameEngine/GameContext/GameContext\";\r\nimport calculateRealmPower from \"GameEngine/shared/calculateRealmPower\";\r\nimport calculateTribulationPower from \"GameEngine/shared/calculateTribulationPower\";\r\nimport SettingsContext from \"GameEngine/SettingsContext/SettingContext\";\r\nimport {\r\n  BreakthroughDps,\r\n  TribulationDps,\r\n} from \"GameConstants/Cultivation/CultivationRealms\";\r\n\r\n// Manages realm breakthroughs\r\nexport default function useBreakthroughManager(timer: GameTimer) {\r\n  const player = React.useContext(PlayerContext);\r\n  const { gameSpeed } = React.useContext(SettingsContext);\r\n  const { cultivationRealms, updateContext: updateGameContext } =\r\n    React.useContext(GameContext);\r\n  let { stats, state, realm, updateContext, currentStats } = player;\r\n  const { currentTime, previousTime } = timer;\r\n  React.useEffect(() => {\r\n    if (state.action !== \"breakthrough\" || !state.realm) return;\r\n    const elapsedTime = (timer.currentTime - timer.previousTime) * gameSpeed;\r\n    // Calculate damage dealt by both parties\r\n    const breakthrough = cultivationRealms[state.realm.index];\r\n\r\n    if (!breakthrough || !breakthrough.currentStats) return;\r\n\r\n    const playerDps = BreakthroughDps(\r\n      player,\r\n      breakthrough.currentStats || breakthrough.baseStats\r\n    );\r\n    const realmDps = TribulationDps(\r\n      breakthrough.currentStats || breakthrough.baseStats,\r\n      player\r\n    );\r\n    const playerDamage = (playerDps * elapsedTime) / 1000;\r\n    const realmDamage = (realmDps * elapsedTime) / 1000;\r\n\r\n    const newRealmHealth = Math.min(\r\n      breakthrough.currentStats.currentHealth - playerDamage,\r\n      breakthrough.currentStats.health\r\n    );\r\n    const newPlayerHealth = Math.min(\r\n      currentStats.health - realmDamage,\r\n      stats.health\r\n    );\r\n\r\n    // Victory condition\r\n    if (newRealmHealth <= 0) {\r\n      // Check if the tribulation has layers\r\n      if (breakthrough.tribulation) {\r\n        const stepReached = breakthrough.tribulation.stepReached;\r\n        if (!stepReached || breakthrough.tribulation.steps > stepReached) {\r\n          // Proceed to the next step\r\n\r\n          const newStep = stepReached !== undefined ? stepReached + 1 : 1;\r\n          breakthrough.tribulation.stepReached = newStep;\r\n          const { health, healthRegen, attack, defence } =\r\n            calculateTribulationPower(state.realm.index, cultivationRealms);\r\n\r\n          breakthrough.currentStats.health = health;\r\n          breakthrough.currentStats.healthRegen = healthRegen;\r\n          breakthrough.currentStats.attack = attack;\r\n          breakthrough.currentStats.defence = defence;\r\n          breakthrough.currentStats.currentHealth = health;\r\n          updateGameContext({ cultivationRealms: cultivationRealms.slice() });\r\n          return;\r\n        } else {\r\n          // All steps finished update player realm and game context\r\n          realm.index = state.realm.index;\r\n          if (breakthrough.tribulation)\r\n            breakthrough.tribulation.stepReached =\r\n              breakthrough.tribulation.steps;\r\n          realm.power = calculateRealmPower(realm.index, cultivationRealms);\r\n          state = { action: \"idle\", realm: undefined };\r\n          breakthrough.currentStats = undefined;\r\n          // Update player stats\r\n          stats = playerStats(player);\r\n          updateContext({ stats, currentStats, state, realm });\r\n          updateGameContext({ cultivationRealms: cultivationRealms.slice() });\r\n          alert(\"Breakthrough success!\");\r\n          return;\r\n        }\r\n      }\r\n      // Update player realm\r\n      realm.index = state.realm.index;\r\n      state = { action: \"idle\", realm: undefined };\r\n      // Update player stats\r\n      realm.power = calculateRealmPower(realm.index, cultivationRealms);\r\n      stats = playerStats(player);\r\n      breakthrough.currentStats = undefined;\r\n      updateContext({ stats, currentStats, state, realm });\r\n      updateGameContext({ cultivationRealms: cultivationRealms.slice() });\r\n      alert(\"Breakthrough success!\");\r\n    }\r\n\r\n    // Loss condition\r\n    else if (newPlayerHealth <= 0) {\r\n      if (breakthrough.tribulation) {\r\n        const stepReached = breakthrough.tribulation.stepReached;\r\n        if (!stepReached) {\r\n          state = { action: \"idle\", realm: undefined };\r\n          updateContext({ state });\r\n          // The breakthrough was successful, albeit not stages were finished\r\n        } else {\r\n          realm.index = state.realm.index;\r\n          realm.power = calculateRealmPower(realm.index, cultivationRealms);\r\n          state = { action: \"idle\", realm: undefined };\r\n          // Update player stats\r\n          stats = playerStats(player);\r\n          breakthrough.currentStats = undefined;\r\n          (breakthrough.tribulation as any).stepReached -= 1;\r\n          updateContext({ stats, currentStats, state, realm });\r\n\r\n          updateGameContext({ cultivationRealms: cultivationRealms.slice() });\r\n          alert(\"Breakthrough success!\");\r\n          return;\r\n        }\r\n      }\r\n      state = { action: \"idle\", realm: undefined };\r\n      breakthrough.currentStats = undefined;\r\n      alert(\"Breakthrough failed, you are not strong enough yet\");\r\n    }\r\n    // Update Hp values for both parties\r\n    else {\r\n      currentStats.health = newPlayerHealth;\r\n      breakthrough.currentStats.currentHealth = newRealmHealth;\r\n      updateContext({ currentStats, state, realm });\r\n      updateGameContext({ cultivationRealms });\r\n    }\r\n  }, [currentTime]);\r\n}\r\n","import React from \"react\";\r\n\r\n// Simple wrapper\r\nexport function getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height,\r\n  };\r\n}\r\n\r\n// Re-renders page on screen size change\r\nexport default function useWindowDimensions() {\r\n  const [windowDimensions, setWindowDimensions] = React.useState(\r\n    getWindowDimensions()\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    function handleResize() {\r\n      setWindowDimensions(getWindowDimensions());\r\n    }\r\n\r\n    window.addEventListener(\"resize\", handleResize);\r\n    return () => window.removeEventListener(\"resize\", handleResize);\r\n  }, []);\r\n\r\n  return windowDimensions;\r\n}\r\n","// Transforms variable names to text displayed on screen\r\n// Pretty useless thing actually and should be moved to the frontend implementation\r\nconst PlayerStatsDictionary = {\r\n  age: \"Age\",\r\n  health: \"Hp\",\r\n  healthRegen: \"Hp.regen\",\r\n  attack: \"Atk\",\r\n  defence: \"Def\",\r\n  training: \"training\",\r\n  mining: \"mining\",\r\n  crafting: \"crafting\",\r\n};\r\n\r\nexport function getStatName(name: string) {\r\n  return PlayerStatsDictionary[name] || name;\r\n}\r\n\r\nexport default PlayerStatsDictionary;\r\n","import { PlayerContextType } from \"GameConstants/Interfaces\";\r\nimport { PlayerCurrentStats } from \"GameConstants/Player\";\r\nimport { playerStats } from \"./playerStats\";\r\n\r\n// Prevents overflow on player stats change for all of the currentStats\r\nexport function playerCurrentStats(\r\n  player: PlayerContextType\r\n): PlayerCurrentStats {\r\n  let currentStats = { ...player.currentStats };\r\n  let stats = playerStats(player);\r\n  for (const [key] of Object.entries(player.baseStats)) {\r\n    currentStats[key] = Math.min(currentStats[key], stats[key]);\r\n  }\r\n\r\n  return currentStats;\r\n}\r\n","import { Box, Paper, Typography, useTheme } from \"@mui/material\";\r\n\r\nimport SettingsOutlinedIcon from \"@mui/icons-material/SettingsOutlined\";\r\nimport React from \"react\";\r\nimport { getWindowDimensions } from \"Utils/useWindowDimensions\";\r\nimport { PlayerContext, GameContext, SettingsContext } from \"GameEngine\";\r\nimport { year, month } from \"GameConstants/Constants\";\r\n\r\ntype Props = {\r\n  setSettings: React.Dispatch<React.SetStateAction<boolean>>;\r\n};\r\n\r\n// Top bar with some game stats and values\r\nexport default function TopBar(props: Props) {\r\n  const theme = useTheme();\r\n  const { stats, realm, state } = React.useContext(PlayerContext);\r\n  const { cultivationRealms } = React.useContext(GameContext);\r\n  const { gameSpeed } = React.useContext(SettingsContext);\r\n\r\n  const { width } = getWindowDimensions();\r\n\r\n  let playerAction = state.action;\r\n  if (state.action === \"activity\")\r\n    playerAction += \" (\" + state.activity?.name + \")\";\r\n  if (state.action === \"cultivating\")\r\n    playerAction += \" (\" + state.manual?.manual.name + \")\";\r\n  if (state.action === \"fighting\")\r\n    playerAction += \" (\" + state.enemy?.name + \")\";\r\n  return (\r\n    <>\r\n      <Paper elevation={8}>\r\n        <Box\r\n          height={theme.spacing(8)}\r\n          width={width}\r\n          display=\"flex\"\r\n          alignItems={\"center\"}\r\n          gap={2}\r\n          paddingX={2}\r\n        >\r\n          <Box>\r\n            <Typography variant=\"h5\">Age: {parseAge(stats.age)}</Typography>\r\n            <Typography variant=\"h5\">\r\n              Realm: {cultivationRealms[realm.index].name}\r\n            </Typography>\r\n          </Box>\r\n\r\n          <Box marginLeft=\"auto\" display=\"flex\" alignItems={\"center\"} gap={1}>\r\n            <Box display=\"flex\" flexDirection={\"column\"}>\r\n              <Typography>Game Speed: x{gameSpeed}</Typography>\r\n              <Typography>{playerAction}</Typography>\r\n            </Box>\r\n\r\n            <SettingsOutlinedIcon\r\n              fontSize=\"large\"\r\n              onClick={() => props.setSettings((settings) => !settings)}\r\n            />\r\n          </Box>\r\n        </Box>\r\n      </Paper>\r\n    </>\r\n  );\r\n}\r\nfunction parseAge(time: number): string {\r\n  const years = Math.floor(time / year);\r\n  // Just in case to not overflow 12 due to rounding\r\n  const months = Math.min(Math.floor((time - years * year) / month), 12);\r\n  return `${years} years ${months} months`;\r\n}\r\n","import { defaultAutosaveInterval } from \"GameConstants/Constants\";\r\nimport React from \"react\";\r\nimport GameContext, {\r\n  GameContextType,\r\n  gameContext,\r\n} from \"./GameContext/GameContext\";\r\n\r\n// Wrapper for loading player save data\r\nexport default function WorldLoader(props: any) {\r\n  const [data, setData] = React.useState(gameContext);\r\n\r\n  const updateContext = (newData: Partial<GameContextType>) =>\r\n    setData((data) => ({ ...data, ...newData }));\r\n  // Load save data from Local Storage\r\n  const [loaded, setLoaded] = React.useState<boolean>(false);\r\n  React.useEffect(() => {\r\n    const gameData = localStorage.getItem(\"game\");\r\n    if (gameData) {\r\n      let storageData = JSON.parse(gameData);\r\n      setData(storageData);\r\n    }\r\n\r\n    setLoaded(true);\r\n  }, []);\r\n  // Autosave\r\n  React.useEffect(() => {\r\n    const autosaveInterval = setInterval(() => {\r\n      // Thats a hacky way to access current state value inside useEffect run only once\r\n      setData((data) => {\r\n        localStorage.setItem(\"game\", JSON.stringify(data));\r\n        return data;\r\n      });\r\n    }, defaultAutosaveInterval);\r\n    return () => {\r\n      clearInterval(autosaveInterval);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <GameContext.Provider\r\n      value={{ ...data, updateContext, setContext: setData }}\r\n    >\r\n      {loaded && props.children}\r\n    </GameContext.Provider>\r\n  );\r\n}\r\n","import {\r\n  LinearProgressProps,\r\n  Box,\r\n  Typography,\r\n  LinearProgress,\r\n} from \"@mui/material\";\r\n\r\nexport default function HealthBar(\r\n  props: LinearProgressProps & { label: string; value: number }\r\n) {\r\n  return (\r\n    <Box sx={{ display: \"flex\", alignItems: \"center\" }}>\r\n      <Box sx={{ minWidth: 200 }}>\r\n        <Typography variant=\"body1\" color=\"text.primary\">\r\n          {props.label}\r\n        </Typography>\r\n      </Box>\r\n      <Box sx={{ width: \"50%\", m: 1 }}>\r\n        <LinearProgress variant=\"determinate\" color=\"success\" {...props} />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { styled, Tooltip, tooltipClasses, TooltipProps } from \"@mui/material\";\r\n\r\nconst HtmlTooltip = styled(({ className, ...props }: TooltipProps) => (\r\n  <Tooltip {...props} classes={{ popper: className }} />\r\n))(({ theme }) => ({\r\n  [`& .${tooltipClasses.tooltip}`]: {\r\n    backgroundColor: \"#f5f5f9\",\r\n    color: \"rgba(0, 0, 0, 0.87)\",\r\n    maxWidth: 220,\r\n    fontSize: theme.typography.pxToRem(12),\r\n    border: \"1px solid #dadde9\",\r\n  },\r\n}));\r\n\r\nexport default HtmlTooltip;\r\n","import { TooltipProps, Typography, useTheme } from \"@mui/material\";\r\nimport HtmlTooltip from \"Components/shared/HtmlTooltip\";\r\nimport { PlayerContext, getStatStructure, useNumberParser } from \"GameEngine\";\r\n\r\nimport React from \"react\";\r\n\r\nexport default function StatDetailsTooltip(\r\n  props: Omit<TooltipProps, \"title\"> & { stat: string }\r\n) {\r\n  const player = React.useContext(PlayerContext);\r\n  const statStructure = getStatStructure(props.stat, player);\r\n  const parse = useNumberParser();\r\n  const theme = useTheme();\r\n\r\n  return (\r\n    <HtmlTooltip\r\n      title={\r\n        <>\r\n          <Typography color=\"inherit\">Character {props.stat}</Typography>\r\n          <Typography>\r\n            Base {props.stat}: {parse(statStructure.base)}\r\n          </Typography>\r\n          <Typography>\r\n            Realm bonus:\r\n            <Typography\r\n              component=\"span\"\r\n              color={\r\n                statStructure.realm >= 1\r\n                  ? theme.palette.success.main\r\n                  : theme.palette.error.main\r\n              }\r\n              display=\"inline\"\r\n            >\r\n              {\" \"}\r\n              x{parse(statStructure.realm)}\r\n            </Typography>\r\n          </Typography>\r\n          <Typography>\r\n            Manuals bonus:\r\n            <Typography\r\n              component=\"span\"\r\n              color={\r\n                statStructure.manuals >= 1\r\n                  ? theme.palette.success.main\r\n                  : theme.palette.error.main\r\n              }\r\n              display=\"inline\"\r\n            >\r\n              {\" \"}\r\n              x{parse(statStructure.manuals)}\r\n            </Typography>\r\n          </Typography>\r\n          <Typography>\r\n            Treasures multi:\r\n            <Typography\r\n              component=\"span\"\r\n              color={\r\n                statStructure.treasuresMulti >= 1\r\n                  ? theme.palette.success.main\r\n                  : theme.palette.error.main\r\n              }\r\n              display=\"inline\"\r\n            >\r\n              {\" \"}\r\n              x{parse(statStructure.treasuresMulti)}\r\n            </Typography>\r\n          </Typography>\r\n          <Typography>\r\n            Treasures bonus:\r\n            <Typography\r\n              component=\"span\"\r\n              color={\r\n                statStructure.treasures >= 0\r\n                  ? theme.palette.success.main\r\n                  : theme.palette.error.main\r\n              }\r\n              display=\"inline\"\r\n            >\r\n              {\" \"}\r\n              +{parse(statStructure.treasures)}\r\n            </Typography>\r\n          </Typography>\r\n        </>\r\n      }\r\n    >\r\n      {props.children}\r\n    </HtmlTooltip>\r\n  );\r\n}\r\n","import { Box, Typography, useTheme } from \"@mui/material\";\r\nimport React from \"react\";\r\nimport HealthBar from \"./PlayerStatsPane/HealthBar\";\r\nimport StatDetailsTooltip from \"./PlayerStatsPane/StatDetailsTooltip\";\r\nimport { PlayerContext, useNumberParser } from \"GameEngine\";\r\n\r\ntype Props = { displayStats: { name: string; stat: string }[] };\r\n\r\n// Displays current player stats\r\nexport default function PlayerStatsPane(props: Props) {\r\n  const player = React.useContext(PlayerContext);\r\n  const parse = useNumberParser();\r\n  const { stats, currentStats } = player;\r\n  const { health } = stats;\r\n  const currentHealth = currentStats.health;\r\n  const theme = useTheme();\r\n\r\n  return (\r\n    <Box\r\n      width={512}\r\n      paddingTop={theme.spacing(1)}\r\n      paddingLeft={theme.spacing(1)}\r\n    >\r\n      <StatDetailsTooltip stat=\"health\">\r\n        <Box>\r\n          <HealthBar\r\n            label={`Health: ${parse(currentHealth)} / ${parse(health)}`}\r\n            value={(currentHealth / health) * 100}\r\n          />\r\n        </Box>\r\n      </StatDetailsTooltip>\r\n      {props.displayStats.map((item) => (\r\n        <StatDetailsTooltip stat={item.stat} key={item.stat}>\r\n          <Typography>\r\n            {item.name} {parse(player.stats[item.stat])}\r\n          </Typography>\r\n        </StatDetailsTooltip>\r\n      ))}\r\n    </Box>\r\n  );\r\n}\r\n","import { Activity } from \"./Activities/Activities\";\r\n\r\n// ! Travelling mechanic is not implemented yet\r\n// This is a total placeholder\r\nconst Villages: Village[] = [\r\n  {\r\n    name: \"Spring blossom village\",\r\n    description:\r\n      \"A tiny village in the fields. The villagers are poor, but kind and hardworking\",\r\n    imagePath: \"village.png\",\r\n    activities: [\r\n      {\r\n        name: \"Run Errands\",\r\n        description: \"\",\r\n        baseTime: 0.1,\r\n        result: { items: [{ type: \"money\", name: \"Copper Coin\", amount: 1 }] },\r\n      },\r\n      {\r\n        name: \"Use Training Grounds\",\r\n        description: \"\",\r\n        baseTime: 0.1,\r\n        result: { baseStats: { attack: 0.07, defence: 0.07 } },\r\n      },\r\n      {\r\n        name: \"Help in the fields\",\r\n        description: \"\",\r\n        baseTime: 10,\r\n        result: {\r\n          baseStats: { attack: 0.2, defence: 0.2 },\r\n          items: [{ type: \"money\", name: \"Copper Coin\", amount: 5 }],\r\n        },\r\n      },\r\n      {\r\n        name: \"Help in the forge\",\r\n        description: \"\",\r\n        baseTime: 10,\r\n        result: {\r\n          baseStats: { attack: 0.2, defence: 0.2 },\r\n          items: [\r\n            { type: \"treasure\", name: \"Rusty Sword\", amount: 1 },\r\n            { type: \"treasure\", name: \"Rusty Armor\", amount: 1 },\r\n            { type: \"treasure\", name: \"Rusty Helmet\", amount: 1 },\r\n            { type: \"treasure\", name: \"Copper Ring\", amount: 1 },\r\n            { type: \"treasure\", name: \"Copper Pendant\", amount: 1 },\r\n          ],\r\n        },\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\ntype Village = {\r\n  name: string;\r\n  description: string;\r\n  imagePath: string;\r\n  activities?: Array<Activity>;\r\n};\r\n\r\nexport default Villages;\r\n","// Added due to mui behavior change on v5\r\n// The spacing return value was changed from number to string with 'px' at the end\r\nexport default function getSpacing(theme, value) {\r\n  return Number(theme.spacing(value).slice(0, -2));\r\n}\r\n","import { Box, Typography, useTheme } from \"@mui/material\";\r\nimport Villages from \"GameConstants/Villages\";\r\nimport getSpacing from \"Utils/getSpacing\";\r\n\r\n// Just a placeholder for now\r\nexport default function PlayerLocationPane() {\r\n  const theme = useTheme();\r\n  const location = Villages[0];\r\n  const src = \"./locations/\" + location.imagePath;\r\n  return (\r\n    <Box height={theme.spacing(16)} padding={theme.spacing(1)} width={512}>\r\n      <Typography variant=\"h5\">Current Location</Typography>\r\n      <Box display=\"flex\">\r\n        <img\r\n          src={src}\r\n          alt=\"\"\r\n          height={theme.spacing(12)}\r\n          width={theme.spacing(12)}\r\n        ></img>\r\n        <Box width={512 - getSpacing(theme, 12)} paddingLeft={theme.spacing(1)}>\r\n          <Typography variant=\"h6\">{location.name}</Typography>\r\n          <Typography variant=\"body1\">{location.description}</Typography>\r\n        </Box>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box } from \"@mui/material\";\r\n\r\ntype CropImageProps = {\r\n  path: string;\r\n  box: { x: number; y: number };\r\n  position: { x: number; y: number };\r\n};\r\nexport function CropImage(props: CropImageProps) {\r\n  const { path, box, position } = props;\r\n  return (\r\n    <Box width={box.x} height={box.y} overflow=\"hidden\">\r\n      <img\r\n        src={path}\r\n        alt=\"copper coin\"\r\n        style={{ top: -position.y, left: -position.x, position: \"relative\" }}\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n\r\ntype CropSquareImageProps = {\r\n  path: string;\r\n  size: number;\r\n  position: { x: number; y: number };\r\n};\r\n\r\nexport default function CropSquareImage(props: CropSquareImageProps) {\r\n  const { size, path, position } = props;\r\n  return (\r\n    <CropImage path={path} box={{ x: size, y: size }} position={position} />\r\n  );\r\n}\r\n","import { Box, Button, Typography, useTheme } from \"@mui/material\";\r\nimport CropSquareImage from \"Components/shared/CropImage\";\r\n\r\nimport React from \"react\";\r\nimport getSpacing from \"Utils/getSpacing\";\r\nimport {\r\n  useNumberParser,\r\n  getStatName,\r\n  playerStats,\r\n  playerSkills,\r\n  PlayerContext,\r\n} from \"GameEngine\";\r\nimport { CultivationRealms } from \"GameConstants/Cultivation/CultivationRealms\";\r\nimport {\r\n  InventoryTreasure,\r\n  isInventoryTreasure,\r\n} from \"GameConstants/Interfaces\";\r\nimport { TreasureType } from \"GameConstants/Items\";\r\nimport { currentStats } from \"GameConstants/Player\";\r\nimport { playerCurrentStats } from \"GameEngine/Player/playerCurrentStats\";\r\n\r\ntype Props = {\r\n  treasure: InventoryTreasure | undefined;\r\n  type: TreasureType;\r\n};\r\n\r\n// Player equipment card with its functionality\r\nexport default function EquipmentCard(props: Props) {\r\n  const { treasure, type } = props;\r\n  const theme = useTheme();\r\n  const player = React.useContext(PlayerContext);\r\n  const parse = useNumberParser();\r\n  let { inventory, stats, currentStats, skills, updateContext } = player;\r\n  if (!treasure)\r\n    return (\r\n      <Box width={512} border=\"1px solid gray\" borderRadius={theme.spacing(1)}>\r\n        <Box display=\"flex\" margin={theme.spacing(1)}>\r\n          <Box width={32} height={32} bgcolor=\"lightgray\"></Box>\r\n          <Box marginLeft={theme.spacing(1)} marginTop={theme.spacing(-1)}>\r\n            <Typography>Nothing ({type})</Typography>\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n    );\r\n  const { image, name, realmIndex, stats: itemStats } = treasure.item;\r\n  const { path, sizeX: size, x, y } = image;\r\n  const realm = CultivationRealms[realmIndex];\r\n\r\n  // Prepare treausre description\r\n  const TreasureDescription: TreasureDescriptionStatsLine[] = [];\r\n  if (itemStats.stats) {\r\n    for (const [key, value] of Object.entries(itemStats.stats)) {\r\n      TreasureDescription.push({\r\n        text: getStatName(key),\r\n        effect: parse(value),\r\n      });\r\n    }\r\n  }\r\n  if (itemStats.skills) {\r\n    for (const [key, value] of Object.entries(itemStats.skills)) {\r\n      TreasureDescription.push({\r\n        text: getStatName(key),\r\n        effect: parse(value),\r\n      });\r\n    }\r\n  }\r\n  if (itemStats.statsMulti) {\r\n    for (const [key, value] of Object.entries(itemStats.statsMulti)) {\r\n      TreasureDescription.push({\r\n        text: getStatName(key),\r\n        effect: parse(value * 100) + \"%\",\r\n      });\r\n    }\r\n  }\r\n  if (itemStats.skillsMulti) {\r\n    for (const [key, value] of Object.entries(itemStats.skillsMulti)) {\r\n      TreasureDescription.push({\r\n        text: getStatName(key),\r\n        effect: parse(value * 100) + \"%\",\r\n      });\r\n    }\r\n  }\r\n\r\n  const unequipItem = (id: string) => {\r\n    const index = inventory.findIndex((item) => item.id === id);\r\n    if (index === -1) return;\r\n    const treasure = inventory[index];\r\n    if (!isInventoryTreasure(treasure)) return;\r\n    (inventory[index] as InventoryTreasure).isEquipped = false;\r\n\r\n    stats = playerStats(player);\r\n    currentStats = playerCurrentStats(player);\r\n    skills = playerSkills(player);\r\n    updateContext({ inventory, stats, currentStats, skills });\r\n  };\r\n  return (\r\n    <Box width={512} border=\"1px solid gray\" borderRadius={theme.spacing(1)}>\r\n      <Box margin={theme.spacing(1)}>\r\n        <Box width={512} display=\"flex\">\r\n          <CropSquareImage path={path} size={size} position={{ x: x, y: y }} />\r\n          <Box marginLeft={theme.spacing(1)} marginTop={theme.spacing(-1)}>\r\n            <Typography>\r\n              {name} ({type})\r\n            </Typography>\r\n            <Typography>{realm.name}</Typography>\r\n          </Box>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"warning\"\r\n            size=\"small\"\r\n            sx={{ maxHeight: 32, minHeight: 32, margin: \"auto\" }}\r\n            onClick={() => unequipItem(treasure.id)}\r\n          >\r\n            Unequip\r\n          </Button>\r\n        </Box>\r\n        {TreasureDescription.map((item, index) => (\r\n          <Typography\r\n            key={index}\r\n            variant=\"body1\"\r\n            marginLeft={`${32 + getSpacing(theme, 1)}px`}\r\n          >\r\n            {item.text} {item.effect}\r\n          </Typography>\r\n        ))}\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\ntype TreasureDescriptionStatsLine = {\r\n  text: string;\r\n  effect: string;\r\n};\r\n","import { Box } from \"@mui/material\";\r\nimport React from \"react\";\r\nimport EquipmentCard from \"./Equipment/EquipmentCard\";\r\n\r\nimport { PlayerContext } from \"GameEngine\";\r\nimport {\r\n  isInventoryTreasure,\r\n  InventoryTreasure,\r\n} from \"GameConstants/Interfaces\";\r\nimport { PlayerEquipment } from \"GameConstants/Player\";\r\n\r\n// Player equipment\r\nexport default function Equipment() {\r\n  const { inventory } = React.useContext(PlayerContext);\r\n  const equippedItems = inventory.filter(\r\n    (item) => isInventoryTreasure(item) && item.isEquipped\r\n  );\r\n  const EquipCards: Array<JSX.Element> = [];\r\n  for (let itemType of PlayerEquipment) {\r\n    const treasure = (equippedItems as InventoryTreasure[]).find(\r\n      (item) => item.item.type === itemType\r\n    );\r\n    EquipCards.push(\r\n      <EquipmentCard treasure={treasure} type={itemType} key={itemType} />\r\n    );\r\n  }\r\n  return <Box>{EquipCards}</Box>;\r\n}\r\n","import { Box, Button } from \"@mui/material\";\r\nimport KeyboardArrowLeftIcon from \"@mui/icons-material/KeyboardArrowLeft\";\r\nimport KeyboardDoubleArrowLeftIcon from \"@mui/icons-material/KeyboardDoubleArrowLeft\";\r\nimport KeyboardArrowRightIcon from \"@mui/icons-material/KeyboardArrowRight\";\r\nimport KeyboardDoubleArrowRightIcon from \"@mui/icons-material/KeyboardDoubleArrowRight\";\r\nimport { InventoryPages } from \"../Inventory\";\r\n\r\ntype Props = {\r\n  pages: InventoryPages;\r\n  setPages: React.Dispatch<React.SetStateAction<InventoryPages>>;\r\n};\r\n\r\n// A panel below the inventory, that allows switching inventory pages\r\nexport default function InventoryBottomPanel(props: Props) {\r\n  const { pages, setPages } = props;\r\n  return (\r\n    <Box width={512} height={24}>\r\n      <Button\r\n        onClick={() =>\r\n          setPages((pages) => ({ current: 1, total: pages.total }))\r\n        }\r\n        disabled={pages.current === 1}\r\n        sx={{ maxWidth: 24, minWidth: 24 }}\r\n      >\r\n        <KeyboardDoubleArrowLeftIcon />\r\n      </Button>\r\n      <Button\r\n        onClick={() =>\r\n          setPages((pages) => ({\r\n            current: pages.current - 1,\r\n            total: pages.total,\r\n          }))\r\n        }\r\n        disabled={pages.current === 1}\r\n        sx={{ maxWidth: 24, minWidth: 24 }}\r\n      >\r\n        <KeyboardArrowLeftIcon />\r\n      </Button>\r\n      <Button\r\n        onClick={() =>\r\n          setPages((pages) => ({\r\n            current: pages.current + 1,\r\n            total: pages.total,\r\n          }))\r\n        }\r\n        disabled={pages.current === pages.total}\r\n        sx={{ maxWidth: 24, minWidth: 24 }}\r\n      >\r\n        <KeyboardArrowRightIcon />\r\n      </Button>\r\n      <Button\r\n        onClick={() =>\r\n          setPages((pages) => ({ current: pages.total, total: pages.total }))\r\n        }\r\n        disabled={pages.current === pages.total}\r\n        sx={{ maxWidth: 24, minWidth: 24 }}\r\n      >\r\n        <KeyboardDoubleArrowRightIcon />\r\n      </Button>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Button } from \"@mui/material\";\r\nimport { InventoryFilters } from \"../Inventory\";\r\n\r\ntype Props = {\r\n  type: InventoryFilters;\r\n  setType: React.Dispatch<React.SetStateAction<InventoryFilters>>;\r\n};\r\n\r\n// Filter panel to the right of the inventory grid\r\nexport default function InventoryFiltersPane(props: Props) {\r\n  const { type, setType } = props;\r\n  return (\r\n    <Box width={128} height={512 - 128}>\r\n      <Button\r\n        variant=\"outlined\"\r\n        onClick={() => setType(\"all\")}\r\n        color={type === \"all\" ? \"success\" : \"primary\"}\r\n        fullWidth\r\n      >\r\n        all\r\n      </Button>\r\n      <Button\r\n        variant=\"outlined\"\r\n        onClick={() => setType(\"money\")}\r\n        color={type === \"money\" ? \"success\" : \"primary\"}\r\n        fullWidth\r\n      >\r\n        money\r\n      </Button>\r\n      <Button\r\n        variant=\"outlined\"\r\n        onClick={() => setType(\"treasure\")}\r\n        color={type === \"treasure\" ? \"success\" : \"primary\"}\r\n        fullWidth\r\n      >\r\n        treasures\r\n      </Button>\r\n      <Button\r\n        variant=\"outlined\"\r\n        onClick={() => setType(\"mineral\")}\r\n        color={type === \"mineral\" ? \"success\" : \"primary\"}\r\n        fullWidth\r\n      >\r\n        minerals\r\n      </Button>\r\n      <Button\r\n        variant=\"outlined\"\r\n        onClick={() => setType(\"herb\")}\r\n        color={type === \"herb\" ? \"success\" : \"primary\"}\r\n        fullWidth\r\n      >\r\n        Herbs\r\n      </Button>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box } from \"@mui/material\";\r\n\r\n// Just a placeholder white square for grids\r\nexport default function EmptyCell() {\r\n  return <Box width={64} height={64} border=\"1px solid gray\" />;\r\n}\r\n","import { Box } from \"@mui/material\";\r\nimport LockOutlinedIcon from \"@mui/icons-material/LockOutlined\";\r\nimport LockOpenOutlinedIcon from \"@mui/icons-material/LockOpenOutlined\";\r\n\r\nexport default function LockIcon(props: {\r\n  isLocked: boolean;\r\n  fontSize?: \"small\" | \"inherit\" | \"medium\" | \"large\";\r\n}) {\r\n  const { isLocked, fontSize } = props;\r\n  return (\r\n    <Box>\r\n      {isLocked ? (\r\n        <LockOutlinedIcon fontSize={fontSize || \"medium\"} />\r\n      ) : (\r\n        <LockOpenOutlinedIcon fontSize={fontSize || \"medium\"} />\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  Button,\r\n  ClickAwayListener,\r\n  Popper,\r\n  Typography,\r\n} from \"@mui/material\";\r\nimport CropSquareImage from \"Components/shared/CropImage\";\r\n\r\nimport React from \"react\";\r\nimport EmptyCell from \"./EmptyCell\";\r\nimport {\r\n  useNumberParser,\r\n  PlayerContext,\r\n  playerStats,\r\n  playerSkills,\r\n  getStatName,\r\n} from \"GameEngine\";\r\nimport { CultivationRealms } from \"GameConstants/Cultivation/CultivationRealms\";\r\nimport {\r\n  InventoryTreasure,\r\n  InventoryUniqueItem,\r\n  isInventoryTreasure,\r\n} from \"GameConstants/Interfaces\";\r\nimport { TreasureType } from \"GameConstants/Items\";\r\nimport LockIcon from \"Components/shared/LockIcon\";\r\nimport { playerCurrentStats } from \"GameEngine/Player/playerCurrentStats\";\r\n\r\n// Draw inventory treasure item\r\nexport default function InventoryTreasureItem(props: InventoryTreasure) {\r\n  const { item: treasure, isLocked } = props;\r\n\r\n  const realmName = CultivationRealms[treasure.realmIndex].name;\r\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n  const parse = useNumberParser();\r\n  const player = React.useContext(PlayerContext);\r\n  let { inventory, stats, skills, currentStats, updateContext } = player;\r\n\r\n  const handleClick = (event: React.MouseEvent<HTMLElement>) => {\r\n    setAnchorEl(anchorEl ? null : event.currentTarget);\r\n  };\r\n\r\n  const handleClickAway = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const dropItem = (id: string) => {\r\n    const index = inventory.findIndex((item) => item.id === id);\r\n    if (index === -1 || (inventory[index] as any).isLocked) return;\r\n    inventory.splice(index, 1);\r\n    updateContext({ inventory });\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const equipItem = (id: string, type: TreasureType) => {\r\n    const index = inventory.findIndex((item) => item.id === id);\r\n    if (index === -1) return;\r\n    // Check equipped items\r\n    const equippedIndex = inventory.findIndex(\r\n      (item) =>\r\n        isInventoryTreasure(item) && item.isEquipped && item.item.type === type\r\n    );\r\n    // Unequip item of the same type\r\n    if (equippedIndex !== -1)\r\n      (inventory[equippedIndex] as InventoryTreasure).isEquipped = false;\r\n    (inventory[index] as InventoryTreasure).isEquipped = true;\r\n    stats = playerStats(player);\r\n    currentStats = playerCurrentStats(player);\r\n    skills = playerSkills(player);\r\n    updateContext({ inventory, stats, currentStats, skills });\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const toggleItemLock = (id: string) => {\r\n    const index = inventory.findIndex((item) => item.id === id);\r\n    if (index === -1) return;\r\n    (inventory[index] as InventoryUniqueItem).isLocked = !(\r\n      inventory[index] as InventoryUniqueItem\r\n    ).isLocked;\r\n    updateContext({ inventory: inventory.slice() });\r\n  };\r\n\r\n  const open = Boolean(anchorEl);\r\n  const id = open ? \"simple-popper\" : undefined;\r\n  if (!treasure) return <EmptyCell />;\r\n\r\n  const TreasureDescription: TreasureDescriptionStatsLine[] = [];\r\n  const { stats: itemStats } = treasure;\r\n  if (itemStats.stats) {\r\n    for (const [key, value] of Object.entries(itemStats.stats)) {\r\n      TreasureDescription.push({\r\n        text: getStatName(key),\r\n        effect: parse(value),\r\n      });\r\n    }\r\n  }\r\n  if (itemStats.skills) {\r\n    for (const [key, value] of Object.entries(itemStats.skills)) {\r\n      TreasureDescription.push({\r\n        text: getStatName(key),\r\n        effect: parse(value),\r\n      });\r\n    }\r\n  }\r\n  if (itemStats.statsMulti) {\r\n    for (const [key, value] of Object.entries(itemStats.statsMulti)) {\r\n      TreasureDescription.push({\r\n        text: getStatName(key),\r\n        effect: parse(value * 100) + \"%\",\r\n      });\r\n    }\r\n  }\r\n  if (itemStats.skillsMulti) {\r\n    for (const [key, value] of Object.entries(itemStats.skillsMulti)) {\r\n      TreasureDescription.push({\r\n        text: getStatName(key),\r\n        effect: parse(value * 100) + \"%\",\r\n      });\r\n    }\r\n  }\r\n\r\n  const trimmedRealmName =\r\n    realmName.substring(0, 6) + \" \" + realmName.charAt(realmName.length - 1);\r\n\r\n  return (\r\n    <ClickAwayListener onClickAway={handleClickAway}>\r\n      <Box>\r\n        <Box\r\n          width={64}\r\n          height={64}\r\n          border=\"1px solid gray\"\r\n          display=\"flex\"\r\n          flexDirection=\"column\"\r\n          sx={{ justifyContent: \"space-around\", alignItems: \"center\" }}\r\n          onClick={handleClick}\r\n        >\r\n          <Box>\r\n            <CropSquareImage\r\n              path={treasure.image.path}\r\n              size={treasure.image.sizeX}\r\n              position={{ x: treasure.image.x, y: treasure.image.y }}\r\n            />\r\n          </Box>\r\n          <Box>\r\n            <Typography variant=\"body2\">{trimmedRealmName}</Typography>\r\n          </Box>\r\n        </Box>\r\n        <Popper id={id} open={open} anchorEl={anchorEl}>\r\n          <Box sx={{ border: 1, p: 1, bgcolor: \"background.paper\" }}>\r\n            <Box display=\"flex\" justifyContent={\"space-between\"}>\r\n              <Typography>{treasure.name}</Typography>\r\n              <Box onClick={() => toggleItemLock(props.id)}>\r\n                <LockIcon isLocked={isLocked || false} />\r\n              </Box>\r\n            </Box>\r\n\r\n            <Typography>Quality: {parse(treasure.quality)}</Typography>\r\n            {TreasureDescription.map((item, index) => (\r\n              <Typography key={index} variant=\"body1\">\r\n                {item.text} {item.effect}\r\n              </Typography>\r\n            ))}\r\n            <Button\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              onClick={() => equipItem(props.id, props.item.type)}\r\n            >\r\n              Equip\r\n            </Button>\r\n            <Button\r\n              variant=\"contained\"\r\n              color=\"warning\"\r\n              onClick={() => dropItem(props.id)}\r\n            >\r\n              Drop\r\n            </Button>\r\n          </Box>\r\n        </Popper>\r\n      </Box>\r\n    </ClickAwayListener>\r\n  );\r\n}\r\n\r\ntype TreasureDescriptionStatsLine = {\r\n  text: string;\r\n  effect: string;\r\n};\r\n","import { Herbs } from \"GameConstants/Items/Herbs\";\r\nimport { ItemType } from \"GameConstants/Interfaces\";\r\nimport { Minerals } from \"GameConstants/Items/Minerals\";\r\nimport Money from \"GameConstants/Items/Money\";\r\nimport Treasures from \"GameConstants/Items/Treasures\";\r\n\r\nexport default function findItemDescription(name: string, type: ItemType) {\r\n  let description;\r\n  if (type === \"treasure\")\r\n    description = Treasures.find((item) => item.name === name);\r\n  if (type === \"money\") description = Money.find((item) => item.name === name);\r\n  if (type === \"mineral\")\r\n    description = Minerals.find((item) => item.name === name);\r\n  if (type === \"herb\") description = Herbs.find((item) => item.name === name);\r\n  return description;\r\n}\r\n","import { Box, TooltipProps, Typography } from \"@mui/material\";\r\nimport CropSquareImage from \"Components/shared/CropImage\";\r\nimport HtmlTooltip from \"Components/shared/HtmlTooltip\";\r\nimport {\r\n  Material,\r\n  InventoryCountableItem as Type,\r\n} from \"GameConstants/Interfaces\";\r\nimport EmptyCell from \"./EmptyCell\";\r\nimport { useNumberParser } from \"GameEngine\";\r\nimport { MoneyType } from \"GameConstants/Items\";\r\nimport findItemDescription from \"GameConstants/utils/findItemDescription\";\r\n\r\n// Draw inventory money item\r\nexport default function InventoryCountableItem(props: Type) {\r\n  const { name, amount, type } = props;\r\n  const parse = useNumberParser();\r\n  // Find image\r\n  const cellData: MoneyType | Material | undefined = findItemDescription(\r\n    name,\r\n    type\r\n  );\r\n  if (!cellData) return <EmptyCell />;\r\n  return (\r\n    <CountableCellTooltip name={name} description={cellData.description}>\r\n      <Box\r\n        width={64}\r\n        height={64}\r\n        border=\"1px solid gray\"\r\n        display=\"flex\"\r\n        flexDirection=\"column\"\r\n        sx={{ justifyContent: \"space-around\", alignItems: \"center\" }}\r\n      >\r\n        <Box>\r\n          <CropSquareImage\r\n            path={cellData.image.path}\r\n            size={cellData.image.sizeX}\r\n            position={{ x: cellData.image.x, y: cellData.image.y }}\r\n          />\r\n        </Box>\r\n        <Box>\r\n          <Typography variant=\"body2\">{parse(amount)}</Typography>\r\n        </Box>\r\n      </Box>\r\n    </CountableCellTooltip>\r\n  );\r\n}\r\n\r\ntype CountableTooltipProps = Omit<TooltipProps, \"title\"> & {\r\n  name: string;\r\n  description: string;\r\n};\r\n\r\nfunction CountableCellTooltip(props: CountableTooltipProps) {\r\n  const { name, description } = props;\r\n  return (\r\n    <HtmlTooltip\r\n      title={\r\n        <>\r\n          <Typography color=\"inherit\">{name}</Typography>\r\n          <Typography variant=\"body2\">{description}</Typography>\r\n        </>\r\n      }\r\n    >\r\n      {props.children}\r\n    </HtmlTooltip>\r\n  );\r\n}\r\n","import EmptyCell from \"./EmptyCell\";\r\nimport InventoryTreasureItem from \"./InventoryTreasureItem\";\r\nimport InventoryCountableItem from \"./InventoryCountableItem\";\r\nimport { InventoryItem } from \"GameConstants/Interfaces\";\r\n\r\ntype GridItemProps = {\r\n  item: InventoryItem | undefined;\r\n};\r\n\r\n// Draw inventory tile based on item type\r\nexport default function InventoryGridItem(props: GridItemProps) {\r\n  const { item } = props;\r\n\r\n  if (!item) return <EmptyCell />;\r\n  else if (item.type === \"money\") return <InventoryCountableItem {...item} />;\r\n  else if (item.type === \"mineral\") return <InventoryCountableItem {...item} />;\r\n  else if (item.type === \"herb\") return <InventoryCountableItem {...item} />;\r\n  else if (item.type === \"treasure\") return <InventoryTreasureItem {...item} />;\r\n\r\n  return <EmptyCell />;\r\n}\r\n","import { Box } from \"@mui/material\";\r\n\r\nimport InventoryGridItem from \"./InventoryGrid/InventoryGridItem\";\r\nimport { InventoryItem } from \"GameConstants/Interfaces\";\r\n\r\n// Player inventory\r\nexport default function InventoryGrid(props: { inventory: InventoryItem[] }) {\r\n  const { inventory } = props;\r\n\r\n  const length =\r\n    inventory.length === 0 ? 36 : Math.ceil(inventory.length / 36) * 36;\r\n  const tileIndex = Array(length)\r\n    .fill(0)\r\n    .map((element, index) => index);\r\n\r\n  const Tiles = tileIndex.map((value) => ({\r\n    item: inventory[value] || undefined,\r\n    index: value,\r\n  }));\r\n\r\n  return (\r\n    <Box width={512 - 128} height={512 - 128} display=\"flex\" flexWrap=\"wrap\">\r\n      {Tiles.map((tile) => (\r\n        <InventoryGridItem key={tile.index} item={tile.item} />\r\n      ))}\r\n    </Box>\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  Checkbox,\r\n  FormControl,\r\n  FormControlLabel,\r\n  FormGroup,\r\n  InputLabel,\r\n  MenuItem,\r\n  Select,\r\n  SelectChangeEvent,\r\n  TextField,\r\n} from \"@mui/material\";\r\nimport {\r\n  CountableItems,\r\n  InventoryUniqueItem,\r\n  UniqueItems,\r\n} from \"GameConstants/Interfaces\";\r\nimport { PlayerContext } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\n// Options for the realm selection menu\r\nconst Realms: Realm[] = [\r\n  {\r\n    label: \"Mortal\",\r\n    index: 8,\r\n  },\r\n  {\r\n    label: \"Body Ref.\",\r\n    index: 17,\r\n  },\r\n  {\r\n    label: \"Qi Gath.\",\r\n    index: 26,\r\n  },\r\n];\r\n\r\n// Options for the type selector menu\r\nconst ItemTypes: Array<string> = UniqueItems.map((x) => x);\r\nItemTypes.unshift(\"all\");\r\n\r\nexport default function AutosellPanel() {\r\n  const { inventory, updateContext } = React.useContext(PlayerContext);\r\n  // Type field manager\r\n  const [type, setType] = React.useState<string>(ItemTypes[0]);\r\n  const typeSelectChange = (event: SelectChangeEvent) => {\r\n    setType(event.target.value);\r\n  };\r\n  // Realm field manager\r\n  const [realm, setRealm] = React.useState<Realm>(Realms[0]);\r\n  const realmSelectChange = (event: SelectChangeEvent) => {\r\n    const realm_index = parseInt(event.target.value);\r\n    const newRealm = Realms.find((item) => item.index === realm_index);\r\n    if (!newRealm) return;\r\n    setRealm(newRealm);\r\n  };\r\n\r\n  // Quality field manager\r\n  const [quality, setQuality] = React.useState<number>(1);\r\n  const qualityFieldChange = (event) => {\r\n    const q = parseInt(event.target.value);\r\n    if (isNaN(q)) return;\r\n    setQuality(q);\r\n  };\r\n  // Autosell checkbox manager\r\n  const [isActive, setActive] = React.useState<boolean>(false);\r\n\r\n  // Run Autosell\r\n  React.useEffect(() => {\r\n    const autosellInterval = setInterval(() => {\r\n      if (!isActive) return;\r\n      const newInventory = inventory.filter((item) => {\r\n        if (CountableItems.includes(item.type as any)) return true; // autosell does not sell countable items\r\n        // For InventoryUniqueItems\r\n        const uItem = item as InventoryUniqueItem;\r\n        if (uItem.isEquipped || uItem.isLocked) return true; // equipped and locked items are not sold\r\n        const itemType = uItem.type;\r\n        const itemRealm = uItem.item.realmIndex;\r\n        const itemQuality = uItem.item.quality;\r\n        if (type !== \"all\" && itemType !== type) return true; // types does not match\r\n        if (type === \"all\" || itemType === type) {\r\n          if (itemRealm <= realm.index && itemQuality <= quality) return false; // sell item\r\n        }\r\n        return true;\r\n      });\r\n      updateContext({ inventory: newInventory.slice() });\r\n    }, 1000);\r\n    return () => {\r\n      clearInterval(autosellInterval);\r\n    };\r\n  }, [type, realm, quality, isActive]);\r\n  return (\r\n    <Box\r\n      marginTop={2}\r\n      display=\"flex\"\r\n      gap={2}\r\n      alignItems={\"center\"}\r\n      flexWrap={\"wrap\"}\r\n    >\r\n      <Box>\r\n        <FormControl>\r\n          <InputLabel id=\"type-label\">Type</InputLabel>\r\n          <Select\r\n            labelId=\"type-label\"\r\n            value={type}\r\n            label=\"Type\"\r\n            onChange={typeSelectChange}\r\n          >\r\n            {ItemTypes.map((type) => (\r\n              <MenuItem value={type} key={type}>\r\n                {type}\r\n              </MenuItem>\r\n            ))}\r\n          </Select>\r\n        </FormControl>\r\n      </Box>\r\n      <Box>\r\n        <FormControl>\r\n          <InputLabel id=\"realm-label\">Realm</InputLabel>\r\n          <Select\r\n            labelId=\"realm-label\"\r\n            value={realm.index.toString()}\r\n            label=\"Realm\"\r\n            onChange={realmSelectChange}\r\n          >\r\n            {Realms.map((realm) => (\r\n              <MenuItem value={realm.index} key={realm.index}>\r\n                {realm.label}\r\n              </MenuItem>\r\n            ))}\r\n          </Select>\r\n        </FormControl>\r\n      </Box>\r\n      <Box maxWidth={120}>\r\n        <TextField\r\n          id=\"quality\"\r\n          label=\"Quality\"\r\n          variant=\"outlined\"\r\n          onChange={qualityFieldChange}\r\n          value={quality}\r\n        />\r\n      </Box>\r\n      <FormGroup>\r\n        <FormControlLabel\r\n          control={\r\n            <Checkbox checked={isActive} onClick={() => setActive(!isActive)} />\r\n          }\r\n          label=\"Autosell\"\r\n        />\r\n      </FormGroup>\r\n    </Box>\r\n  );\r\n}\r\n\r\ntype Realm = { label: string; index: number };\r\n","import { Box } from \"@mui/material\";\r\nimport React from \"react\";\r\nimport InventoryBottomPanel from \"./Inventory/InventoryBottomPanel\";\r\nimport InventoryFiltersPane from \"./Inventory/InventoryFilters\";\r\nimport InventoryGrid from \"./Inventory/InventoryGrid\";\r\nimport { PlayerContext } from \"GameEngine\";\r\nimport { isInventoryTreasure } from \"GameConstants/Interfaces\";\r\nimport AutosellPanel from \"./Inventory/AutosellPanel\";\r\n\r\nexport type InventoryFilters =\r\n  | \"all\"\r\n  | \"money\"\r\n  | \"treasure\"\r\n  | \"mineral\"\r\n  | \"herb\";\r\n\r\nexport default function Inventory() {\r\n  const { inventory } = React.useContext(PlayerContext);\r\n  const [type, setType] = React.useState<InventoryFilters>(\"all\");\r\n  // Filter equipped items\r\n  let displayedInventory = inventory.filter((item) => {\r\n    if (!isInventoryTreasure(item)) return true;\r\n    else {\r\n      return !item.isEquipped;\r\n    }\r\n  });\r\n\r\n  // Filter according to type\r\n  if (type !== \"all\") {\r\n    displayedInventory = displayedInventory.filter(\r\n      (item) => item.type === type\r\n    );\r\n  }\r\n\r\n  const [pages, setPages] = React.useState<InventoryPages>({\r\n    current: 1,\r\n    total: Math.ceil(displayedInventory.length / 36),\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    setPages((pages) => {\r\n      const total = Math.max(Math.ceil(displayedInventory.length / 36), 1);\r\n      return { current: Math.min(pages.current, total), total };\r\n    });\r\n  }, [displayedInventory.length]);\r\n\r\n  // Select inventory for the page\r\n  const inventoryPage = displayedInventory.slice(\r\n    (pages.current - 1) * 36,\r\n    Math.min(pages.current * 36, displayedInventory.length)\r\n  );\r\n\r\n  return (\r\n    <Box>\r\n      <Box display=\"flex\">\r\n        <InventoryGrid inventory={inventoryPage} />\r\n        <InventoryFiltersPane type={type} setType={setType} />\r\n      </Box>\r\n      <InventoryBottomPanel pages={pages} setPages={setPages} />\r\n      <AutosellPanel />\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport type InventoryPages = {\r\n  current: number;\r\n  total: number;\r\n};\r\n","import { Box, Typography, useTheme } from \"@mui/material\";\r\nimport { PlayerContext, useNumberParser, getStatName } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\n// Player baseStats display\r\nexport default function Stats() {\r\n  const { baseStats } = React.useContext(PlayerContext);\r\n  const parse = useNumberParser();\r\n  const theme = useTheme();\r\n\r\n  let description: Array<JSX.Element> = [];\r\n  for (const [key, value] of Object.entries(baseStats)) {\r\n    description.push(\r\n      <Typography key={key}>\r\n        {getStatName(key)}: {parse(value)}\r\n      </Typography>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Box paddingTop={theme.spacing(1)} paddingLeft={theme.spacing(1)}>\r\n      <Typography>Base stats</Typography>\r\n      {description}\r\n    </Box>\r\n  );\r\n}\r\n","import { TooltipProps, Typography, useTheme } from \"@mui/material\";\r\nimport HtmlTooltip from \"Components/shared/HtmlTooltip\";\r\nimport { PlayerContext, getSkillStructure, useNumberParser } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\n// Provides description\r\nexport default function SkillDetailsTooltip(\r\n  props: Omit<TooltipProps, \"title\"> & { skill: string }\r\n) {\r\n  const player = React.useContext(PlayerContext);\r\n  const skillStructure = getSkillStructure(props.skill, player);\r\n  const parse = useNumberParser();\r\n  const theme = useTheme();\r\n\r\n  return (\r\n    <HtmlTooltip\r\n      title={\r\n        <>\r\n          <Typography color=\"inherit\">Character {props.skill}</Typography>\r\n          <Typography>\r\n            Base {props.skill}: {parse(skillStructure.base)}\r\n          </Typography>\r\n\r\n          <Typography>\r\n            Manuals multi:\r\n            <Typography\r\n              component=\"span\"\r\n              color={\r\n                skillStructure.manuals >= 1\r\n                  ? theme.palette.success.main\r\n                  : theme.palette.error.main\r\n              }\r\n              display=\"inline\"\r\n            >\r\n              {\" \"}\r\n              x{parse(skillStructure.manuals)}\r\n            </Typography>\r\n          </Typography>\r\n          <Typography>\r\n            Treasures Multi:\r\n            <Typography\r\n              component=\"span\"\r\n              color={\r\n                skillStructure.treasuresMulti >= 1\r\n                  ? theme.palette.success.main\r\n                  : theme.palette.error.main\r\n              }\r\n              display=\"inline\"\r\n            >\r\n              {\" \"}\r\n              x{parse(skillStructure.treasuresMulti)}\r\n            </Typography>\r\n          </Typography>\r\n          <Typography>\r\n            Treasures bonus:\r\n            <Typography\r\n              component=\"span\"\r\n              color={\r\n                skillStructure.treasures >= 0\r\n                  ? theme.palette.success.main\r\n                  : theme.palette.error.main\r\n              }\r\n              display=\"inline\"\r\n            >\r\n              {\" \"}\r\n              +{parse(skillStructure.treasures)}\r\n            </Typography>\r\n          </Typography>\r\n        </>\r\n      }\r\n    >\r\n      {props.children}\r\n    </HtmlTooltip>\r\n  );\r\n}\r\n","import { Box, Typography, useTheme } from \"@mui/material\";\r\nimport React from \"react\";\r\nimport SkillDetailsTooltip from \"./Skills/SkillDetailTooltip\";\r\nimport { PlayerContext, getStatName, useNumberParser } from \"GameEngine\";\r\n\r\n// Bad coding here. #todo: make it a .map() render\r\nexport default function Skills() {\r\n  const { skills } = React.useContext(PlayerContext);\r\n  const parse = useNumberParser();\r\n  const theme = useTheme();\r\n\r\n  let description: Array<JSX.Element> = [];\r\n  for (const [key, value] of Object.entries(skills)) {\r\n    description.push(\r\n      <SkillDetailsTooltip skill={key} key={key}>\r\n        <Typography key={key}>\r\n          {getStatName(key)}: {parse(value)}\r\n        </Typography>\r\n      </SkillDetailsTooltip>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Box paddingTop={theme.spacing(1)} paddingLeft={theme.spacing(1)}>\r\n      {description}\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Button, useTheme } from \"@mui/material\";\r\nimport React from \"react\";\r\nimport Equipment from \"./PlayerStatsLayout/Equipment\";\r\nimport Inventory from \"./PlayerStatsLayout/Inventory\";\r\nimport Stats from \"./PlayerStatsLayout/Stats\";\r\nimport Skills from \"./PlayerStatsLayout/Skills\";\r\n\r\ntype Layout = \"inventory\" | \"equipment\" | \"stats\" | \"skills\";\r\n\r\n// Menu to switch between inventory, equipment and player stats displays\r\nexport default function PlayerStatsLayout() {\r\n  const [panel, selectPanel] = React.useState<Layout>(\"inventory\");\r\n  const theme = useTheme();\r\n  return (\r\n    <>\r\n      <Box width={512} height={32} paddingBottom={theme.spacing(5)}>\r\n        <Button\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          onClick={() => selectPanel(\"inventory\")}\r\n          color={panel === \"inventory\" ? \"success\" : \"primary\"}\r\n        >\r\n          Inventory\r\n        </Button>\r\n        <Button\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          onClick={() => selectPanel(\"equipment\")}\r\n          color={panel === \"equipment\" ? \"success\" : \"primary\"}\r\n        >\r\n          Equipment\r\n        </Button>\r\n        <Button\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          onClick={() => selectPanel(\"stats\")}\r\n          color={panel === \"stats\" ? \"success\" : \"primary\"}\r\n        >\r\n          Stats\r\n        </Button>\r\n        <Button\r\n          variant=\"outlined\"\r\n          size=\"small\"\r\n          onClick={() => selectPanel(\"skills\")}\r\n          color={panel === \"skills\" ? \"success\" : \"primary\"}\r\n        >\r\n          Skills\r\n        </Button>\r\n      </Box>\r\n      <Box width={512} height={512} overflow=\"auto\">\r\n        {panel === \"inventory\" ? <Inventory /> : \"\"}\r\n        {panel === \"equipment\" ? <Equipment /> : \"\"}\r\n        {panel === \"stats\" ? <Stats /> : \"\"}\r\n        {panel === \"skills\" ? <Skills /> : \"\"}\r\n      </Box>\r\n    </>\r\n  );\r\n}\r\n","import { Box } from \"@mui/material\";\r\nimport PlayerStatsPane from \"./LeftSideBar/PlayerStatsPane\";\r\nimport PlayerLocationPane from \"./LeftSideBar/PlayerLocationPane\";\r\nimport PlayerStatsLayout from \"./LeftSideBar/PlayerStatsLayout\";\r\n\r\nexport default function LeftSideBar() {\r\n  return (\r\n    <Box borderRight={\"1px solid gray\"}>\r\n      <PlayerStatsPane\r\n        displayStats={[\r\n          { name: \"Health Regen\", stat: \"healthRegen\" },\r\n          { name: \"Attack\", stat: \"attack\" },\r\n          { name: \"Defence\", stat: \"defence\" },\r\n          { name: \"Insight\", stat: \"insight\" },\r\n        ]}\r\n      />\r\n      <PlayerStatsLayout />\r\n      <PlayerLocationPane />\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Slider, Typography } from \"@mui/material\";\r\nimport { SettingsContext } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\nconst marks = [\r\n  {\r\n    value: 1,\r\n    label: 1,\r\n  },\r\n  {\r\n    value: 5,\r\n    label: 5,\r\n  },\r\n  {\r\n    value: 15,\r\n    label: 15,\r\n  },\r\n  {\r\n    value: 30,\r\n    label: 30,\r\n  },\r\n  {\r\n    value: 50,\r\n    label: 50,\r\n  },\r\n  {\r\n    value: 100,\r\n    label: 100,\r\n  },\r\n];\r\n\r\nexport default function TickRate() {\r\n  const { tickRate, updateContext } = React.useContext(SettingsContext);\r\n\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"h6\"> Game tick rate: </Typography>\r\n      <Box width={\"300px\"}>\r\n        <Slider\r\n          defaultValue={tickRate}\r\n          getAriaValueText={(value) => value.toString()}\r\n          step={1}\r\n          valueLabelDisplay=\"auto\"\r\n          marks={marks}\r\n          onChangeCommitted={(event, value) => {\r\n            updateContext({ tickRate: value as number });\r\n          }}\r\n        />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Slider, Typography } from \"@mui/material\";\r\nimport { SettingsContext } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\nconst marks = [\r\n  {\r\n    value: 1,\r\n    label: 1,\r\n  },\r\n  {\r\n    value: 2,\r\n    label: 2,\r\n  },\r\n  {\r\n    value: 3,\r\n    label: 3,\r\n  },\r\n  {\r\n    value: 5,\r\n    label: 5,\r\n  },\r\n  {\r\n    value: 10,\r\n    label: 10,\r\n  },\r\n];\r\n\r\nexport default function GameSpeed() {\r\n  const { gameSpeed, updateContext } = React.useContext(SettingsContext);\r\n\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"h6\"> Game speed: </Typography>\r\n      <Box width={\"300px\"}>\r\n        <Slider\r\n          defaultValue={gameSpeed}\r\n          getAriaValueText={(value) => value.toString()}\r\n          step={0.1}\r\n          max={10}\r\n          valueLabelDisplay=\"auto\"\r\n          marks={marks}\r\n          onChangeCommitted={(event, value) => {\r\n            updateContext({ gameSpeed: value as number });\r\n          }}\r\n        />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Button } from \"@mui/material\";\r\nimport { saveAs } from \"file-saver\";\r\n\r\nexport default function ExportSave() {\r\n  const handleClick = () => {\r\n    try {\r\n      let playerData = localStorage.getItem(\"player\");\r\n      let gameData = localStorage.getItem(\"game\");\r\n      if (!gameData || !playerData)\r\n        throw new Error(\"Save data not found in local storage\");\r\n      const save = {\r\n        player: JSON.parse(playerData),\r\n        game: JSON.parse(gameData),\r\n      };\r\n      const blob = new Blob([JSON.stringify(save)], {\r\n        type: \"application/json;charset=utf-8\",\r\n      });\r\n      saveAs(blob, \"save.json\");\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  return (\r\n    <Box>\r\n      <Button variant=\"outlined\" color=\"success\" onClick={handleClick}>\r\n        Export Save\r\n      </Button>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Button, Input } from \"@mui/material\";\r\nimport { PlayerContext, GameContext } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\nexport default function ImportSave() {\r\n  const { setContext: setPlayer } = React.useContext(PlayerContext);\r\n\r\n  const { setContext: setGame } = React.useContext(GameContext);\r\n  const submit = async (event: React.FormEvent<HTMLFormElement>) => {\r\n    try {\r\n      const input = event.target as HTMLInputElement;\r\n      if (input.files === null) {\r\n        throw new Error(\"No files submitted!\");\r\n      }\r\n      const file = input.files.item(0);\r\n      if (!file) throw new Error(\"File is undefined\");\r\n      const text = await file.text();\r\n      const data = JSON.parse(text);\r\n      if (!data.game || !data.player)\r\n        throw new Error(\"Wrong data format, should be {game, player}\");\r\n      setPlayer(data.player);\r\n      setGame(data.game);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  return (\r\n    <Box>\r\n      <form encType=\"multipart/form-data\" onChange={(event) => submit(event)}>\r\n        <Button\r\n          variant=\"outlined\"\r\n          color=\"primary\"\r\n          component=\"label\"\r\n          htmlFor=\"fileimport\"\r\n        >\r\n          Import Save\r\n        </Button>\r\n        <Input type=\"file\" id=\"fileimport\" style={{ display: \"none\" }} />\r\n      </form>\r\n    </Box>\r\n  );\r\n}\r\n","import { Button } from \"@mui/material\";\r\nimport { gameContent } from \"GameConstants/GameContent\";\r\nimport { PlayerContext, GameContext } from \"GameEngine\";\r\nimport { playerContext } from \"GameEngine/Player/PlayerContext\";\r\n\r\nimport React from \"react\";\r\n\r\nexport default function WipeSave() {\r\n  const { setContext: setPlayer } = React.useContext(PlayerContext);\r\n  const { setContext: setGame } = React.useContext(GameContext);\r\n\r\n  const handleClick = () => {\r\n    setPlayer(playerContext);\r\n    setGame(gameContent);\r\n    localStorage.removeItem(\"player\");\r\n    localStorage.removeItem(\"game\");\r\n  };\r\n\r\n  return (\r\n    <Button variant=\"outlined\" color=\"error\" onClick={handleClick}>\r\n      Wipe Save\r\n    </Button>\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  FormControl,\r\n  FormControlLabel,\r\n  Radio,\r\n  RadioGroup,\r\n  Typography,\r\n} from \"@mui/material\";\r\nimport { SettingsContext } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\nexport default function NumberNotation() {\r\n  const { notation, updateContext } = React.useContext(SettingsContext);\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"h6\">Number Notation</Typography>\r\n      <FormControl>\r\n        <RadioGroup defaultValue={notation} name=\"radio-buttons-group\">\r\n          <FormControlLabel\r\n            value=\"trivial\"\r\n            control={<Radio />}\r\n            label=\"trivial\"\r\n            onClick={() => updateContext({ notation: \"trivial\" })}\r\n          />\r\n          <FormControlLabel\r\n            value=\"exponential\"\r\n            control={<Radio />}\r\n            label=\"exponential\"\r\n            onClick={() => updateContext({ notation: \"exponential\" })}\r\n          />\r\n        </RadioGroup>\r\n      </FormControl>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Button, Paper, Typography, useTheme } from \"@mui/material\";\r\nimport getSpacing from \"Utils/getSpacing\";\r\nimport { getWindowDimensions } from \"Utils/useWindowDimensions\";\r\nimport TickRate from \"Pages/SettingsPage/TickRate\";\r\nimport GameSpeed from \"Pages/SettingsPage/GameSpeed\";\r\nimport ExportSave from \"Pages/SettingsPage/ExportSave\";\r\nimport ImportSave from \"Pages/SettingsPage/ImportSave\";\r\nimport WipeSave from \"Pages/SettingsPage/WipeSave\";\r\nimport NumberNotation from \"Pages/SettingsPage/NumberNotation\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\n\r\ntype Props = {\r\n  setSettings: React.Dispatch<React.SetStateAction<boolean>>;\r\n};\r\n\r\nexport default function SettingsPage(props: Props) {\r\n  const { setSettings } = props;\r\n  const theme = useTheme();\r\n  const { width, height } = getWindowDimensions();\r\n\r\n  return (\r\n    <Paper>\r\n      <Box\r\n        position=\"absolute\"\r\n        width={width}\r\n        height={height - getSpacing(theme, 8)}\r\n        top={getSpacing(theme, 8)}\r\n        left={0}\r\n        display={\"flex\"}\r\n        flexDirection={\"column\"}\r\n        alignItems={\"center\"}\r\n        gap={2}\r\n        paddingTop={2}\r\n      >\r\n        <Box\r\n          display=\"flex\"\r\n          width={width}\r\n          alignItems=\"center\"\r\n          justifyContent=\"space-between\"\r\n        >\r\n          <Box />\r\n          <Typography variant=\"h4\" sx={{ alignSelf: \"center\" }}>\r\n            Settings\r\n          </Typography>\r\n          <Button\r\n            variant=\"outlined\"\r\n            onClick={() => setSettings((x) => !x)}\r\n            sx={{ marginRight: 2 }}\r\n          >\r\n            <CloseIcon fontSize=\"small\" />\r\n          </Button>\r\n        </Box>\r\n\r\n        <TickRate />\r\n        <GameSpeed />\r\n        <NumberNotation />\r\n        <Box display=\"flex\" flexDirection={\"column\"}>\r\n          <Typography variant=\"h6\">Save Manager</Typography>\r\n        </Box>\r\n        <Box display=\"flex\" gap={2}>\r\n          <ExportSave />\r\n          <ImportSave />\r\n          <WipeSave />\r\n        </Box>\r\n      </Box>\r\n    </Paper>\r\n  );\r\n}\r\n","/**\r\n * Creates a cookie which expires after a certain amount of days.\r\n * @param name - name for the cookie\r\n * @param value - value for the cookie\r\n * @param days - expires after certain amount of days\r\n */\r\nexport function createCookie(name: string, value: string, days: number): void {\r\n  let expires = \"\";\r\n  if (days) {\r\n    const date = new Date();\r\n    date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\r\n    expires = \"; expires=\" + date.toUTCString();\r\n  }\r\n  // Creates cookie\r\n  document.cookie = name + \"=\" + value + expires + \"; path=/\";\r\n}\r\n\r\n/**\r\n * Gets specified cookie value or returns empty string if cookie doesn't exist.\r\n * @param cookieName - name of the cookie\r\n */\r\nexport function accessCookie(cookieName: string): string {\r\n  const name: string = cookieName + \"=\";\r\n  const allCookieArray = document.cookie.split(\";\");\r\n  for (let i = 0; i < allCookieArray.length; i++) {\r\n    const temp = allCookieArray[i].trim();\r\n    if (temp.indexOf(name) === 0)\r\n      return temp.substring(name.length, temp.length);\r\n  }\r\n  return \"\";\r\n}\r\n","import React from \"react\";\r\nimport SettingsContext, {\r\n  SettingsContextType,\r\n  settingsContext,\r\n} from \"./SettingsContext/SettingContext\";\r\nimport { accessCookie, createCookie } from \"Utils/Cookie\";\r\nimport { defaultUpdateInterval } from \"GameConstants/Constants\";\r\n\r\nexport default function SettingsContextLoader(props: any) {\r\n  const [settings, setSettings] = React.useState(settingsContext);\r\n  const [loaded, setLoaded] = React.useState<boolean>(false);\r\n  /** Updates context using shallow merge of SettingsContext attributes. */\r\n  const updateContext = (newData: Partial<SettingsContextType>) =>\r\n    setSettings((data) => ({ ...data, ...newData }));\r\n\r\n  // Load settings values from cookies\r\n  React.useEffect(() => {\r\n    try {\r\n      let tickrate: any = accessCookie(\"tickrate\");\r\n      let gameSpeed: any = accessCookie(\"gamespeed\");\r\n      let notation: any = accessCookie(\"notation\");\r\n      if (tickrate) tickrate = Number(tickrate);\r\n      if (gameSpeed) gameSpeed = Number(gameSpeed);\r\n      setSettings({\r\n        tickRate: tickrate || Math.floor(1000 / defaultUpdateInterval),\r\n        gameSpeed: gameSpeed || 1,\r\n        notation: notation || \"trivial\",\r\n      });\r\n      setLoaded(true);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    createCookie(\"tickrate\", settings.tickRate.toString(), 1000);\r\n    createCookie(\"gamespeed\", settings.gameSpeed.toString(), 1000);\r\n    createCookie(\"notation\", settings.notation, 1000);\r\n  }, [settings]);\r\n\r\n  return (\r\n    <SettingsContext.Provider\r\n      value={{ ...settings, updateContext, setContext: setSettings }}\r\n    >\r\n      {loaded && props.children}\r\n    </SettingsContext.Provider>\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  LinearProgress,\r\n  LinearProgressProps,\r\n  Typography,\r\n} from \"@mui/material\";\r\n\r\ntype Props = {\r\n  label: string;\r\n  value: number;\r\n  rightLabel?: boolean;\r\n} & LinearProgressProps;\r\n\r\nexport default function ProgressBar(props: Props) {\r\n  const { label, rightLabel, ...rest } = props;\r\n  const isRight = rightLabel;\r\n  return (\r\n    <Box sx={{ display: \"flex\", alignItems: \"center\" }}>\r\n      {!isRight && (\r\n        <Typography variant=\"body1\" color=\"text.primary\">\r\n          {label}\r\n        </Typography>\r\n      )}\r\n      <Box sx={{ width: \"60%\", m: 1 }}>\r\n        <LinearProgress variant=\"determinate\" color=\"primary\" {...rest} />\r\n      </Box>\r\n      {isRight && (\r\n        <Typography variant=\"body1\" color=\"text.primary\">\r\n          {label}\r\n        </Typography>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n","import { year, month } from \"GameConstants/Constants\";\r\n\r\n// Parses time from milliseconds to human readable ingame format\r\nexport default function parseTime(time: number): string {\r\n  const years = Math.floor(time / year);\r\n  // Just in case to not overflow 12 due to rounding\r\n  const months = Math.min((time - years * year) / month, 12);\r\n  return years !== 0\r\n    ? `${years} y ${months.toPrecision(2)} m`\r\n    : `${months.toPrecision(2)} m`;\r\n}\r\n","import { Box, Typography } from \"@mui/material\";\r\nimport { ActivitiesFunctions, Activity } from \"GameConstants/Activities\";\r\nimport { PlayerBaseStats, PlayerSkills } from \"GameConstants/Player\";\r\nimport { PlayerContext, getStatName, useNumberParser } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\ntype Props = {\r\n  stats: Partial<PlayerBaseStats> | Partial<PlayerSkills>;\r\n  requiredTime?: number;\r\n  activity: Activity;\r\n  multiplicatorFunctionName?: string;\r\n};\r\n\r\nexport default function ActivityStatsDescription(props: Props) {\r\n  const player = React.useContext(PlayerContext);\r\n  const { stats, activity, multiplicatorFunctionName, requiredTime } = props;\r\n  const parse = useNumberParser();\r\n  // Display the  description\r\n  const StatsDescription: StatsLine[] = [];\r\n  for (const [key, value] of Object.entries(stats)) {\r\n    StatsDescription.push({\r\n      text: getStatName(key),\r\n      effect:\r\n        value *\r\n        (multiplicatorFunctionName\r\n          ? ActivitiesFunctions[multiplicatorFunctionName](activity, player)\r\n          : 1),\r\n    });\r\n  }\r\n  return (\r\n    <Box display=\"flex\" gap={1}>\r\n      {StatsDescription.map((item) => (\r\n        <Typography key={item.text} variant=\"body1\" display=\"inline\">\r\n          {item.text}{\" \"}\r\n          {requiredTime\r\n            ? requiredTime > 1000\r\n              ? parse(item.effect)\r\n              : parse((item.effect / requiredTime) * 1000)\r\n            : \"\"}\r\n        </Typography>\r\n      ))}\r\n      {requiredTime && requiredTime < 1000 ? \"/s\" : \"\"}\r\n    </Box>\r\n  );\r\n}\r\n\r\ntype StatsLine = {\r\n  text: string;\r\n  effect: number;\r\n};\r\n","import { Box } from \"@mui/material\";\r\nimport CropSquareImage from \"./CropImage\";\r\nimport findItemDescription from \"GameConstants/utils/findItemDescription\";\r\nimport { ActivityItem } from \"GameConstants/Activities/Activities\";\r\n\r\ntype Props = {\r\n  items: ActivityItem[];\r\n};\r\n\r\n// Generates item descriptions in the format Image Name Amount\r\nexport default function ItemImages(props: Props) {\r\n  const { items } = props;\r\n  let result: JSX.Element[] = [];\r\n  let i = 0;\r\n  for (let item of items) {\r\n    i++;\r\n    const description = findItemDescription(item.name, item.type);\r\n    if (!description) continue;\r\n    const { path, sizeX: size, x, y } = description.image;\r\n    result.push(\r\n      <Box key={i} display=\"flex\">\r\n        <CropSquareImage path={path} size={size} position={{ x, y }} />\r\n      </Box>\r\n    );\r\n  }\r\n  return <Box>{result.map((item) => item)}</Box>;\r\n}\r\n","import { Box, Paper, Typography, useTheme } from \"@mui/material\";\r\nimport ProgressBar from \"../shared/ProgressBar\";\r\nimport React from \"react\";\r\nimport parseTime from \"Utils/parseTime\";\r\nimport { ActivityCardProps } from \"./types\";\r\nimport itemImages from \"../shared/ItemImages\";\r\nimport { PlayerContext, useNumberParser, getStatName } from \"GameEngine\";\r\nimport { ActivitiesFunctions } from \"GameConstants/Activities\";\r\nimport { defaultUpdateInterval } from \"GameConstants/Constants\";\r\nimport ItemImages from \"../shared/ItemImages\";\r\nimport ActivityStatsDescription from \"Components/shared/ActivityStatsDescription\";\r\n\r\n// Activity panel for activity without price, shows result image in the top right corner\r\nexport default function GatheringActivityCard(props: ActivityCardProps) {\r\n  const { activity, isActive, source } = props;\r\n  const player = React.useContext(PlayerContext);\r\n  const parse = useNumberParser();\r\n  const { updateContext } = player;\r\n  const { result, price } = activity;\r\n  const theme = useTheme();\r\n\r\n  const handleClick = () => {\r\n    // If training is active\r\n    if (isActive)\r\n      updateContext({ state: { action: \"idle\", activity: undefined } });\r\n    // Set active training\r\n    else {\r\n      updateContext({\r\n        state: {\r\n          action: \"activity\",\r\n          activity: { name: activity.name, source },\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  const ItemRewardDescription: ItemLine[] = [];\r\n  if (result.items) {\r\n    for (let item of result.items) {\r\n      ItemRewardDescription.push({\r\n        name: item.name,\r\n        amount: item.amount,\r\n      });\r\n    }\r\n  }\r\n\r\n  // Determine remaining time for timed activities\r\n  const requiredTime = activity.time\r\n    ? ActivitiesFunctions[activity.time](activity, player)\r\n    : activity.baseTime;\r\n  const currentTime = activity.currentTime || 0;\r\n\r\n  // Change some displayed effects if action is really fast\r\n  const fastAction = requiredTime / defaultUpdateInterval < 5;\r\n  const progressBarLabel =\r\n    requiredTime < 1000\r\n      ? (1000 / requiredTime).toFixed(2) + \"/s\"\r\n      : parseTime(requiredTime);\r\n  return (\r\n    <Paper\r\n      elevation={8}\r\n      sx={{\r\n        paddingX: theme.spacing(2),\r\n        paddingY: theme.spacing(1),\r\n        margin: theme.spacing(2),\r\n        borderRadius: theme.spacing(2),\r\n        minHeight: 60,\r\n        border: \"1px solid lightgray\",\r\n        borderColor: isActive ? theme.palette.primary.main : \"lightgray\",\r\n        padding: theme.spacing(1),\r\n      }}\r\n    >\r\n      <Box display={\"flex\"}>\r\n        <Box\r\n          display=\"flex\"\r\n          flexDirection={\"column\"}\r\n          justifyContent={\"space-between\"}\r\n          minWidth={price ? 400 : 600}\r\n          minHeight={60}\r\n          height=\"100%\"\r\n          onClick={() => handleClick()}\r\n        >\r\n          <Box display=\"flex\">\r\n            <Box display=\"flex\" flexDirection={\"column\"}>\r\n              <Typography>{activity.name}</Typography>\r\n              {result.baseStats && (\r\n                <ActivityStatsDescription\r\n                  stats={result.baseStats}\r\n                  activity={activity}\r\n                  requiredTime={requiredTime}\r\n                  multiplicatorFunctionName={result.baseStatsMulti}\r\n                />\r\n              )}\r\n\r\n              {ItemRewardDescription.length > 0 && (\r\n                <Box display=\"flex\" gap={theme.spacing(1)}>\r\n                  {ItemRewardDescription.map((item, index) => (\r\n                    <Typography key={index} variant=\"body1\" display=\"inline\">\r\n                      {item.name} {parse(item.amount)}\r\n                    </Typography>\r\n                  ))}\r\n                </Box>\r\n              )}\r\n              {result.skills && (\r\n                <ActivityStatsDescription\r\n                  stats={result.skills}\r\n                  activity={activity}\r\n                  requiredTime={requiredTime}\r\n                  multiplicatorFunctionName={result.skillsMulti}\r\n                />\r\n              )}\r\n            </Box>\r\n            <Box marginLeft=\"auto\" display={\"flex\"} marginRight={2}>\r\n              {result.items && <ItemImages items={result.items} />}\r\n            </Box>\r\n          </Box>\r\n          <Box>\r\n            <ProgressBar\r\n              value={\r\n                fastAction && isActive\r\n                  ? 100\r\n                  : (currentTime / requiredTime) * 100\r\n              }\r\n              label={progressBarLabel}\r\n              rightLabel\r\n            />\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n    </Paper>\r\n  );\r\n}\r\n\r\ntype StatsLine = {\r\n  text: string;\r\n  effect: number;\r\n};\r\n\r\ntype ItemLine = {\r\n  name: string;\r\n  amount: number;\r\n};\r\n","import { Box } from \"@mui/material\";\r\nimport React, { ComponentType } from \"react\";\r\nimport { ActivityCardProps } from \"Components\";\r\nimport { GameContext, PlayerContext } from \"GameEngine\";\r\n\r\ntype Props = { source: string; Card: ComponentType<ActivityCardProps> };\r\n\r\nexport default function ActionsPage(props: Props) {\r\n  const { source, Card } = props;\r\n  const gameData = React.useContext(GameContext);\r\n  const { state } = React.useContext(PlayerContext);\r\n\r\n  // Determine active action if any\r\n  const { action, activity } = state;\r\n  let activityName = \"\";\r\n  if (action === \"activity\" && activity) {\r\n    activityName = activity.name;\r\n  }\r\n\r\n  return (\r\n    <Box>\r\n      <Box display=\"flex\" flexWrap={\"wrap\"}>\r\n        {gameData[source].map((activity) => {\r\n          return (\r\n            // some conflict in type resolution files. Just ignore the linter warning\r\n            // @ts-ignore\r\n            <Card\r\n              activity={activity}\r\n              isActive={activityName === activity.name}\r\n              showTimesCompleted\r\n              source={source}\r\n              key={activity.name}\r\n            />\r\n          );\r\n        })}\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Typography } from \"@mui/material\";\r\n\r\nimport CropSquareImage from \"./CropImage\";\r\nimport { useNumberParser } from \"GameEngine\";\r\nimport { ActivityItem } from \"GameConstants/Activities/Activities\";\r\nimport findItemDescription from \"GameConstants/utils/findItemDescription\";\r\n\r\ntype Props = {\r\n  items: ActivityItem[];\r\n};\r\n\r\n// Generates item descriptions in the format Image Name Amount\r\nexport default function ItemDescriptions(props: Props) {\r\n  const { items } = props;\r\n  const parse = useNumberParser();\r\n  let result: JSX.Element[] = [];\r\n  let i = 0;\r\n  for (let item of items) {\r\n    i++;\r\n    const description = findItemDescription(item.name, item.type);\r\n    if (!description) continue;\r\n    const { path, sizeX: size, x, y } = description.image;\r\n    result.push(\r\n      <Box key={i} display=\"flex\" alignItems={\"center\"} gap={1}>\r\n        <CropSquareImage path={path} size={size} position={{ x, y }} />\r\n        <Typography display=\"inline\">\r\n          {item.name} {parse(item.amount)}\r\n        </Typography>\r\n      </Box>\r\n    );\r\n  }\r\n  return <Box>{result.map((item) => item)}</Box>;\r\n}\r\n","import { Box, Button, Typography } from \"@mui/material\";\r\nimport { ActivitiesFunctions, Activity } from \"GameConstants/Activities\";\r\nimport ArrowForwardIcon from \"@mui/icons-material/ArrowForward\";\r\nimport parseTime from \"Utils/parseTime\";\r\nimport ItemDescriptions from \"Components/shared/ItemDescriptions\";\r\nimport ActivityStatsDescription from \"Components/shared/ActivityStatsDescription\";\r\n\r\ntype Props = {\r\n  item: any;\r\n  context: {\r\n    setActiveItem: React.Dispatch<React.SetStateAction<string | undefined>>;\r\n  };\r\n};\r\n\r\nexport default function TreasureTooltip(props: Props) {\r\n  const { item, context } = props;\r\n  const activity: Activity = item;\r\n  const craftTime = activity.time\r\n    ? ActivitiesFunctions[activity.time](activity)\r\n    : activity.baseTime;\r\n\r\n  const craftTimeLabel =\r\n    craftTime < 1000\r\n      ? (1000 / craftTime).toFixed(2) + \"/s\"\r\n      : parseTime(craftTime);\r\n\r\n  const { result, price } = activity;\r\n\r\n  return (\r\n    <Box sx={{ border: 1, p: 1, bgcolor: \"background.paper\" }}>\r\n      <Typography variant=\"h6\">{item.name}</Typography>\r\n      <Typography>Craft time: {craftTimeLabel}</Typography>\r\n      <Typography>{item.description}</Typography>\r\n      <Box\r\n        display=\"flex\"\r\n        justifyContent={\"space-between\"}\r\n        marginY={2}\r\n        alignItems={\"center\"}\r\n      >\r\n        {price && price.items && <ItemDescriptions items={price.items} />}\r\n\r\n        <ArrowForwardIcon fontSize={\"large\"} />\r\n\r\n        <Box display={\"flex\"} marginRight={2}>\r\n          {result.items && <ItemDescriptions items={result.items} />}\r\n        </Box>\r\n      </Box>\r\n      {result.baseStats && (\r\n        <ActivityStatsDescription\r\n          stats={result.baseStats}\r\n          activity={activity}\r\n          requiredTime={craftTime}\r\n          multiplicatorFunctionName={activity.result.baseStatsMulti}\r\n        />\r\n      )}\r\n      {result.skills && (\r\n        <ActivityStatsDescription\r\n          stats={result.skills}\r\n          activity={activity}\r\n          requiredTime={craftTime}\r\n          multiplicatorFunctionName={activity.result.skillsMulti}\r\n        />\r\n      )}\r\n      <Button\r\n        variant=\"outlined\"\r\n        onClick={() => context.setActiveItem(activity.name)}\r\n      >\r\n        Select\r\n      </Button>\r\n    </Box>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Box, ClickAwayListener, Popper } from \"@mui/material\";\r\ntype GridItemProps = {\r\n  width: number;\r\n  height: number;\r\n  item: any;\r\n  Cell: (props: any) => JSX.Element;\r\n  Tooltip?: (props: any) => JSX.Element;\r\n  context?: any;\r\n};\r\n\r\nexport default function GridItem(props: GridItemProps) {\r\n  const { width, height, item, Cell, Tooltip } = props;\r\n\r\n  // For the tooltip handling\r\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n\r\n  const handleClick = (event: React.MouseEvent<HTMLElement>) => {\r\n    setAnchorEl(anchorEl ? null : event.currentTarget);\r\n  };\r\n\r\n  const handleClickAway = () => {\r\n    setAnchorEl(null);\r\n  };\r\n  const open = Boolean(anchorEl);\r\n  const id = open ? \"simple-popper\" : undefined;\r\n\r\n  return (\r\n    <ClickAwayListener onClickAway={handleClickAway}>\r\n      <Box width={width} height={height} onClick={handleClick}>\r\n        <Cell\r\n          width={width}\r\n          height={height}\r\n          item={item}\r\n          context={props.context}\r\n        />\r\n        <Popper id={id} open={open} anchorEl={anchorEl}>\r\n          {Tooltip && <Tooltip item={item} context={props.context} />}\r\n        </Popper>\r\n      </Box>\r\n    </ClickAwayListener>\r\n  );\r\n}\r\n","import { Box } from \"@mui/material\";\r\n\r\ntype Props = {\r\n  width: number;\r\n  height: number;\r\n};\r\n\r\n// Just a placeholder white square for grids\r\nexport default function EmptyCell(props: Props) {\r\n  const { width, height } = props;\r\n  return <Box width={width} height={height} border=\"1px solid gray\" />;\r\n}\r\n","import { Box } from \"@mui/material\";\r\nimport GridItem from \"./ItemGrid/GridItem\";\r\nimport EmptyCell from \"./ItemGrid/EmptyCell\";\r\nimport { ItemType } from \"GameConstants/Interfaces\";\r\n\r\ntype Props = {\r\n  cellWidth: number;\r\n  cellHeight: number;\r\n  sizeX: number;\r\n  sizeY: number;\r\n  items: Array<any>;\r\n  // If Cell is defined, draws the same kind of cells for all items ignoring the itemTypes\r\n  Cell?: (props: any) => JSX.Element;\r\n  Tooltip?: (props: any) => JSX.Element;\r\n  itemTypes?: {\r\n    type: ItemType;\r\n    Cell: (props: any) => JSX.Element;\r\n    Tooltip: (props: any) => JSX.Element;\r\n  }[];\r\n  context?: any;\r\n};\r\n\r\nexport default function ItemGrid(props: Props) {\r\n  const {\r\n    cellWidth,\r\n    cellHeight,\r\n    sizeX,\r\n    sizeY,\r\n    items,\r\n    itemTypes,\r\n    Cell,\r\n    Tooltip,\r\n  } = props;\r\n  const tileIndex = Array(sizeX * sizeY)\r\n    .fill(0)\r\n    .map((element, index) => index);\r\n\r\n  // Resolve cell contents and tooltips based on item types\r\n  const Tiles = tileIndex.map((value) => {\r\n    const item = items[value];\r\n    if (!item) return { index: value, Cell: EmptyCell };\r\n    if (Cell) return { index: value, Cell: Cell, Tooltip: Tooltip };\r\n    if (!itemTypes) return { index: value, Cell: EmptyCell };\r\n    const view = itemTypes.find((element) => element.type === item.type);\r\n    if (!view) return { index: value, Cell: EmptyCell };\r\n    return { index: value, Cell: view.Cell, Tooltip: view.Tooltip };\r\n  });\r\n  return (\r\n    <Box\r\n      width={sizeX * cellWidth}\r\n      height={sizeY * cellHeight}\r\n      display=\"flex\"\r\n      flexWrap=\"wrap\"\r\n    >\r\n      {Tiles.map((tile) => {\r\n        return (\r\n          <GridItem\r\n            width={cellWidth}\r\n            height={cellHeight}\r\n            item={items[tile.index]}\r\n            Cell={tile.Cell}\r\n            Tooltip={tile.Tooltip}\r\n            key={tile.index}\r\n            context={props.context}\r\n          />\r\n        );\r\n      })}\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Typography } from \"@mui/material\";\r\nimport CropSquareImage from \"../shared/CropImage\";\r\nimport findItemDescription from \"GameConstants/utils/findItemDescription\";\r\nimport { ItemType } from \"GameConstants/Interfaces\";\r\n\r\ntype Props = {\r\n  width: number;\r\n  height: number;\r\n  item: { name: string; type: ItemType };\r\n};\r\n\r\nexport default function BasicGridCell(props: Props) {\r\n  const { width, height, item } = props;\r\n  const description = findItemDescription(item.name, item.type);\r\n  const { image } = description;\r\n\r\n  return (\r\n    <Box\r\n      width={width}\r\n      height={height}\r\n      border=\"1px solid gray\"\r\n      display=\"flex\"\r\n      flexDirection=\"column\"\r\n      sx={{ justifyContent: \"space-around\", alignItems: \"center\" }}\r\n    >\r\n      <Box>\r\n        <CropSquareImage\r\n          path={image.path}\r\n          size={image.sizeX}\r\n          position={{ x: image.x, y: image.y }}\r\n        />\r\n      </Box>\r\n      <Box maxWidth={width} overflow=\"auto\" whiteSpace={\"nowrap\"}>\r\n        <Typography>{item.name}</Typography>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Typography } from \"@mui/material\";\r\nimport { PlayerContext, useNumberParser } from \"GameEngine\";\r\nimport { Activity } from \"GameConstants/Activities/Activities\";\r\nimport findItemDescription from \"GameConstants/utils/findItemDescription\";\r\nimport { CropSquareImage } from \"Components\";\r\nimport { UniqueItems } from \"GameConstants/Interfaces\";\r\nimport { quality } from \"GameConstants/Activities/Crafting\";\r\nimport React from \"react\";\r\nimport power from \"GameConstants/Activities/Crafting/power\";\r\n\r\ntype Props = {\r\n  activity: Activity;\r\n};\r\n\r\n// Generates item descriptions in the format Image Name Amount\r\nexport default function ResultItemDescription(props: Props) {\r\n  const { skills } = React.useContext(PlayerContext);\r\n  const { activity } = props;\r\n  const items = activity.result.items;\r\n  if (!items) return <></>;\r\n  const parse = useNumberParser();\r\n  let result: JSX.Element[] = [];\r\n  let i = 0;\r\n  for (let item of items) {\r\n    i++;\r\n    const description = findItemDescription(item.name, item.type);\r\n    if (!description) continue;\r\n    const { path, sizeX: size, x, y } = description.image;\r\n    let itemQuality, itemPower;\r\n    if (UniqueItems.includes(item.type as any)) {\r\n      itemQuality = quality(\r\n        description.realmIndex,\r\n        skills.crafting,\r\n        activity.price?.priceMulti || 1\r\n      );\r\n      itemPower = power(itemQuality, description.realmIndex);\r\n    }\r\n    result.push(\r\n      <Box display=\"flex\" flexDirection={\"column\"} key={i}>\r\n        <Box display=\"flex\" alignItems={\"center\"} gap={1}>\r\n          <CropSquareImage path={path} size={size} position={{ x, y }} />\r\n          <Typography display=\"inline\">\r\n            {item.name} {parse(item.amount)}\r\n          </Typography>\r\n        </Box>\r\n        {UniqueItems.includes(item.type as any) ? (\r\n          <Typography>\r\n            quality: {parse(itemQuality)} power: {parse(itemPower)}\r\n          </Typography>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </Box>\r\n    );\r\n  }\r\n  return <Box>{result.map((item) => item)}</Box>;\r\n}\r\n","import { Box, Button, Paper, useTheme } from \"@mui/material\";\r\nimport { ActivityStatsDescription } from \"Components\";\r\nimport ItemDescriptions from \"Components/shared/ItemDescriptions\";\r\nimport { ActivitiesFunctions, Activity } from \"GameConstants/Activities\";\r\nimport parseTime from \"Utils/parseTime\";\r\nimport ArrowForwardIcon from \"@mui/icons-material/ArrowForward\";\r\nimport ProgressBar from \"Components/shared/ProgressBar\";\r\nimport { GameContext, PlayerContext } from \"GameEngine\";\r\nimport React from \"react\";\r\nimport { defaultUpdateInterval } from \"GameConstants/Constants\";\r\nimport ResultItemDescription from \"./ResultItemDescription\";\r\n\r\ntype Props = {\r\n  activity: Activity;\r\n};\r\n\r\nexport default function ActiveItem(props: Props) {\r\n  const { activity } = props;\r\n  const player = React.useContext(PlayerContext);\r\n  const { crafting, updateContext: updateGameContext } =\r\n    React.useContext(GameContext);\r\n  const theme = useTheme();\r\n  const { price, result } = activity;\r\n  const isActive =\r\n    player.state.action === \"activity\" &&\r\n    player.state.activity?.name === activity.name;\r\n  // Determine remaining time for timed activities\r\n  const requiredTime = activity.time\r\n    ? ActivitiesFunctions[activity.time](activity, player)\r\n    : activity.baseTime;\r\n  const currentTime = activity.currentTime || 0;\r\n\r\n  // Change some displayed effects if action is really fast\r\n  const fastAction = requiredTime / defaultUpdateInterval < 5;\r\n  const progressBarLabel =\r\n    requiredTime < 1000\r\n      ? (1000 / requiredTime).toFixed(2) + \"/s\"\r\n      : parseTime(requiredTime);\r\n\r\n  const craftButtonClick = () => {\r\n    if (isActive) {\r\n      player.updateContext({ state: { action: \"idle\", activity: undefined } });\r\n      const index = crafting.findIndex((craft) => craft.name === activity.name);\r\n      if (index !== -1) {\r\n        crafting[index].currentTime = 0;\r\n        updateGameContext({ crafting: crafting.slice() });\r\n      }\r\n    } else {\r\n      player.updateContext({\r\n        state: {\r\n          action: \"activity\",\r\n          activity: { name: activity.name, source: \"crafting\" },\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Paper\r\n      elevation={8}\r\n      sx={{\r\n        paddingX: theme.spacing(2),\r\n        paddingY: theme.spacing(1),\r\n        borderRadius: theme.spacing(2),\r\n        minHeight: 60,\r\n        border: \"1px solid lightgray\",\r\n        borderColor: isActive ? theme.palette.primary.main : \"lightgray\",\r\n        padding: theme.spacing(1),\r\n        maxWidth: \"600px\",\r\n      }}\r\n    >\r\n      <Box\r\n        display=\"flex\"\r\n        flexDirection={\"column\"}\r\n        justifyContent={\"space-between\"}\r\n        minWidth={price ? 400 : 600}\r\n        minHeight={60}\r\n        height=\"100%\"\r\n      >\r\n        {\" \"}\r\n        <Box\r\n          display=\"flex\"\r\n          justifyContent={\"space-between\"}\r\n          marginY={2}\r\n          alignItems={\"center\"}\r\n        >\r\n          {price && price.items && <ItemDescriptions items={price.items} />}\r\n\r\n          <ArrowForwardIcon fontSize={\"large\"} />\r\n\r\n          <Box display={\"flex\"} marginRight={2}>\r\n            {result.items && <ResultItemDescription activity={activity} />}\r\n          </Box>\r\n        </Box>\r\n        {result.baseStats && (\r\n          <ActivityStatsDescription\r\n            stats={result.baseStats}\r\n            activity={activity}\r\n            requiredTime={requiredTime}\r\n            multiplicatorFunctionName={activity.result.baseStatsMulti}\r\n          />\r\n        )}\r\n        {result.skills && (\r\n          <ActivityStatsDescription\r\n            stats={result.skills}\r\n            activity={activity}\r\n            requiredTime={requiredTime}\r\n            multiplicatorFunctionName={activity.result.skillsMulti}\r\n          />\r\n        )}\r\n        <Box>\r\n          <ProgressBar\r\n            value={\r\n              fastAction && isActive ? 100 : (currentTime / requiredTime) * 100\r\n            }\r\n            label={progressBarLabel}\r\n            rightLabel\r\n          />\r\n        </Box>\r\n        <Button variant=\"outlined\" onClick={craftButtonClick}>\r\n          {isActive ? \"stop\" : \"craft\"}\r\n        </Button>\r\n      </Box>\r\n    </Paper>\r\n  );\r\n}\r\n","import { Box, Input, Paper, Typography } from \"@mui/material\";\r\nimport { Activity } from \"GameConstants/Activities\";\r\nimport { GameContext } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\ntype Props = {\r\n  activity: Activity;\r\n};\r\n\r\nexport default function PriceMultiplier(props: Props) {\r\n  const { activity } = props;\r\n  const { crafting, updateContext } = React.useContext(GameContext);\r\n  const multi = activity.price?.priceMulti || 1;\r\n\r\n  const handleChange = (event) => {\r\n    try {\r\n      const newMulti = parseInt(event.target.value);\r\n      if (isNaN(newMulti)) throw new Error(`Price multiplier is not a number`);\r\n      const index = crafting.findIndex((craft) => craft.name === activity.name);\r\n      if (index === -1) return;\r\n      if (crafting[index].price)\r\n        (crafting[index].price as any).priceMulti = newMulti;\r\n      updateContext({ crafting: crafting.slice() });\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  return (\r\n    <Paper\r\n      elevation={8}\r\n      sx={{\r\n        borderRadius: 2,\r\n        minHeight: 60,\r\n        border: \"1px solid lightgray\",\r\n        borderColor: \"lightgray\",\r\n        padding: 1,\r\n        minWidth: 60,\r\n      }}\r\n    >\r\n      <Box display=\"flex\" flexDirection={\"column\"} minHeight={60} height=\"100%\">\r\n        <Typography>Price Multi</Typography>\r\n        <Input defaultValue={multi} onChange={handleChange} />\r\n      </Box>\r\n    </Paper>\r\n  );\r\n}\r\n","import { BasicGridCell } from \"Components\";\r\nimport { Activity } from \"GameConstants/Activities\";\r\nimport findItemDescription from \"GameConstants/utils/findItemDescription\";\r\n\r\ntype Props = {\r\n  width: number;\r\n  height: number;\r\n  item: Activity;\r\n};\r\n\r\nexport default function TreasureCell(props: Props) {\r\n  const { width, height, item } = props;\r\n  const reward = item.result.items!;\r\n  const { name, type } = reward[0];\r\n\r\n  return <BasicGridCell width={width} height={height} item={{ name, type }} />;\r\n}\r\n","import { Box } from \"@mui/material\";\r\nimport React from \"react\";\r\nimport { Crafting } from \"GameConstants/Activities\";\r\nimport TreasureTooltip from \"./CraftingPage/TreasureTooltip\";\r\nimport { ItemGrid } from \"Components\";\r\nimport { GameContext } from \"GameEngine\";\r\nimport ActiveItem from \"./CraftingPage/ActiveItem\";\r\nimport PriceMultiplier from \"./CraftingPage/PriceMultiplier\";\r\nimport TreasureCell from \"./CraftingPage/TreasureCell\";\r\n\r\nexport default function CraftingPage() {\r\n  const { crafting } = React.useContext(GameContext);\r\n  const [activeItem, setActiveItem] = React.useState<string | undefined>();\r\n\r\n  return (\r\n    <Box marginLeft={2} marginTop={2}>\r\n      {activeItem && (\r\n        <Box display=\"flex\" gap={2} marginBottom={2}>\r\n          <PriceMultiplier\r\n            activity={\r\n              crafting.find((activity) => activity.name === activeItem)!\r\n            }\r\n          />\r\n          <ActiveItem\r\n            activity={\r\n              crafting.find((activity) => activity.name === activeItem)!\r\n            }\r\n          />\r\n        </Box>\r\n      )}\r\n      <ItemGrid\r\n        cellWidth={160}\r\n        cellHeight={64}\r\n        sizeX={5}\r\n        sizeY={5}\r\n        items={crafting}\r\n        Cell={TreasureCell}\r\n        Tooltip={TreasureTooltip}\r\n        context={{ setActiveItem }}\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Button, TableCell, TableRow } from \"@mui/material\";\r\nimport withTooltip, { WithTooltipType } from \"Components/shared/withTooltip\";\r\nimport { EnemyType } from \"GameConstants/Fighting/Enemies\";\r\nimport { PlayerContext, useNumberParser } from \"GameEngine\";\r\nimport React from \"react\";\r\nimport EnemyTooltip from \"./EnemyTooltip\";\r\n\r\ntype Props = {\r\n  item: any;\r\n};\r\nconst EnemyRow = withTooltip<Props>((props) => {\r\n  const enemy = props.item as EnemyType;\r\n  const { name, health, attack, defence, healthRegen } = enemy;\r\n  const parse = useNumberParser();\r\n  const { state, updateContext } = React.useContext(PlayerContext);\r\n  const isActive =\r\n    state.action === \"fighting\" && state.enemy\r\n      ? state.enemy.name === name\r\n      : false;\r\n  const handleClick = () => {\r\n    if (isActive) {\r\n      updateContext({ state: { action: \"idle\", enemy: undefined } });\r\n      return;\r\n    }\r\n    const currentEnemy = JSON.parse(JSON.stringify(enemy));\r\n    currentEnemy.currentHealth = currentEnemy.health;\r\n    updateContext({\r\n      state: { action: \"fighting\", enemy: currentEnemy },\r\n    });\r\n  };\r\n  const enemyHealthLabel =\r\n    isActive && state.enemy\r\n      ? `${parse(state.enemy.health)}/${parse(state.enemy.currentHealth)}`\r\n      : parse(health);\r\n  return (\r\n    <TableRow>\r\n      <TableCell\r\n        onClick={props.toggleTooltip}\r\n        onMouseOver={props.showTooltip}\r\n        onMouseOut={props.hideTooltip}\r\n      >\r\n        {name}\r\n      </TableCell>\r\n      <TableCell onClick={props.toggleTooltip}>{enemyHealthLabel}</TableCell>\r\n      <TableCell onClick={props.toggleTooltip}>{parse(attack)}</TableCell>\r\n      <TableCell onClick={props.toggleTooltip}>{parse(defence)}</TableCell>\r\n      <TableCell onClick={props.toggleTooltip}>{parse(healthRegen)}</TableCell>\r\n      <TableCell>\r\n        <Button\r\n          variant=\"contained\"\r\n          onClick={handleClick}\r\n          color={isActive ? \"warning\" : \"primary\"}\r\n        >\r\n          {isActive ? \"Flee\" : \"Fight\"}\r\n        </Button>\r\n      </TableCell>\r\n    </TableRow>\r\n  );\r\n}, EnemyTooltip);\r\n\r\nexport default EnemyRow;\r\n","import { Box, ClickAwayListener, Popper } from \"@mui/material\";\r\nimport React from \"react\";\r\n\r\nexport type WithTooltipType = {\r\n  toggleTooltip: () => void;\r\n  showTooltip: () => void;\r\n  hideTooltip: () => void;\r\n};\r\n\r\nexport default function withTooltip<P>(\r\n  WrappedComponent: React.FunctionComponent<P & WithTooltipType>,\r\n  Tooltip: (props: any) => JSX.Element\r\n) {\r\n  return (props: any) => {\r\n    // For the tooltip handling\r\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLElement>) => {\r\n      setAnchorEl(anchorEl ? null : event.currentTarget);\r\n    };\r\n\r\n    const handleMouseOver = (event: React.MouseEvent<HTMLElement>) => {\r\n      setAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleClickAway = () => {\r\n      setAnchorEl(null);\r\n    };\r\n    const open = Boolean(anchorEl);\r\n    const id = open ? \"simple-popper\" : undefined;\r\n    return (\r\n      <ClickAwayListener onClickAway={handleClickAway}>\r\n        <>\r\n          <WrappedComponent\r\n            toggleTooltip={handleClick}\r\n            showTooltip={(event) => setAnchorEl(event.currentTarget)}\r\n            hideTooltip={() => setAnchorEl(null)}\r\n            {...props}\r\n          />\r\n          <Popper id={id} open={open} anchorEl={anchorEl}>\r\n            {Tooltip && <Tooltip {...props} />}\r\n          </Popper>\r\n        </>\r\n      </ClickAwayListener>\r\n    );\r\n  };\r\n}\r\n","import { Box, Typography } from \"@mui/material\";\r\nimport ItemDescriptions from \"Components/shared/ItemDescriptions\";\r\nimport { EnemyType } from \"GameConstants/Fighting/Enemies\";\r\nimport { getStatName, useNumberParser } from \"GameEngine\";\r\n\r\nexport default function EnemyTooltip(props: { item: EnemyType }) {\r\n  const enemy = props.item;\r\n  const { health, healthRegen, defence, attack } = enemy;\r\n  const parse = useNumberParser();\r\n  let description: Array<JSX.Element> = [];\r\n  for (const [key, value] of Object.entries({\r\n    health,\r\n    attack,\r\n    healthRegen,\r\n    defence,\r\n  })) {\r\n    description.push(\r\n      <Typography key={key}>\r\n        {getStatName(key)}: {parse(value)}\r\n      </Typography>\r\n    );\r\n  }\r\n  return (\r\n    <Box bgcolor={\"background.paper\"} border={1} padding={2}>\r\n      <Typography variant=\"h6\">{enemy.name}</Typography>\r\n      <Typography marginY={1}>{enemy.description}</Typography>\r\n      {description}\r\n\r\n      {enemy.result.items && (\r\n        <>\r\n          <Typography variant=\"h6\" marginTop={2}>\r\n            Reward\r\n          </Typography>\r\n          <ItemDescriptions items={enemy.result.items} />\r\n        </>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  Typography,\r\n} from \"@mui/material\";\r\nimport { GameContext } from \"GameEngine\";\r\nimport React from \"react\";\r\nimport EnemyRow from \"./FightingPage/EnemyRow\";\r\n\r\nexport default function FightingPage() {\r\n  const { enemies } = React.useContext(GameContext);\r\n  return (\r\n    <Box marginTop={2} marginLeft={2}>\r\n      <TableContainer sx={{ width: 600, height: 600, overflow: \"auto\" }}>\r\n        <Table>\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell>name</TableCell>\r\n              <TableCell>health</TableCell>\r\n              <TableCell>attack</TableCell>\r\n              <TableCell>defence</TableCell>\r\n              <TableCell>healthRegen</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {enemies.map((enemy) => (\r\n              <EnemyRow item={enemy} key={enemy.name} />\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n    </Box>\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  LinearProgress,\r\n  LinearProgressProps,\r\n  Typography,\r\n  useTheme,\r\n} from \"@mui/material\";\r\nimport {\r\n  levelExp,\r\n  totalExp,\r\n} from \"GameConstants/Cultivation/CultivationManuals\";\r\nimport { PlayerContext, getStatName } from \"GameEngine\";\r\nimport React from \"react\";\r\n\r\nexport default function ActiveManual() {\r\n  const { state } = React.useContext(PlayerContext);\r\n  const theme = useTheme();\r\n  if (state.action !== \"cultivating\" || !state.manual)\r\n    return (\r\n      <Box\r\n        width=\"60%\"\r\n        border=\"1px solid gray\"\r\n        height={theme.spacing(10)}\r\n        borderRadius={theme.spacing(1)}\r\n      >\r\n        <Typography\r\n          variant=\"h5\"\r\n          marginTop={theme.spacing(2)}\r\n          marginLeft={theme.spacing(2)}\r\n        >\r\n          No manual selected\r\n        </Typography>\r\n      </Box>\r\n    );\r\n  const { manual, learningProgress } = state.manual;\r\n  const { rarity, realm, maxLevel } = manual;\r\n\r\n  const { exp, level } = learningProgress;\r\n  const expForPrevLevel = totalExp(level);\r\n  const expForNextLevel = levelExp(level + 1, rarity, realm);\r\n\r\n  const ManualStatsDescription: ManualStatsDescription[] = [];\r\n  if (manual.stats)\r\n    for (const [key, value] of Object.entries(manual.stats)) {\r\n      ManualStatsDescription.push({\r\n        text: getStatName(key),\r\n        effect: value * learningProgress.level,\r\n      });\r\n    }\r\n  const ManualSkillsDescription: ManualStatsDescription[] = [];\r\n  if (manual.skills)\r\n    for (const [key, value] of Object.entries(manual.skills)) {\r\n      ManualSkillsDescription.push({\r\n        text: getStatName(key),\r\n        effect: value * learningProgress.level,\r\n      });\r\n    }\r\n  return (\r\n    <Box width=\"60%\" border=\"1px solid gray\" borderRadius={theme.spacing(1)}>\r\n      <Box\r\n        display={\"flex\"}\r\n        marginTop={theme.spacing(2)}\r\n        marginLeft={theme.spacing(2)}\r\n        alignItems=\"center\"\r\n      >\r\n        <Box\r\n          width={100}\r\n          minHeight={60}\r\n          marginY={theme.spacing(1)}\r\n          display=\"flex\"\r\n          justifyContent={\"center\"}\r\n        >\r\n          <img\r\n            src={manual.imagePath || \"/manuals/placeholder.png\"}\r\n            width=\"60px\"\r\n            height=\"auto\"\r\n            alt=\"\"\r\n          ></img>\r\n        </Box>\r\n        <Typography variant=\"h5\">{manual.name}</Typography>\r\n        <Typography marginLeft={theme.spacing(2)}>\r\n          Level: {level} / {maxLevel}\r\n        </Typography>\r\n\r\n        <Box width={400} marginLeft={theme.spacing(4)}>\r\n          <ProgressBar\r\n            value={((exp - expForPrevLevel) / expForNextLevel) * 100}\r\n            label={\r\n              level !== maxLevel\r\n                ? `Exp: ${(exp - expForPrevLevel).toFixed(\r\n                    2\r\n                  )}/${expForNextLevel}`\r\n                : \"\"\r\n            }\r\n          />\r\n        </Box>\r\n      </Box>\r\n      <Box\r\n        marginLeft={theme.spacing(2)}\r\n        marginBottom={theme.spacing(2)}\r\n        display=\"flex\"\r\n      >\r\n        <Typography>\r\n          {manual.realm} ({manual.rarity})\r\n        </Typography>\r\n        {ManualStatsDescription.map((stat) => {\r\n          return (\r\n            <Typography key={stat.text} marginLeft={theme.spacing(2)}>\r\n              {stat.text}: +{(stat.effect * 100).toFixed(2)}%\r\n            </Typography>\r\n          );\r\n        })}\r\n        {ManualSkillsDescription.map((skill) => {\r\n          return (\r\n            <Typography key={skill.text} marginLeft={theme.spacing(2)}>\r\n              {skill.text}: +{(skill.effect * 100).toFixed(2)}%\r\n            </Typography>\r\n          );\r\n        })}\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nfunction ProgressBar(\r\n  props: LinearProgressProps & { label: string; value: number }\r\n) {\r\n  return (\r\n    <Box sx={{ display: \"flex\", alignItems: \"center\" }}>\r\n      <Typography variant=\"body1\" color=\"text.primary\">\r\n        {props.label}\r\n      </Typography>\r\n      <Box sx={{ width: \"60%\", m: 1 }}>\r\n        <LinearProgress variant=\"determinate\" color=\"primary\" {...props} />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\ntype ManualStatsDescription = {\r\n  text: string;\r\n  effect: number;\r\n};\r\n","import {\r\n  Box,\r\n  Button,\r\n  ClickAwayListener,\r\n  Popper,\r\n  Typography,\r\n  useTheme,\r\n} from \"@mui/material\";\r\n\r\nimport React from \"react\";\r\nimport { PlayerCultivationManual } from \"GameConstants/Interfaces\";\r\nimport { PlayerContext, playerStats } from \"GameEngine\";\r\n\r\nexport default function EquippedManualCard(props: PlayerCultivationManual) {\r\n  const { manual, learningProgress } = props;\r\n  let player = React.useContext(PlayerContext);\r\n  let { manuals, state, updateContext, stats } = player;\r\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n  const theme = useTheme();\r\n\r\n  const handleClick = (event: React.MouseEvent<HTMLElement>) => {\r\n    setAnchorEl(anchorEl ? null : event.currentTarget);\r\n  };\r\n\r\n  const handleClickAway = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const selectButtonClick = () => {\r\n    if (!manuals) return;\r\n    const index = manuals.findIndex((item) => item.manual.name === manual.name);\r\n    if (index === -1) return;\r\n    updateContext({ state: { action: \"cultivating\", manual: manuals[index] } });\r\n  };\r\n\r\n  const unequipButtonClick = () => {\r\n    if (!manuals) return;\r\n    const index = manuals.findIndex((item) => item.manual.name === manual.name);\r\n    if (index === -1) return;\r\n    manuals[index].isEquipped = !manuals[index].isEquipped;\r\n    if (state.manual && state.manual.manual.name === manual.name)\r\n      state = { action: \"idle\" };\r\n    stats = playerStats(player);\r\n    updateContext({ manuals, state, stats });\r\n  };\r\n\r\n  const open = Boolean(anchorEl);\r\n  const id = open ? \"simple-popper\" : undefined;\r\n\r\n  return (\r\n    <ClickAwayListener onClickAway={handleClickAway}>\r\n      <Box\r\n        border=\"1px solid gray\"\r\n        width={120}\r\n        height={200}\r\n        borderRadius={theme.spacing(1)}\r\n        onClick={handleClick}\r\n      >\r\n        <Box\r\n          width={100}\r\n          minHeight={60}\r\n          marginY={theme.spacing(1)}\r\n          display=\"flex\"\r\n          justifyContent={\"center\"}\r\n        >\r\n          <img\r\n            src={manual.imagePath || \"/manuals/placeholder.png\"}\r\n            width=\"60px\"\r\n            height=\"auto\"\r\n            alt=\"\"\r\n          ></img>\r\n        </Box>\r\n        <Box>\r\n          <Typography variant=\"body2\" marginLeft={theme.spacing(1)}>\r\n            {manual.name}\r\n          </Typography>\r\n          <Typography variant=\"body2\" marginLeft={theme.spacing(1)}>\r\n            {learningProgress.level}/{manual.maxLevel}\r\n          </Typography>\r\n          <Typography variant=\"body2\" marginLeft={theme.spacing(1)}>\r\n            {manual.realm}\r\n          </Typography>\r\n        </Box>\r\n        <Popper id={id} open={open} anchorEl={anchorEl}>\r\n          <Box sx={{ border: 1, p: 1, bgcolor: \"background.paper\" }}>\r\n            <Button onClick={selectButtonClick} color=\"success\">\r\n              Study\r\n            </Button>\r\n            <Button onClick={unequipButtonClick} color=\"warning\">\r\n              Unequip\r\n            </Button>\r\n          </Box>\r\n        </Popper>\r\n      </Box>\r\n    </ClickAwayListener>\r\n  );\r\n}\r\n","import { Box, useTheme } from \"@mui/material\";\r\n\r\nexport default function PlaceholderCard() {\r\n  const theme = useTheme();\r\n  return (\r\n    <Box\r\n      border=\"1px solid gray\"\r\n      width={120}\r\n      height={200}\r\n      borderRadius={theme.spacing(1)}\r\n    ></Box>\r\n  );\r\n}\r\n","import { Box, Typography, useTheme } from \"@mui/material\";\r\nimport React from \"react\";\r\nimport { getWindowDimensions } from \"Utils/useWindowDimensions\";\r\nimport EquippedManualCard from \"./EquippedManuals/EquippedManualCard\";\r\nimport PlaceholderCard from \"./EquippedManuals/PlaceholderCard\";\r\nimport { PlayerContext } from \"GameEngine\";\r\n\r\nexport default function EquippedManuals() {\r\n  const { manuals } = React.useContext(PlayerContext);\r\n  const { width } = getWindowDimensions();\r\n  const theme = useTheme();\r\n  const equippedManuals = manuals?.filter((manual) => manual.isEquipped);\r\n  const tileIndex = Array(10)\r\n    .fill(0)\r\n    .map((element, index) => index);\r\n  return (\r\n    <>\r\n      <Typography\r\n        variant=\"h5\"\r\n        marginTop={theme.spacing(2)}\r\n        marginBottom={theme.spacing(2)}\r\n      >\r\n        Equipped Manuals\r\n      </Typography>\r\n      <Box display=\"flex\" flexWrap={\"wrap\"} maxWidth={width - 512}>\r\n        {tileIndex.map((index) => {\r\n          if (equippedManuals && equippedManuals[index])\r\n            return (\r\n              <EquippedManualCard {...equippedManuals[index]} key={index} />\r\n            );\r\n          return <PlaceholderCard key={index} />;\r\n        })}\r\n      </Box>\r\n    </>\r\n  );\r\n}\r\n","import { Box, Button, Typography, useTheme } from \"@mui/material\";\r\nimport { CultivationRealms } from \"GameConstants/Cultivation/CultivationRealms\";\r\nimport { PlayerContext, playerStats, getStatName } from \"GameEngine\";\r\n\r\nimport React from \"react\";\r\n\r\nexport default function ManualsList() {\r\n  const player = React.useContext(PlayerContext);\r\n  let { manuals, updateContext, stats } = player;\r\n  const theme = useTheme();\r\n  if (!manuals) return <Box />;\r\n  let storedManuals = manuals.filter((item) => !item.isEquipped);\r\n\r\n  // Sort manuals by realm\r\n  storedManuals.sort((a, b) => {\r\n    const aIndex = CultivationRealms.findIndex(\r\n      (item) => item.name === a.manual.realm\r\n    );\r\n    const bIndex = CultivationRealms.findIndex(\r\n      (item) => item.name === b.manual.realm\r\n    );\r\n    return bIndex - aIndex;\r\n  });\r\n  const canSelect = manuals.filter((item) => item.isEquipped).length < 10;\r\n\r\n  const equipButtonClick = (name: string) => {\r\n    if (!canSelect || !manuals) return;\r\n    const index = manuals.findIndex((item) => item.manual.name === name);\r\n    if (index === -1) return;\r\n    manuals[index].isEquipped = !manuals[index].isEquipped;\r\n    stats = playerStats(player);\r\n    updateContext({ manuals, stats });\r\n  };\r\n\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"h5\" marginY={theme.spacing(2)}>\r\n        Known manuals\r\n      </Typography>\r\n      {storedManuals.map((item) => {\r\n        const { manual, learningProgress } = item;\r\n        const ManualStatsDescription: ManualStatsDescription[] = [];\r\n        if (manual.stats)\r\n          for (const [key, value] of Object.entries(manual.stats)) {\r\n            ManualStatsDescription.push({\r\n              text: getStatName(key),\r\n              effect: value * learningProgress.level,\r\n            });\r\n          }\r\n        const ManualSkillsDescription: ManualStatsDescription[] = [];\r\n        if (manual.skills)\r\n          for (const [key, value] of Object.entries(manual.skills)) {\r\n            ManualSkillsDescription.push({\r\n              text: getStatName(key),\r\n              effect: value * learningProgress.level,\r\n            });\r\n          }\r\n        return (\r\n          <Box\r\n            key={manual.name}\r\n            display=\"flex\"\r\n            alignItems={\"center\"}\r\n            width={500}\r\n          >\r\n            <Box>\r\n              <Typography>\r\n                {manual.name} {manual.realm} ({manual.rarity})\r\n              </Typography>\r\n              <Typography>\r\n                Level: {learningProgress.level} / {manual.maxLevel}\r\n              </Typography>\r\n              {ManualStatsDescription.map((stat) => {\r\n                return (\r\n                  <Typography key={stat.text}>\r\n                    {stat.text}: {(stat.effect * 100).toFixed(2)}%\r\n                  </Typography>\r\n                );\r\n              })}\r\n              {ManualSkillsDescription.map((skill) => {\r\n                return (\r\n                  <Typography key={skill.text}>\r\n                    {skill.text}: {(skill.effect * 100).toFixed(2)}%\r\n                  </Typography>\r\n                );\r\n              })}\r\n            </Box>\r\n            <Button\r\n              variant=\"outlined\"\r\n              onClick={() => equipButtonClick(manual.name)}\r\n              sx={{\r\n                maxHeight: theme.spacing(4),\r\n                minHeight: theme.spacing(4),\r\n                margin: \"auto\",\r\n              }}\r\n              disabled={!canSelect}\r\n            >\r\n              Select\r\n            </Button>\r\n          </Box>\r\n        );\r\n      })}\r\n    </Box>\r\n  );\r\n}\r\n\r\ntype ManualStatsDescription = {\r\n  text: string;\r\n  effect: number;\r\n};\r\n","import { Box, Typography, useTheme } from \"@mui/material\";\r\nimport getSpacing from \"Utils/getSpacing\";\r\nimport { getWindowDimensions } from \"Utils/useWindowDimensions\";\r\nimport ActiveManual from \"./CultivationPage/ActiveManual\";\r\nimport EquippedManuals from \"./CultivationPage/EquippedManuals\";\r\nimport ManualsList from \"./CultivationPage/ManualsList\";\r\n\r\nexport default function ManualsPage() {\r\n  const theme = useTheme();\r\n  const { height } = getWindowDimensions();\r\n  return (\r\n    <Box\r\n      marginLeft={theme.spacing(2)}\r\n      marginTop={theme.spacing(2)}\r\n      height={height - getSpacing(theme, 20)}\r\n      overflow=\"auto\"\r\n    >\r\n      <Typography variant=\"h5\" marginBottom={theme.spacing(2)}>\r\n        Studying Manual\r\n      </Typography>\r\n      <ActiveManual />\r\n      <EquippedManuals />\r\n      <ManualsList />\r\n    </Box>\r\n  );\r\n}\r\n","import { Box } from \"@mui/material\";\r\n\r\ntype Props = {\r\n  progress: number;\r\n  isHeavenly: boolean;\r\n};\r\n\r\nexport default function BreakthroughAnimation(props: Props) {\r\n  const { progress, isHeavenly } = props;\r\n  const bar = 400 * progress || 0;\r\n  return (\r\n    <Box position={\"relative\"}>\r\n      <Box\r\n        bgcolor={\"black\"}\r\n        height={400}\r\n        maxHeight={400}\r\n        overflow=\"hidden\"\r\n        width={100}\r\n        position=\"absolute\"\r\n        top={0}\r\n        left={0}\r\n        zIndex={2}\r\n        sx={{ opacity: 0.3 }}\r\n        border=\"3px solid gray\"\r\n        borderRadius={4}\r\n      />\r\n      <Box\r\n        height={400}\r\n        maxHeight={400}\r\n        overflow=\"hidden\"\r\n        width={100}\r\n        display=\"flex\"\r\n        flexDirection={\"column\"}\r\n        position=\"absolute\"\r\n        top={0}\r\n        left={0}\r\n        borderRadius={4}\r\n      >\r\n        <Box\r\n          height={400 - bar}\r\n          minHeight={400 - bar}\r\n          maxHeight={400 - bar}\r\n          bgcolor=\"lightgrey\"\r\n          sx={{ opacity: 0.3 }}\r\n        />\r\n        <Box\r\n          height={bar}\r\n          minHeight={bar}\r\n          maxHeight={bar}\r\n          bgcolor={isHeavenly ? \"rgb(51,157,255)\" : \"rgb(0, 153, 0)\"}\r\n        />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Typography, useTheme } from \"@mui/material\";\r\nimport { HtmlTooltip } from \"Components\";\r\nimport { PlayerBaseStats } from \"GameConstants/Player\";\r\nimport { useNumberParser } from \"GameEngine\";\r\nimport getSpacing from \"Utils/getSpacing\";\r\nimport { getWindowDimensions } from \"Utils/useWindowDimensions\";\r\n\r\ntype Props = {\r\n  PassedTribulations: Array<{\r\n    name: string;\r\n    stepReached: number;\r\n    statMulti: number;\r\n    tribulationMulti: number;\r\n  }>;\r\n  currentPower: PlayerBaseStats;\r\n};\r\n\r\nexport default function Placeholder(props: Props) {\r\n  const { PassedTribulations, currentPower } = props;\r\n  const parse = useNumberParser();\r\n  const theme = useTheme();\r\n  const { height } = getWindowDimensions();\r\n  return (\r\n    <Box paddingLeft={theme.spacing(2)} paddingTop={theme.spacing(2)}>\r\n      <Box\r\n        height={height - getSpacing(theme, 16)}\r\n        display=\"flex\"\r\n        flexDirection={\"column\"}\r\n        alignItems={\"center\"}\r\n        maxWidth={600}\r\n      >\r\n        <Typography variant=\"h4\" marginBottom={theme.spacing(2)}>\r\n          You have reached the pinnacle of cultivation\r\n        </Typography>\r\n        <Typography variant=\"h6\">Passed tribulations</Typography>\r\n        {PassedTribulations.map((item) => {\r\n          return (\r\n            <HtmlTooltip\r\n              key={item.name}\r\n              title={\r\n                <>\r\n                  <Typography>Multipliers:</Typography>\r\n                  <Typography>Player stats: {parse(item.statMulti)}</Typography>\r\n                  <Typography>\r\n                    Tribulation power: {parse(item.tribulationMulti)}\r\n                  </Typography>\r\n                </>\r\n              }\r\n            >\r\n              <Box>\r\n                <Typography>\r\n                  {item.name}: {item.stepReached}\r\n                </Typography>\r\n              </Box>\r\n            </HtmlTooltip>\r\n          );\r\n        })}\r\n        <Box\r\n          border=\"1px solid gray\"\r\n          borderRadius={4}\r\n          display=\"flex\"\r\n          alignItems={\"center\"}\r\n          padding={theme.spacing(2)}\r\n          gap={theme.spacing(4)}\r\n        >\r\n          <Box>\r\n            <Typography>Health x {parse(currentPower.health)}</Typography>\r\n            <Typography>\r\n              Health regen x {parse(currentPower.healthRegen)}\r\n            </Typography>\r\n            <Typography>Attack x {parse(currentPower.attack)}</Typography>\r\n            <Typography>Defence x {parse(currentPower.defence)}</Typography>\r\n            <Typography>Insight x {parse(currentPower.insight)}</Typography>\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { CultivationRealm } from \"GameConstants/Cultivation/CultivationRealms\";\r\n\r\nimport calculateTribulationPower from \"GameEngine/shared/calculateTribulationPower\";\r\nimport {\r\n  BreakthroughDps,\r\n  TribulationDps,\r\n} from \"GameConstants/Cultivation/CultivationRealms\";\r\nimport { PlayerContextType } from \"GameConstants/Interfaces\";\r\n\r\nexport default function calculateMaxTribulationStage(props: {\r\n  player: PlayerContextType;\r\n  cultivationRealms: CultivationRealm[];\r\n  nextRealmIndex: number;\r\n}): number {\r\n  const { player, cultivationRealms, nextRealmIndex } = props;\r\n  const { stats, currentStats } = player;\r\n  let step = 0;\r\n  let remainingHealth = currentStats.health;\r\n  const cultivationRealmsCopy: CultivationRealm[] = JSON.parse(\r\n    JSON.stringify(cultivationRealms)\r\n  );\r\n\r\n  const currentRealm = cultivationRealmsCopy[nextRealmIndex];\r\n  if (!currentRealm.tribulation) return 0;\r\n  for (let i = 0; i <= currentRealm.tribulation.steps; i++) {\r\n    const tribulation = calculateTribulationPower(\r\n      nextRealmIndex,\r\n      cultivationRealmsCopy\r\n    );\r\n    const tribulationDps = TribulationDps(tribulation, player);\r\n    const playerDps = BreakthroughDps(player, tribulation);\r\n    if (playerDps <= 0) break;\r\n    if (tribulationDps <= 0) {\r\n      step++;\r\n      (cultivationRealmsCopy[nextRealmIndex] as any).tribulation.stepReached =\r\n        step;\r\n      continue;\r\n    }\r\n    const time = tribulation.health / playerDps;\r\n    const damageReceived = tribulationDps * time;\r\n    remainingHealth -= damageReceived;\r\n    if (remainingHealth <= 0) break;\r\n\r\n    step++;\r\n    (cultivationRealmsCopy[nextRealmIndex] as any).tribulation.stepReached =\r\n      step;\r\n  }\r\n  return Math.min(Math.max(step - 1, 0), currentRealm.tribulation.steps);\r\n}\r\n","import { Box, Button, Typography, useTheme } from \"@mui/material\";\r\nimport React from \"react\";\r\nimport calculateTribulationPower from \"GameEngine/shared/calculateTribulationPower\";\r\nimport BreakthroughAnimation from \"./RealmBreakthroughPage/BreakthroughAnimation\";\r\nimport { getWindowDimensions } from \"Utils/useWindowDimensions\";\r\nimport getSpacing from \"Utils/getSpacing\";\r\nimport calculateRealmPower from \"GameEngine/shared/calculateRealmPower\";\r\nimport ArrowForwardIcon from \"@mui/icons-material/ArrowForward\";\r\nimport Placeholder from \"./RealmBreakthroughPage/Placeholder\";\r\nimport calculateMaxTribulationStage from \"./RealmBreakthroughPage/calculateMaxTribulationStage\";\r\nimport { HtmlTooltip } from \"Components\";\r\nimport { PlayerContext, GameContext, useNumberParser } from \"GameEngine\";\r\n\r\n// ! Some bad coding ahead. Probably should split into several files :)\r\nexport default function RealmBreakthroughPage() {\r\n  const theme = useTheme();\r\n  const player = React.useContext(PlayerContext);\r\n  const { realm } = player;\r\n  const { cultivationRealms, updateContext: updateGameContext } =\r\n    React.useContext(GameContext);\r\n\r\n  const nextRealmIndex =\r\n    cultivationRealms.length >= realm.index + 2 ? realm.index + 1 : undefined;\r\n  const { height } = getWindowDimensions();\r\n\r\n  // Passed tribulation statistics\r\n  let PassedTribulations: Array<{\r\n    name: string;\r\n    stepReached: number;\r\n    statMulti: number;\r\n    tribulationMulti: number;\r\n  }> = [];\r\n\r\n  for (let i = 0; i <= realm.index; i++) {\r\n    const r = cultivationRealms[i];\r\n    if (!r.tribulation) continue;\r\n\r\n    PassedTribulations.push({\r\n      name: r.name,\r\n      stepReached: r.tribulation.stepReached || 0,\r\n      statMulti: r.tribulation.stepReached\r\n        ? r.tribulation.statsMulti ** r.tribulation.stepReached\r\n        : 1,\r\n      tribulationMulti: r.tribulation.stepReached\r\n        ? r.tribulation.multiplier ** r.tribulation.stepReached\r\n        : 1,\r\n    });\r\n  }\r\n\r\n  const TotalTribulations = {\r\n    statMulti: 1,\r\n    tribulationMulti: 1,\r\n  };\r\n  for (let i = 0; i < PassedTribulations.length; i++) {\r\n    const trib = PassedTribulations[i];\r\n    TotalTribulations.statMulti *= trib.statMulti || 1;\r\n    TotalTribulations.tribulationMulti *= trib.tribulationMulti || 1;\r\n  }\r\n\r\n  const currentPower = calculateRealmPower(realm.index, cultivationRealms);\r\n\r\n  if (!nextRealmIndex)\r\n    return (\r\n      <Placeholder\r\n        currentPower={currentPower}\r\n        PassedTribulations={PassedTribulations}\r\n      ></Placeholder>\r\n    );\r\n\r\n  // Tribulation logic\r\n  const nextRealm = cultivationRealms[nextRealmIndex];\r\n  const power = calculateTribulationPower(nextRealmIndex, cultivationRealms);\r\n  const parse = useNumberParser();\r\n  const { healthRegen, attack, defence, health } = power;\r\n\r\n  const { state, updateContext } = React.useContext(PlayerContext);\r\n  const isActive = state.action === \"breakthrough\";\r\n  const currentHealth = nextRealm.currentStats?.currentHealth || health;\r\n  const handleClick = () => {\r\n    if (isActive) {\r\n      state.action = \"idle\";\r\n      state.realm = undefined;\r\n      // Reset last tribulation state\r\n      cultivationRealms[nextRealmIndex].currentStats = undefined;\r\n      if (cultivationRealms[nextRealmIndex].tribulation)\r\n        (cultivationRealms[nextRealmIndex] as any).tribulation.stepReached =\r\n          undefined;\r\n    } else {\r\n      state.action = \"breakthrough\";\r\n      state.realm = { index: nextRealmIndex };\r\n      const { health, healthRegen, attack, defence } = nextRealm.baseStats;\r\n      cultivationRealms[nextRealmIndex].currentStats = {\r\n        health,\r\n        currentHealth: health,\r\n        healthRegen,\r\n        attack,\r\n        defence,\r\n      };\r\n      if (cultivationRealms[nextRealmIndex].tribulation)\r\n        (cultivationRealms[nextRealmIndex] as any).tribulation.stepReached = 0;\r\n    }\r\n    updateContext({ state });\r\n    updateGameContext({ cultivationRealms: cultivationRealms.slice() });\r\n  };\r\n\r\n  // Cultivation realm power to display\r\n\r\n  const nextPower = calculateRealmPower(nextRealmIndex, cultivationRealms);\r\n\r\n  return (\r\n    <Box paddingLeft={theme.spacing(2)} paddingTop={theme.spacing(2)}>\r\n      <Box\r\n        height={height - getSpacing(theme, 16)}\r\n        display=\"flex\"\r\n        flexDirection={\"column\"}\r\n        alignItems={\"center\"}\r\n        maxWidth={600}\r\n      >\r\n        <Typography variant=\"h4\" marginBottom={theme.spacing(2)}>\r\n          Next realm: {nextRealm.name}\r\n        </Typography>\r\n        {nextRealm.tribulation && (\r\n          <HtmlTooltip\r\n            title={\r\n              <>\r\n                <Typography>\r\n                  Each completed stage provides\r\n                  <Typography\r\n                    component=\"span\"\r\n                    color={theme.palette.success.main}\r\n                    display=\"inline\"\r\n                  >\r\n                    {\" \"}\r\n                    x{nextRealm.tribulation.statsMulti}{\" \"}\r\n                  </Typography>\r\n                  multiplier to all stats aIndex\r\n                  <Typography\r\n                    component=\"span\"\r\n                    color={theme.palette.error.main}\r\n                    display=\"inline\"\r\n                  >\r\n                    {\" \"}\r\n                    x{nextRealm.tribulation.multiplier}{\" \"}\r\n                  </Typography>\r\n                  to all following heavenly tribulations\r\n                </Typography>\r\n              </>\r\n            }\r\n          >\r\n            <Typography variant=\"h6\" marginBottom={theme.spacing(2)}>\r\n              Tribulation stages: {nextRealm.tribulation.steps}\r\n            </Typography>\r\n          </HtmlTooltip>\r\n        )}\r\n        <Box>\r\n          <Box display=\"flex\" alignItems={\"center\"}>\r\n            <Box marginRight={theme.spacing(4)}>\r\n              <Typography variant=\"h6\">Passed tribulations</Typography>\r\n              {PassedTribulations.map((item) => {\r\n                return (\r\n                  <HtmlTooltip\r\n                    key={item.name}\r\n                    title={\r\n                      <>\r\n                        <Typography>Multipliers:</Typography>\r\n                        <Typography>\r\n                          Player stats: {parse(item.statMulti)}\r\n                        </Typography>\r\n                        <Typography>\r\n                          Tribulation power: {parse(item.tribulationMulti)}\r\n                        </Typography>\r\n                      </>\r\n                    }\r\n                  >\r\n                    <Box>\r\n                      <Typography>\r\n                        {item.name}: {item.stepReached}\r\n                      </Typography>\r\n                    </Box>\r\n                  </HtmlTooltip>\r\n                );\r\n              })}\r\n            </Box>\r\n            <Box width={100} height={400}>\r\n              <BreakthroughAnimation\r\n                progress={health ? (health - currentHealth) / health : 0}\r\n                isHeavenly={nextRealm.tribulation?.stepReached ? true : false}\r\n              />\r\n            </Box>\r\n\r\n            <Box marginLeft={theme.spacing(4)}>\r\n              <Typography variant=\"h6\">Tribulation power:</Typography>\r\n              <Typography>Hp: {parse(currentHealth)}</Typography>\r\n              <Typography>Hp.regen: {parse(healthRegen)}</Typography>\r\n              <Typography>Atk: {parse(attack)}</Typography>\r\n              <Typography>Def: {parse(defence)}</Typography>\r\n              <Typography variant=\"h6\">\r\n                {nextRealm.tribulation\r\n                  ? `Tribulation stage: ${\r\n                      nextRealm.tribulation.stepReached || 0\r\n                    }/${nextRealm.tribulation.steps}`\r\n                  : \"\"}\r\n              </Typography>\r\n              <Typography variant=\"h6\">\r\n                {nextRealm.tribulation\r\n                  ? `Power multi: ${\r\n                      nextRealm.tribulation.stepReached\r\n                        ? parse(\r\n                            TotalTribulations.tribulationMulti *\r\n                              nextRealm.tribulation.multiplier **\r\n                                nextRealm.tribulation.stepReached\r\n                          )\r\n                        : 1\r\n                    }`\r\n                  : \"\"}\r\n              </Typography>\r\n            </Box>\r\n          </Box>\r\n        </Box>\r\n        <Box marginY={theme.spacing(2)}>\r\n          <Button variant=\"outlined\" onClick={handleClick} size={\"large\"}>\r\n            {!isActive ? \"Breakthrough\" : \"Stop\"}\r\n          </Button>\r\n          {nextRealm.tribulation && !isActive && (\r\n            <Typography>\r\n              estim. stage{\" \"}\r\n              {calculateMaxTribulationStage({\r\n                player,\r\n                cultivationRealms,\r\n                nextRealmIndex,\r\n              })}\r\n            </Typography>\r\n          )}\r\n        </Box>\r\n        <Box\r\n          border=\"1px solid gray\"\r\n          borderRadius={4}\r\n          display=\"flex\"\r\n          alignItems={\"center\"}\r\n          padding={theme.spacing(2)}\r\n          gap={theme.spacing(4)}\r\n        >\r\n          <Box>\r\n            <Typography>Health x {parse(currentPower.health)}</Typography>\r\n            <Typography>\r\n              Health regen x {parse(currentPower.healthRegen)}\r\n            </Typography>\r\n            <Typography>Attack x {parse(currentPower.attack)}</Typography>\r\n            <Typography>Defence x {parse(currentPower.defence)}</Typography>\r\n            <Typography>Insight x {parse(currentPower.insight)}</Typography>\r\n          </Box>\r\n          <ArrowForwardIcon fontSize={\"large\"} />\r\n          <Box>\r\n            <Typography>Health x {parse(nextPower.health)}</Typography>\r\n            <Typography>\r\n              Health regen x {parse(nextPower.healthRegen)}\r\n            </Typography>\r\n            <Typography>Attack x {parse(nextPower.attack)}</Typography>\r\n            <Typography>Defence x {parse(nextPower.defence)}</Typography>\r\n            <Typography>Insight x {parse(nextPower.insight)} </Typography>\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Button, Paper, useTheme } from \"@mui/material\";\r\nimport ActivityCard from \"Components/ActivityCards/Activity\";\r\nimport GatheringActivityCard from \"Components/ActivityCards/GatheringActivity\";\r\nimport { PlayerContext, GameContext } from \"GameEngine\";\r\nimport ActionsPage from \"Pages/ActionsPage\";\r\nimport CraftingPage from \"Pages/CraftingPage\";\r\nimport FightingPage from \"Pages/FightingPage\";\r\nimport ManualsPage from \"Pages/ManualsPage\";\r\nimport RealmBreakthroughPage from \"Pages/RealmBreakthroughPage\";\r\nimport breakthroughSuccess from \"Pages/RealmBreakthroughPage/breakthroughSuccess\";\r\nimport getSpacing from \"Utils/getSpacing\";\r\nimport useWindowDimensions from \"Utils/useWindowDimensions\";\r\nimport React from \"react\";\r\n\r\nexport type State = { [key: string]: () => JSX.Element };\r\n\r\nexport const states = {\r\n  Training: <ActionsPage source={\"trainings\"} Card={ActivityCard} />,\r\n  Manuals: <ManualsPage />,\r\n  Breakthrough: <RealmBreakthroughPage />,\r\n  Mining: <ActionsPage source={\"mining\"} Card={GatheringActivityCard} />,\r\n  Crafting: <CraftingPage />,\r\n  Gathering: <ActionsPage source={\"gathering\"} Card={GatheringActivityCard} />,\r\n  Fighting: <FightingPage />,\r\n};\r\n\r\nexport default function useComponentSelector(\r\n  defaultComponent: string,\r\n  components: Record<string, JSX.Element>\r\n) {\r\n  const [state, setState] = React.useState<string>(defaultComponent);\r\n  const Content = () => components[state];\r\n  return { state, Content, setState, states: Object.keys(components) };\r\n}\r\n\r\nexport const MainWindow = (props: { states: Record<string, JSX.Element> }) => {\r\n  const { width, height } = useWindowDimensions();\r\n  const theme = useTheme();\r\n  const { state, setState, states, Content } = useComponentSelector(\r\n    \"Training\",\r\n    props.states\r\n  );\r\n  return (\r\n    <Box width={width - 512} height={height - getSpacing(theme, 8)}>\r\n      <Menu state={state} setState={setState} states={states} />\r\n      {state && <Content />}\r\n    </Box>\r\n  );\r\n};\r\n\r\nconst Menu = (props: {\r\n  state: string;\r\n  states: string[];\r\n  setState: (item: any) => void;\r\n}) => {\r\n  const { state, states, setState } = props;\r\n  const { width } = useWindowDimensions();\r\n  const player = React.useContext(PlayerContext);\r\n  const { cultivationRealms } = React.useContext(GameContext);\r\n  // For the breakthrough custom button color\r\n  const canBreakthrough = breakthroughSuccess(\r\n    player,\r\n    cultivationRealms[player.realm.index + 1]\r\n  );\r\n\r\n  function buttonColor(page, item): any {\r\n    let color = \"primary\";\r\n    if (page === item) color = \"success\";\r\n    if (canBreakthrough && item === \"Breakthrough\") color = \"warning\";\r\n    return color;\r\n  }\r\n  return (\r\n    <Paper elevation={2}>\r\n      <Box width={width - 512}>\r\n        {states.map((item) => (\r\n          <Button\r\n            variant=\"outlined\"\r\n            size=\"large\"\r\n            color={buttonColor(state, item)}\r\n            onClick={() => setState(item)}\r\n            sx={{ margin: 2 }}\r\n            key={item}\r\n          >\r\n            {item}\r\n          </Button>\r\n        ))}\r\n      </Box>\r\n    </Paper>\r\n  );\r\n};\r\n","import { Box, Paper, Typography, useTheme } from \"@mui/material\";\r\nimport ProgressBar from \"../shared/ProgressBar\";\r\nimport React from \"react\";\r\nimport parseTime from \"Utils/parseTime\";\r\nimport { ActivityCardProps } from \"./types\";\r\nimport { PlayerContext, useNumberParser, getStatName } from \"GameEngine\";\r\nimport { ActivitiesFunctions } from \"GameConstants/Activities\";\r\nimport { defaultUpdateInterval } from \"GameConstants/Constants\";\r\nimport ActivityStatsDescription from \"Components/shared/ActivityStatsDescription\";\r\n\r\n// Generic activity panel without decorations suitable for any activity\r\nexport default function ActivityCard(props: ActivityCardProps) {\r\n  const { activity, isActive, source, showTimesCompleted } = props;\r\n  const player = React.useContext(PlayerContext);\r\n  const parse = useNumberParser();\r\n  const { updateContext } = player;\r\n  const { result, price } = activity;\r\n  const theme = useTheme();\r\n\r\n  // Handle click on activity card\r\n  const handleClick = () => {\r\n    // If activity is active on click, set character state.action to 'idle' (i.e. deactivate training)\r\n    if (isActive)\r\n      updateContext({\r\n        state: {\r\n          action: \"idle\",\r\n          activity: undefined,\r\n        },\r\n      });\r\n    // If activity is not active on click, set character state.action to 'activity' (i.e. activate training)\r\n    else {\r\n      updateContext({\r\n        state: {\r\n          action: \"activity\",\r\n          activity: { name: activity.name, source },\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  // Object to display the result description for item rewards\r\n  const ItemRewardDescription: ItemLine[] = [];\r\n\r\n  // If the activity result includes items\r\n  if (result.items) {\r\n    // For every item in the result object, push the item name and quantity to the ItemRewardDescription array for display\r\n    for (let item of result.items) {\r\n      ItemRewardDescription.push({\r\n        name: item.name,\r\n        amount: item.amount,\r\n      });\r\n    }\r\n  }\r\n  // Object to display the result description for item prices / costs of the activity\r\n  const ItemPriceDescription: ItemLine[] = [];\r\n\r\n  // If the activity price includes items\r\n  if (price?.items) {\r\n    // For every item in the price object, push the item name and quantity to the ItemPriceDescription array for display\r\n    for (let item of price.items) {\r\n      ItemPriceDescription.push({\r\n        name: item.name,\r\n        amount: item.amount,\r\n      });\r\n    }\r\n  }\r\n\r\n  // Determine remaining time for timed activities\r\n  const requiredTime = activity.time\r\n    ? ActivitiesFunctions[activity.time](activity, player)\r\n    : activity.baseTime;\r\n\r\n  const currentTime = activity.currentTime || 0;\r\n\r\n  // Change some displayed effects if action is really fast\r\n  // Action is a 'fast action' if it takes less than 5 update intervals to complete\r\n  const fastAction = requiredTime / defaultUpdateInterval < 5;\r\n\r\n  // Adding text to the progress bar label:\r\n  // If action takes less than 1000ms to complete, display the amount of actions completed per second\r\n  // Else, display the amount of time required to complete the action in ms\r\n  const progressBarLabel =\r\n    requiredTime < 1000\r\n      ? (1000 / requiredTime).toFixed(2) + \"/s\"\r\n      : parseTime(requiredTime);\r\n\r\n  return (\r\n    <Paper\r\n      elevation={8}\r\n      sx={{\r\n        paddingX: theme.spacing(2),\r\n        paddingY: theme.spacing(1),\r\n        margin: theme.spacing(2),\r\n        borderRadius: theme.spacing(2),\r\n        minHeight: 60,\r\n        border: \"1px solid lightgray\",\r\n        borderColor: isActive ? theme.palette.primary.main : \"lightgray\",\r\n        padding: theme.spacing(1),\r\n      }}\r\n    >\r\n      <Box display={\"flex\"}>\r\n        <Box\r\n          display=\"flex\"\r\n          flexDirection={\"column\"}\r\n          justifyContent={\"space-between\"}\r\n          minWidth={price ? 400 : 600}\r\n          minHeight={60}\r\n          height=\"100%\"\r\n          onClick={() => handleClick()}\r\n        >\r\n          <Box display=\"flex\">\r\n            <Box display=\"flex\" flexDirection={\"column\"}>\r\n              <Typography>{activity.name}</Typography>\r\n              {/* Display for rewarded stats */}\r\n              {/* If baseStats are rewarded: Display a list of the stats and their exp quantities */}\r\n              {/* Per baseStat: If required time to complete is greater than 1s, show exp gained per completion. Else, show exp gained divided by required time multiplied by 1000 */}\r\n              {activity.result.baseStats && (\r\n                <ActivityStatsDescription\r\n                  stats={activity.result.baseStats}\r\n                  activity={activity}\r\n                  requiredTime={requiredTime}\r\n                  multiplicatorFunctionName={activity.result.baseStatsMulti}\r\n                />\r\n              )}\r\n\r\n              {/* Display for rewarded items */}\r\n              {/* If items are rewarded: Display a list of the items and their quantities */}\r\n              {ItemRewardDescription.length > 0 && (\r\n                <Box display=\"flex\" gap={theme.spacing(1)}>\r\n                  {ItemRewardDescription.map((item) => (\r\n                    <Typography\r\n                      key={item.name}\r\n                      variant=\"body1\"\r\n                      display=\"inline\"\r\n                    >\r\n                      {item.name} {parse(item.amount)}\r\n                    </Typography>\r\n                  ))}\r\n                </Box>\r\n              )}\r\n              {/* Display for rewarded skills */}\r\n              {/* If skills are rewarded: Display a list of the skills and their rewarded exp */}\r\n              {/* Per skill: If the required time for activity completion is greater than 1s, show the rewarded exp per completion. Else, show the rewarded exp divided by required time to complete and multiplied by 1000 */}\r\n              {activity.result.skills && (\r\n                <ActivityStatsDescription\r\n                  stats={activity.result.skills}\r\n                  activity={activity}\r\n                  requiredTime={requiredTime}\r\n                  multiplicatorFunctionName={activity.result.skillsMulti}\r\n                />\r\n              )}\r\n            </Box>\r\n            {showTimesCompleted && (\r\n              <Box marginLeft=\"auto\">\r\n                <Typography>\r\n                  {activity.timesCompleted && activity.timesCompleted > 10000\r\n                    ? parse(activity.timesCompleted)\r\n                    : activity.timesCompleted}\r\n                </Typography>\r\n              </Box>\r\n            )}\r\n          </Box>\r\n          {/* The progress bar of the activity card */}\r\n          <Box>\r\n            {/* Value of the progress bar is 100 (i.e. complete) if the action is marked 'fast' and is active, otherwise it's the percentage of the current time out of the required time */}\r\n            <ProgressBar\r\n              value={\r\n                fastAction && isActive\r\n                  ? 100\r\n                  : (currentTime / requiredTime) * 100\r\n              }\r\n              label={progressBarLabel}\r\n              rightLabel\r\n            />\r\n          </Box>\r\n        </Box>\r\n        {price && (\r\n          <Box\r\n            borderLeft=\"1px solid gray\"\r\n            paddingLeft={theme.spacing(2)}\r\n            minWidth={200}\r\n            minHeight={60}\r\n          >\r\n            <Typography>Price</Typography>\r\n            {activity.price?.baseStats && (\r\n              <ActivityStatsDescription\r\n                stats={activity.price.baseStats}\r\n                activity={activity}\r\n              />\r\n            )}\r\n\r\n            <Box display=\"flex\" gap={theme.spacing(1)}>\r\n              {ItemPriceDescription.map((item) => (\r\n                <Typography key={item.name} variant=\"body1\" display=\"inline\">\r\n                  {item.name} {parse(item.amount)}\r\n                </Typography>\r\n              ))}\r\n            </Box>\r\n          </Box>\r\n        )}\r\n      </Box>\r\n    </Paper>\r\n  );\r\n}\r\n\r\n// Object to contain name and quantity of items\r\ntype ItemLine = {\r\n  name: string;\r\n  amount: number;\r\n};\r\n","import { CultivationRealm } from \"GameConstants/Cultivation/CultivationRealms\";\r\nimport { PlayerContextType } from \"GameConstants/Interfaces\";\r\n\r\nimport {\r\n  BreakthroughDps,\r\n  TribulationDps,\r\n} from \"GameConstants/Cultivation/CultivationRealms\";\r\n\r\nexport default function breakthroughSuccess(\r\n  player: PlayerContextType,\r\n  realm: CultivationRealm | undefined\r\n) {\r\n  if (!realm) return false;\r\n  const playerDps = BreakthroughDps(player, realm.baseStats);\r\n  const realmDps = TribulationDps(\r\n    realm.currentStats || realm.baseStats,\r\n    player\r\n  );\r\n  const time = realm.baseStats.health / playerDps;\r\n  return player.currentStats.health > realmDps * time;\r\n}\r\n","import { Box, CssBaseline, ThemeProvider, useTheme } from \"@mui/material\";\r\nimport LightTheme from \"Themes/LightTheme\";\r\n\r\nimport PlayerLoader from \"GameEngine/PlayerLoader\";\r\nimport GameRuntime from \"GameEngine/GameRuntime\";\r\nimport TopBar from \"Components/TopBar\";\r\nimport useWindowDimensions, {\r\n  getWindowDimensions,\r\n} from \"Utils/useWindowDimensions\";\r\nimport MainNavigationBar from \"Components/MainNavigationBar\";\r\nimport WorldLoader from \"GameEngine/WorldLoader\";\r\nimport LeftSideBar from \"Components/LeftSideBar\";\r\nimport React from \"react\";\r\nimport SettingsPage from \"Pages/SettingsPage\";\r\nimport SettingsLoader from \"GameEngine/SettingsLoader\";\r\nimport { MainWindow, states } from \"Components/shared/useComponentSelector\";\r\n\r\nexport default function App() {\r\n  // Re-render page on innerWidth and innerHeight change\r\n  useWindowDimensions();\r\n  const { width, height } = getWindowDimensions();\r\n  const [settings, setSettings] = React.useState<boolean>(false);\r\n\r\n  return (\r\n    <CssBaseline>\r\n      <ThemeProvider theme={LightTheme}>\r\n        <SettingsLoader>\r\n          <PlayerLoader>\r\n            <WorldLoader>\r\n              <GameRuntime>\r\n                <Box width={width} height={height} overflow=\"hidden\">\r\n                  <TopBar setSettings={setSettings} />\r\n                  {settings && <SettingsPage setSettings={setSettings} />}\r\n                  {!settings && (\r\n                    <Box display=\"flex\">\r\n                      <LeftSideBar />\r\n                      <MainWindow states={states} />\r\n                    </Box>\r\n                  )}\r\n                </Box>\r\n              </GameRuntime>\r\n            </WorldLoader>\r\n          </PlayerLoader>\r\n        </SettingsLoader>\r\n      </ThemeProvider>\r\n    </CssBaseline>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\n\r\n// Entry point\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}